# Kimono AI 客服系统 - 前端测试界面开发计划

> 版本: 1.1
> 创建日期: 2024年
> 更新日期: 2024年
> 目标用户: 内部客服团队测试人员

---

## 一、项目背景与目标

### 1.1 背景

Kimono AI 客服系统后端 API 已开发完成，现需要一个前端测试界面，供团队客服人员：
- 测试 AI 客服的问答效果
- 验证多语言回复能力
- 评估回答质量并提供反馈
- 查看 AI 回答的知识来源

### 1.2 目标

| 目标 | 描述 |
|------|------|
| **易用性** | 客服人员无需技术背景即可使用 |
| **可观测性** | 清晰展示 AI 决策过程（来源、置信度、模型） |
| **可反馈** | 支持对回答质量进行评价 |
| **快速部署** | 与现有后端一体化部署，无需额外服务器 |

### 1.3 非目标（本期不做）

- 用户登录/权限管理
- 数据持久化统计报表
- 知识库管理界面
- 移动端 App

---

## 二、技术选型

### 2.1 方案对比

| 方案 | 优点 | 缺点 | 适合场景 |
|------|------|------|----------|
| **A: 纯静态 HTML** | 零构建、即开即用、易维护 | 功能扩展性有限 | 简单测试工具 |
| **B: Vue 3 + Vite** | 现代化、组件化、扩展性强 | 需 Node.js 构建 | 长期迭代产品 |
| **C: Streamlit** | Python 生态、开发极快 | 定制性差、依赖重 | 数据展示原型 |

### 2.2 推荐方案

**推荐方案 A: 纯静态 HTML + Tailwind CSS + Alpine.js**

理由：
1. **零构建依赖** - 无需 Node.js，直接由 FastAPI 托管静态文件
2. **维护简单** - 团队无需前端技术栈即可修改
3. **部署一体化** - 与后端同一服务，无跨域问题
4. **开发快速** - 预计 2-3 天完成核心功能

技术栈：
- **HTML5** - 页面结构
- **Tailwind CSS (CDN)** - 样式框架，美观且无需编译
- **Alpine.js (CDN)** - 轻量级交互，类 Vue 语法但无需构建
- **Marked.js (CDN)** - Markdown 渲染（AI 回复可能含格式）

---

## 三、功能规划

### 3.1 功能模块

```
┌─────────────────────────────────────────────────────────────┐
│                     客服测试界面                              │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    对话区域                          │   │
│  │  [用户消息]                                         │   │
│  │                              [AI回复 + 来源信息]    │   │
│  │  [用户消息]                                         │   │
│  │                              [AI回复 + 反馈按钮]    │   │
│  └─────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [输入框]                              [发送按钮]    │   │
│  └─────────────────────────────────────────────────────┘   │
│  ┌───────────────┐  ┌───────────────┐  ┌──────────────┐   │
│  │ 新对话        │  │ 系统状态      │  │ 使用说明     │   │
│  └───────────────┘  └───────────────┘  └──────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 功能清单

#### Phase 1: 核心对话功能（必需）

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 消息发送 | 输入问题并发送到 API | P0 |
| 消息展示 | 区分用户消息和 AI 回复 | P0 |
| 加载状态 | 发送中显示加载动画 | P0 |
| 错误处理 | 网络错误/服务异常提示 | P0 |
| 多轮对话 | 自动携带 conversation_id | P0 |
| 新建对话 | 清空当前对话开始新会话 | P0 |

#### Phase 2: 测试辅助信息（重要）

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 知识来源 | 展示匹配的 FAQ 问答及分数 | P1 |
| 模型信息 | 显示使用的模型（qwen-plus/max） | P1 |
| 置信度 | 显示回答置信度百分比 | P1 |
| 响应时间 | 显示 API 响应耗时 | P1 |
| 语言检测 | 显示检测到的语言 | P1 |

#### Phase 3: 反馈功能（重要）

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 快速评分 | 👍/👎 按钮评价回答 | P1 |
| 详细反馈 | 可选填写反馈意见 | P2 |
| 反馈确认 | 提交后显示感谢提示 | P2 |

#### Phase 4: 增强功能（可选）

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 对话历史 | 本地存储最近对话 | P2 |
| 知识库搜索 | 独立搜索知识库测试 | P2 |
| 系统状态 | 显示后端健康状态 | P2 |
| 深色模式 | 切换深色/浅色主题 | P3 |
| 快捷问题 | 预设常见测试问题 | P2 |

---

## 四、界面设计

### 4.1 页面布局

```
┌──────────────────────────────────────────────────────────────┐
│ [Logo] Kimono AI 客服测试                    [状态: 在线] 🟢 │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 👤 和服を借りたいのですが、どうすればいいですか？        │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 🤖 和服のレンタル方法についてご案内いたします...        │ │
│  │                                                        │ │
│  │ ┌──────────────────────────────────────────────────┐  │ │
│  │ │ 📚 参考来源                                       │  │ │
│  │ │ • [95%] 和服の借り方は？                         │  │ │
│  │ │ • [82%] レンタルの流れ                           │  │ │
│  │ └──────────────────────────────────────────────────┘  │ │
│  │                                                        │ │
│  │ ⚡ qwen-plus | 🎯 92% | ⏱️ 1.2s | 🌐 日本語          │ │
│  │                                          [👍] [👎]    │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                              │
├──────────────────────────────────────────────────────────────┤
│ ┌──────────────────────────────────────────────────┐ [发送] │
│ │ 请输入您的问题...                                 │        │
│ └──────────────────────────────────────────────────┘        │
├──────────────────────────────────────────────────────────────┤
│ [🔄 新对话]  [📋 快捷问题]  [❓ 使用说明]                    │
└──────────────────────────────────────────────────────────────┘
```

### 4.2 配色方案

```
主色调:
- 品牌色: #8B5CF6 (紫色，呼应和服典雅感)
- 背景色: #F9FAFB (浅灰白)
- 文字色: #1F2937 (深灰)

消息气泡:
- 用户消息: #8B5CF6 (紫色背景，白色文字)
- AI 回复: #FFFFFF (白色背景，深色文字)

状态色:
- 成功/在线: #10B981 (绿色)
- 警告: #F59E0B (橙色)
- 错误: #EF4444 (红色)
```

### 4.3 响应式设计

| 屏幕尺寸 | 布局调整 |
|----------|----------|
| 桌面 (>1024px) | 居中容器，最大宽度 800px |
| 平板 (768-1024px) | 全宽，增加内边距 |
| 手机 (<768px) | 全宽，底部固定输入框 |

---

## 五、开发阶段与 Gate Review

### 开发流程

```
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│ Phase 1 │────▶│ Gate 1  │────▶│ Phase 2 │────▶│ Gate 2  │────▶│ Phase 3 │
│ 核心对话 │     │ Review  │     │ 辅助信息 │     │ Review  │     │ 反馈功能 │
└─────────┘     └─────────┘     └─────────┘     └─────────┘     └─────────┘
                    │                               │                 │
                    ▼                               ▼                 ▼
               通过才能                         通过才能           ┌─────────┐
               进入下一阶段                     进入下一阶段       │ Gate 3  │
                                                                   │ Review  │
                                                                   └────┬────┘
                                                                        │
                    ┌───────────────────────────────────────────────────┘
                    ▼
              ┌─────────┐     ┌─────────┐     ┌─────────┐
              │ Phase 4 │────▶│ Gate 4  │────▶│  完成   │
              │ 增强功能 │     │ Review  │     │  上线   │
              └─────────┘     └─────────┘     └─────────┘
```

---

### Phase 1: 基础框架与核心对话

**目标**: 完成可用的对话功能

**预计时间**: 4-6 小时

#### 任务清单

| 序号 | 任务 | 状态 |
|------|------|------|
| 1.1 | 创建 `src/static/` 目录结构 | [ ] |
| 1.2 | 配置 FastAPI 静态文件托管 | [ ] |
| 1.3 | 创建 `index.html` 基础页面 | [ ] |
| 1.4 | 集成 Tailwind CSS (CDN) | [ ] |
| 1.5 | 集成 Alpine.js (CDN) | [ ] |
| 1.6 | 实现页面基础布局（头部、对话区、输入区） | [ ] |
| 1.7 | 实现消息发送功能（调用 API） | [ ] |
| 1.8 | 实现消息列表展示（用户/AI 气泡） | [ ] |
| 1.9 | 实现加载状态显示（发送中动画） | [ ] |
| 1.10 | 实现错误处理（网络错误提示） | [ ] |
| 1.11 | 实现多轮对话（自动携带 conversation_id） | [ ] |
| 1.12 | 实现新建对话功能 | [ ] |

---

### ⭐ Gate 1 Review: 核心对话功能验收

**验收时间点**: Phase 1 完成后

**验收人员**: 开发者自测 + 产品确认

#### 验收检查项

| 检查项 | 验收标准 | 通过 |
|--------|----------|------|
| **G1.1 页面加载** | 访问 `http://localhost:8000/` 页面正常显示，无 404/500 错误 | [ ] |
| **G1.2 静态资源** | Tailwind CSS 样式生效，Alpine.js 无控制台报错 | [ ] |
| **G1.3 布局正确** | 头部、对话区域、输入区域布局符合设计 | [ ] |
| **G1.4 消息发送** | 输入文字后点击发送，能成功调用 API | [ ] |
| **G1.5 消息展示** | 用户消息右对齐紫色，AI 回复左对齐白色 | [ ] |
| **G1.6 加载状态** | 发送后显示加载动画，收到回复后消失 | [ ] |
| **G1.7 多轮对话** | 连续发送 3 条消息，AI 能正确理解上下文 | [ ] |
| **G1.8 新建对话** | 点击新建对话按钮，清空历史并生成新会话 ID | [ ] |
| **G1.9 错误处理** | 后端停止时发送消息，显示友好错误提示 | [ ] |
| **G1.10 输入验证** | 空消息不能发送，发送中禁用按钮防重复 | [ ] |

#### 功能测试用例

| 测试 ID | 测试步骤 | 预期结果 | 通过 |
|---------|----------|----------|------|
| T1.1 | 输入"你好"，点击发送 | 显示加载动画，1-3秒后显示AI回复 | [ ] |
| T1.2 | 发送"和服の料金は？" | AI 用日语回复关于价格的信息 | [ ] |
| T1.3 | 继续发送"もっと詳しく" | AI 基于上文继续详细解释 | [ ] |
| T1.4 | 点击"新建对话" | 对话清空，重新开始 | [ ] |
| T1.5 | 发送"サイズは？" | 新会话，AI 不记得之前的对话 | [ ] |
| T1.6 | 停止后端服务，发送消息 | 显示"服务暂时不可用"等错误提示 | [ ] |
| T1.7 | 连续快速点击发送 3 次 | 只发送 1 条消息，不重复发送 | [ ] |

#### 阻断条件（不通过则不能进入 Phase 2）

- ❌ 页面无法正常加载
- ❌ 消息发送后无法收到 AI 回复
- ❌ 多轮对话上下文丢失
- ❌ 存在 JavaScript 报错导致功能异常
- ❌ 页面样式严重错乱

#### Gate 1 验收结论

```
验收日期: ____________
验收结果: [ ] 通过  [ ] 不通过
不通过原因: ________________________________________________
复核日期: ____________
```

---

### Phase 2: 测试辅助信息展示

**目标**: 展示 AI 决策过程信息

**预计时间**: 2-3 小时

**前置条件**: ✅ Gate 1 Review 通过

#### 任务清单

| 序号 | 任务 | 状态 |
|------|------|------|
| 2.1 | 解析 API 响应中的 sources 字段 | [ ] |
| 2.2 | 展示知识来源列表（问题+分数） | [ ] |
| 2.3 | 展示匹配分数（百分比格式） | [ ] |
| 2.4 | 展示使用的模型名称 (model_used) | [ ] |
| 2.5 | 展示置信度 (confidence) | [ ] |
| 2.6 | 展示响应时间 (latency_ms) | [ ] |
| 2.7 | 展示检测到的语言 (language) | [ ] |
| 2.8 | 实现来源详情折叠/展开功能 | [ ] |
| 2.9 | 优化信息展示样式，不影响阅读 | [ ] |

---

### ⭐ Gate 2 Review: 测试辅助信息验收

**验收时间点**: Phase 2 完成后

**验收人员**: 开发者自测 + 产品确认

#### 验收检查项

| 检查项 | 验收标准 | 通过 |
|--------|----------|------|
| **G2.1 来源展示** | 每条 AI 回复下方显示参考来源列表 | [ ] |
| **G2.2 分数格式** | 匹配分数以百分比显示（如 95%） | [ ] |
| **G2.3 模型信息** | 正确显示 qwen-plus 或 qwen-max | [ ] |
| **G2.4 置信度** | 正确显示置信度百分比 | [ ] |
| **G2.5 响应时间** | 正确显示响应耗时（如 1.2s） | [ ] |
| **G2.6 语言标识** | 正确显示检测到的语言（ja/zh/en） | [ ] |
| **G2.7 折叠功能** | 来源默认折叠，点击可展开查看详情 | [ ] |
| **G2.8 布局整洁** | 辅助信息不影响主要回复内容的阅读 | [ ] |
| **G2.9 无来源处理** | 当 sources 为空时，不显示来源区域 | [ ] |

#### 功能测试用例

| 测试 ID | 测试步骤 | 预期结果 | 通过 |
|---------|----------|----------|------|
| T2.1 | 发送"和服のサイズは？" | 显示来源列表，包含相关FAQ | [ ] |
| T2.2 | 查看来源分数 | 分数按百分比显示，最高分排前面 | [ ] |
| T2.3 | 查看模型信息 | 显示 qwen-plus 或 qwen-max | [ ] |
| T2.4 | 查看响应时间 | 显示合理的响应时间（通常1-5秒） | [ ] |
| T2.5 | 点击展开来源 | 显示来源 FAQ 的完整问答内容 | [ ] |
| T2.6 | 再次点击 | 折叠来源详情 | [ ] |
| T2.7 | 发送英文问题 | language 显示为 en | [ ] |

#### 阻断条件（不通过则不能进入 Phase 3）

- ❌ 来源信息无法正确解析和显示
- ❌ 关键信息（模型/置信度）显示错误
- ❌ 辅助信息遮挡或干扰主要回复内容
- ❌ 折叠/展开功能失效

#### Gate 2 验收结论

```
验收日期: ____________
验收结果: [ ] 通过  [ ] 不通过
不通过原因: ________________________________________________
复核日期: ____________
```

---

### Phase 3: 反馈功能

**目标**: 支持用户对回答进行评价

**预计时间**: 2-3 小时

**前置条件**: ✅ Gate 2 Review 通过

#### 任务清单

| 序号 | 任务 | 状态 |
|------|------|------|
| 3.1 | 添加 👍/👎 评价按钮 | [ ] |
| 3.2 | 实现按钮点击交互效果 | [ ] |
| 3.3 | 调用反馈 API 提交评价 | [ ] |
| 3.4 | 显示反馈提交中状态 | [ ] |
| 3.5 | 显示反馈成功提示 | [ ] |
| 3.6 | 防止对同一消息重复评价 | [ ] |
| 3.7 | 添加可选的文字反馈输入框 | [ ] |
| 3.8 | 处理反馈提交失败情况 | [ ] |

---

### ⭐ Gate 3 Review: 反馈功能验收

**验收时间点**: Phase 3 完成后

**验收人员**: 开发者自测 + 产品确认

#### 验收检查项

| 检查项 | 验收标准 | 通过 |
|--------|----------|------|
| **G3.1 按钮显示** | 每条 AI 回复显示 👍 和 👎 按钮 | [ ] |
| **G3.2 点击效果** | 点击按钮有视觉反馈（高亮/变色） | [ ] |
| **G3.3 API 调用** | 点击后正确调用 /api/v1/chat/feedback | [ ] |
| **G3.4 成功提示** | 提交成功后显示"感谢反馈"提示 | [ ] |
| **G3.5 防重复** | 已评价的消息，按钮禁用或隐藏 | [ ] |
| **G3.6 状态保持** | 刷新页面前，已评价状态保持 | [ ] |
| **G3.7 文字反馈** | 可选填写详细反馈意见 | [ ] |
| **G3.8 失败处理** | API 失败时显示错误提示，允许重试 | [ ] |

#### 功能测试用例

| 测试 ID | 测试步骤 | 预期结果 | 通过 |
|---------|----------|----------|------|
| T3.1 | 发送问题，收到回复 | 回复下方显示 👍 👎 按钮 | [ ] |
| T3.2 | 点击 👍 按钮 | 按钮高亮，显示"感谢反馈" | [ ] |
| T3.3 | 再次点击 👍 或 👎 | 按钮已禁用，无法重复评价 | [ ] |
| T3.4 | 对另一条回复点击 👎 | 正常提交差评反馈 | [ ] |
| T3.5 | 展开反馈输入框 | 可输入详细意见 | [ ] |
| T3.6 | 填写意见后提交 | 意见随评分一起提交 | [ ] |
| T3.7 | 断网后点击评价 | 显示错误提示，可重试 | [ ] |

#### 阻断条件（不通过则不能进入 Phase 4）

- ❌ 反馈按钮无法正常显示
- ❌ 点击反馈后 API 调用失败（非网络原因）
- ❌ 可以对同一消息重复提交反馈
- ❌ 反馈提交后无任何提示

#### Gate 3 验收结论

```
验收日期: ____________
验收结果: [ ] 通过  [ ] 不通过
不通过原因: ________________________________________________
复核日期: ____________
```

---

### Phase 4: 增强功能与优化

**目标**: 提升使用体验

**预计时间**: 3-4 小时

**前置条件**: ✅ Gate 3 Review 通过

#### 任务清单

| 序号 | 任务 | 状态 |
|------|------|------|
| 4.1 | 添加快捷问题按钮（预设测试问题） | [ ] |
| 4.2 | 实现 Enter 键发送消息 | [ ] |
| 4.3 | 添加系统状态指示器（在线/离线） | [ ] |
| 4.4 | 添加使用说明弹窗 | [ ] |
| 4.5 | 实现本地存储对话历史 (localStorage) | [ ] |
| 4.6 | 页面刷新后恢复对话 | [ ] |
| 4.7 | 优化移动端响应式布局 | [ ] |
| 4.8 | 添加页面初始 loading 状态 | [ ] |
| 4.9 | 消息区域自动滚动到底部 | [ ] |
| 4.10 | 整体 UI 细节优化 | [ ] |

---

### ⭐ Gate 4 Review: 增强功能验收（最终验收）

**验收时间点**: Phase 4 完成后

**验收人员**: 开发者自测 + 产品确认 + 客服人员试用

#### 验收检查项

| 检查项 | 验收标准 | 通过 |
|--------|----------|------|
| **G4.1 快捷问题** | 显示预设问题按钮，点击自动发送 | [ ] |
| **G4.2 键盘快捷键** | Enter 键可发送消息，Shift+Enter 换行 | [ ] |
| **G4.3 系统状态** | 显示后端连接状态（在线🟢/离线🔴） | [ ] |
| **G4.4 使用说明** | 点击帮助按钮显示使用说明弹窗 | [ ] |
| **G4.5 对话持久化** | 刷新页面后对话历史保留 | [ ] |
| **G4.6 自动滚动** | 新消息自动滚动到可视区域 | [ ] |
| **G4.7 移动端适配** | 手机浏览器可正常使用 | [ ] |
| **G4.8 加载状态** | 页面初始加载显示 loading | [ ] |

#### 功能测试用例

| 测试 ID | 测试步骤 | 预期结果 | 通过 |
|---------|----------|----------|------|
| T4.1 | 点击快捷问题"和服のレンタル料金" | 自动发送该问题并获得回复 | [ ] |
| T4.2 | 在输入框按 Enter 键 | 发送当前输入的消息 | [ ] |
| T4.3 | 按 Shift+Enter | 输入换行，不发送 | [ ] |
| T4.4 | 停止后端服务 | 状态变为离线（红色） | [ ] |
| T4.5 | 重启后端服务 | 状态恢复在线（绿色） | [ ] |
| T4.6 | 发送多条消息后刷新页面 | 对话历史完整保留 | [ ] |
| T4.7 | 点击"新建对话" | 历史清空，状态重置 | [ ] |
| T4.8 | 手机浏览器打开页面 | 布局正确，可正常操作 | [ ] |
| T4.9 | 发送 10 条消息 | 每条新消息自动滚动到可见 | [ ] |
| T4.10 | 点击帮助按钮 | 显示使用说明弹窗 | [ ] |

#### 浏览器兼容性测试

| 浏览器 | 版本 | 测试结果 | 通过 |
|--------|------|----------|------|
| Chrome | 最新 | | [ ] |
| Safari | 最新 | | [ ] |
| Firefox | 最新 | | [ ] |
| Edge | 最新 | | [ ] |
| iOS Safari | 最新 | | [ ] |
| Android Chrome | 最新 | | [ ] |

#### 响应式布局测试

| 设备/尺寸 | 测试结果 | 通过 |
|-----------|----------|------|
| 桌面 1920x1080 | | [ ] |
| 笔记本 1366x768 | | [ ] |
| iPad 1024x768 | | [ ] |
| iPhone 375x667 | | [ ] |

#### 阻断条件（不通过则不能上线）

- ❌ 核心功能（发送/接收/多轮对话）存在 bug
- ❌ Chrome/Safari 浏览器无法正常使用
- ❌ 页面存在明显的样式错乱
- ❌ JavaScript 控制台存在未处理的错误

#### Gate 4 验收结论

```
验收日期: ____________
验收结果: [ ] 通过  [ ] 不通过
不通过原因: ________________________________________________

最终验收签字:
开发者: ____________  日期: ____________
产品: ____________    日期: ____________
测试用户: ____________ 日期: ____________
```

---

## 六、技术实现要点

### 6.1 目录结构

```
kimono_ai_customer_service/
├── src/
│   ├── api/
│   │   ├── main.py          # 添加静态文件托管
│   │   └── ...
│   └── static/              # 新增：前端静态文件
│       ├── index.html       # 主页面
│       ├── css/
│       │   └── custom.css   # 自定义样式（如需要）
│       └── js/
│           └── app.js       # 主要逻辑（如需要分离）
└── ...
```

### 6.2 FastAPI 静态文件配置

```python
# src/api/main.py 需要添加
from fastapi.staticfiles import StaticFiles
from fastapi.responses import FileResponse

# 托管静态文件
app.mount("/static", StaticFiles(directory="static"), name="static")

# 根路径返回前端页面
@app.get("/")
async def root():
    return FileResponse("static/index.html")
```

### 6.3 CORS 配置

```python
# 如果前端独立部署，需要配置 CORS
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # 生产环境应限制具体域名
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### 6.4 API 调用示例

```javascript
// 发送消息
async function sendMessage(message, conversationId) {
    const response = await fetch('/api/v1/chat/message', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            message: message,
            conversation_id: conversationId
        })
    });
    return await response.json();
}

// 提交反馈
async function submitFeedback(messageId, rating, comment) {
    const response = await fetch('/api/v1/chat/feedback', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            message_id: messageId,
            rating: rating,
            comment: comment
        })
    });
    return await response.json();
}
```

---

## 七、部署方式

### 方式一：与后端一体化部署（推荐）

```bash
# 前端文件放在 src/static/ 目录
# 启动后端服务即可
./scripts/deploy.sh start

# 访问
# API: http://localhost:8000/api/v1/...
# 前端: http://localhost:8000/
```

### 方式二：Docker 部署

Dockerfile 需要添加静态文件复制：
```dockerfile
COPY src/static/ ./src/static/
```

```bash
./scripts/deploy.sh build
./scripts/deploy.sh up

# 访问 http://localhost:8000/
```

---

## 八、风险与应对

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|----------|
| API 响应慢导致体验差 | 中 | 中 | 添加加载动画和超时提示 |
| 移动端适配问题 | 低 | 低 | 使用 Tailwind 响应式类 |
| 浏览器兼容性 | 低 | 低 | 使用标准 ES6+，必要时 polyfill |
| 并发请求冲突 | 低 | 中 | 发送时禁用按钮，防重复提交 |

---

## 九、后续迭代方向（本期不做）

1. **数据统计面板** - 问答数量、满意度趋势
2. **知识库管理** - 在线添加/编辑 FAQ
3. **用户管理** - 登录、权限控制
4. **导出功能** - 导出测试对话记录
5. **A/B 测试** - 对比不同 prompt 效果

---

## 附录 A: 快捷测试问题（预设）

```javascript
const quickQuestions = [
    // 日语
    "和服のレンタル料金を教えてください",
    "サイズはどのようになっていますか？",
    "返却方法を教えてください",

    // 繁体中文
    "如何租借和服？",
    "有哪些尺寸可以選擇？",
    "可以幫忙穿和服嗎？",

    // 简体中文
    "和服租借的价格是多少？",
    "需要提前预约吗？",

    // 英语
    "How can I rent a kimono?",
    "What sizes are available?"
];
```

---

## 附录 B: 时间估算

| 阶段 | 开发时间 | Gate Review | 累计 |
|------|----------|-------------|------|
| Phase 1: 核心对话 | 4-6h | 0.5h | 6.5h |
| Phase 2: 辅助信息 | 2-3h | 0.5h | 10h |
| Phase 3: 反馈功能 | 2-3h | 0.5h | 13.5h |
| Phase 4: 增强优化 | 3-4h | 1h | 18.5h |
| 修复与调整 | 2-3h | - | 21.5h |
| **总计** | **约 2.5-3 工作日** | | |

---

## 附录 C: Gate Review 检查清单汇总

### 快速检查表

| Gate | 核心验收项 | 必须通过数 |
|------|-----------|-----------|
| Gate 1 | 页面加载、消息发送接收、多轮对话、错误处理 | 10/10 |
| Gate 2 | 来源展示、模型信息、置信度、折叠功能 | 9/9 |
| Gate 3 | 反馈按钮、API 调用、成功提示、防重复 | 8/8 |
| Gate 4 | 快捷问题、键盘快捷键、持久化、响应式 | 8/8 + 兼容性 |

### 验收记录表

| 阶段 | 验收日期 | 结果 | 验收人 | 备注 |
|------|----------|------|--------|------|
| Gate 1 | | | | |
| Gate 2 | | | | |
| Gate 3 | | | | |
| Gate 4 | | | | |

---

*文档版本: 1.1*
*最后更新: 2024年*
