# ç½‘ç«™æ•°æ®æŠ“å–æ–¹æ³•å¯¹æ¯”

## ğŸ¯ é—®é¢˜ï¼šä¸ºä»€ä¹ˆç®€å•çš„çˆ¬è™«æ— æ³•æŠ“å–å®˜ç½‘æ•°æ®ï¼Ÿ

**ç­”æ¡ˆ**ï¼šhefumiyabi.com ä½¿ç”¨**å®¢æˆ·ç«¯æ¸²æŸ“ (CSR)**ï¼Œå†…å®¹ç”± JavaScript åŠ¨æ€ç”Ÿæˆã€‚

---

## ğŸ“Š æŠ€æœ¯å¯¹æ¯”

### 1. ç®€å• HTTP è¯·æ±‚ï¼ˆç°æœ‰æ–¹æ¡ˆï¼‰

**è„šæœ¬**: `scripts/scrape-plans.js`

**å·¥ä½œåŸç†**:
```
Node.js â†’ HTTP GET â†’ è·å–HTML â†’ è§£æé™æ€å†…å®¹
```

**ä¼˜ç‚¹**:
- âœ… é€Ÿåº¦å¿«
- âœ… èµ„æºæ¶ˆè€—å°‘
- âœ… æ— éœ€é¢å¤–ä¾èµ–
- âœ… é€‚åˆæœåŠ¡ç«¯æ¸²æŸ“ (SSR) ç½‘ç«™

**ç¼ºç‚¹**:
- âŒ æ— æ³•æ‰§è¡Œ JavaScript
- âŒ æ— æ³•æŠ“å–å®¢æˆ·ç«¯æ¸²æŸ“å†…å®¹
- âŒ æ— æ³•å¤„ç†åŠ¨æ€åŠ è½½çš„æ•°æ®

**é€‚ç”¨åœºæ™¯**:
- é™æ€ HTML ç½‘ç«™
- æœåŠ¡ç«¯æ¸²æŸ“ (SSR) ç½‘ç«™
- API ç«¯ç‚¹

---

### 2. Puppeteer/Playwrightï¼ˆæ¨èï¼‰

**è„šæœ¬**: `scripts/scrape-plans-puppeteer.js`

**å·¥ä½œåŸç†**:
```
å¯åŠ¨æµè§ˆå™¨ â†’ è®¿é—®é¡µé¢ â†’ ç­‰å¾…JSæ‰§è¡Œ â†’ æå–æ•°æ®
```

**ä¼˜ç‚¹**:
- âœ… å®Œæ•´æµè§ˆå™¨ç¯å¢ƒ
- âœ… æ”¯æŒå®¢æˆ·ç«¯æ¸²æŸ“
- âœ… å¯ä»¥ç­‰å¾…å…ƒç´ åŠ è½½
- âœ… æ”¯æŒæˆªå›¾è°ƒè¯•
- âœ… å¯ä»¥å¤„ç†å¤æ‚äº¤äº’

**ç¼ºç‚¹**:
- âŒ éœ€è¦å®‰è£… Chromiumï¼ˆ~170MBï¼‰
- âŒ èµ„æºæ¶ˆè€—è¾ƒå¤§
- âŒ é€Ÿåº¦è¾ƒæ…¢

**å®‰è£…ä¾èµ–**:
```bash
# Puppeteer (åŒ…å« Chromium)
npm install puppeteer

# æˆ–ä½¿ç”¨ Playwright
npm install playwright
```

**ä½¿ç”¨æ–¹æ³•**:
```bash
node scripts/scrape-plans-puppeteer.js
```

---

### 3. æ‰‹åŠ¨æå–ï¼ˆå½“å‰ä½¿ç”¨ï¼‰

**è„šæœ¬**: `scripts/scrape-plans.js`ï¼ˆæ‰‹åŠ¨æ•°æ®ï¼‰

**å·¥ä½œåŸç†**:
```
æµè§ˆå™¨æ‰‹åŠ¨æŸ¥çœ‹ â†’ è®°å½•æ•°æ® â†’ ç¡¬ç¼–ç åˆ°è„šæœ¬
```

**ä¼˜ç‚¹**:
- âœ… 100% å‡†ç¡®
- âœ… æ— éœ€ç½‘ç»œè¯·æ±‚
- âœ… é€Ÿåº¦å¿«
- âœ… å¯æ§æ€§å¼º

**ç¼ºç‚¹**:
- âŒ éœ€è¦æ‰‹åŠ¨ç»´æŠ¤
- âŒ æ•°æ®æ›´æ–°éœ€è¦äººå·¥æ“ä½œ
- âŒ ä¸é€‚åˆå¤§é‡æ•°æ®

**å½“å‰æ•°æ®**:
å·²æ‰‹åŠ¨æå– 5 ä¸ªå¥—é¤çš„å®Œæ•´æ•°æ®ï¼Œä¿å­˜åœ¨ `data/plans-data.json`

---

### 4. API ç«¯ç‚¹ï¼ˆæœ€ä½³æ–¹æ¡ˆï¼‰

**å¦‚æœå®˜ç½‘æä¾› API**:

```javascript
// ç¤ºä¾‹ï¼šè°ƒç”¨å®˜ç½‘ API
const response = await fetch('https://hefumiyabi.com/api/plans');
const plans = await response.json();
```

**ä¼˜ç‚¹**:
- âœ… æœ€å¿«æœ€å‡†ç¡®
- âœ… å®˜æ–¹æ”¯æŒ
- âœ… æ•°æ®ç»“æ„åŒ–
- âœ… æ— éœ€è§£æ HTML

**ç¼ºç‚¹**:
- âŒ éœ€è¦å®˜ç½‘æä¾› API
- âŒ å¯èƒ½éœ€è¦è®¤è¯
- âŒ hefumiyabi.com ç›®å‰æœªå…¬å¼€ API

---

## ğŸ” å¦‚ä½•æ£€æµ‹ç½‘ç«™çš„æ¸²æŸ“æ–¹å¼

### æ–¹æ³• 1ï¼šæŸ¥çœ‹æºä»£ç 
```bash
curl https://hefumiyabi.com/zh/plan | grep "å¥—é¤"
```

- **æœ‰å†…å®¹** = æœåŠ¡ç«¯æ¸²æŸ“ (SSR)
- **æ— å†…å®¹/ç©ºç™½** = å®¢æˆ·ç«¯æ¸²æŸ“ (CSR)

### æ–¹æ³• 2ï¼šæµè§ˆå™¨æ£€æŸ¥
1. å³é”® â†’ "æŸ¥çœ‹ç½‘é¡µæºä»£ç "
2. æœç´¢é¡µé¢å¯è§å†…å®¹
3. æ‰¾ä¸åˆ° = å®¢æˆ·ç«¯æ¸²æŸ“

### æ–¹æ³• 3ï¼šNetwork é¢æ¿
1. æ‰“å¼€å¼€å‘è€…å·¥å…· â†’ Network
2. åˆ·æ–°é¡µé¢
3. æŸ¥çœ‹ HTML æ–‡æ¡£å†…å®¹
4. æŸ¥çœ‹åç»­çš„ API è¯·æ±‚

---

## ğŸ“ å½“å‰é¡¹ç›®çš„æŠ“å–ç­–ç•¥

### ç°çŠ¶
æˆ‘ä»¬å·²ç»ä½¿ç”¨**æ‰‹åŠ¨æå–**çš„æ–¹å¼è·å–äº†å®˜ç½‘æ•°æ®ï¼š

- âœ… 5 ä¸ªå¥—é¤
- âœ… å®Œæ•´çš„å­—æ®µï¼ˆåç§°ã€ä»·æ ¼ã€æè¿°ã€å›¾ç‰‡ã€ç‰¹è‰²ï¼‰
- âœ… é€‚ç”¨åº—é“ºä¿¡æ¯
- âœ… ä¿å­˜ä¸º JSON æ ¼å¼

**æ•°æ®æ–‡ä»¶**: `data/plans-data.json`

### æœªæ¥æ›´æ–°ç­–ç•¥

**é€‰é¡¹ 1ï¼šç»§ç»­æ‰‹åŠ¨æ›´æ–°**
- æ¯å­£åº¦æ£€æŸ¥å®˜ç½‘ä¸€æ¬¡
- æ‰‹åŠ¨æ›´æ–° `data/plans-data.json`
- é€‚åˆæ•°æ®å˜åŒ–ä¸é¢‘ç¹çš„åœºæ™¯

**é€‰é¡¹ 2ï¼šä½¿ç”¨ Puppeteer**
- å®‰è£…ä¾èµ–: `npm install puppeteer`
- è¿è¡Œè„šæœ¬: `node scripts/scrape-plans-puppeteer.js`
- è‡ªåŠ¨åŒ–æ›´æ–°æ•°æ®

**é€‰é¡¹ 3ï¼šè”ç³»å®˜ç½‘ç”³è¯· API**
- æœ€ç†æƒ³çš„æ–¹æ¡ˆ
- éœ€è¦å’Œå®˜ç½‘æŠ€æœ¯å›¢é˜Ÿæ²Ÿé€š

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨ç°æœ‰æ•°æ®ï¼ˆæ¨èï¼‰

```bash
# æ•°æ®å·²å‡†å¤‡å¥½ï¼Œç›´æ¥ä½¿ç”¨
cat data/plans-data.json

# å¯¼å…¥æ•°æ®åº“
node scripts/import-scraped-plans.js
```

### ä½¿ç”¨ Puppeteer é‡æ–°æŠ“å–

```bash
# 1. å®‰è£…ä¾èµ–
npm install puppeteer

# 2. è¿è¡Œçˆ¬è™«
node scripts/scrape-plans-puppeteer.js

# 3. æŸ¥çœ‹ç»“æœ
ls data/puppeteer-plans-*.json
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Puppeteer å®˜æ–¹æ–‡æ¡£](https://pptr.dev/)
- [Playwright å®˜æ–¹æ–‡æ¡£](https://playwright.dev/)
- [Next.js æ¸²æŸ“æ–¹å¼](https://nextjs.org/docs/basic-features/pages)
- [Web Scraping Best Practices](https://www.scraperapi.com/blog/web-scraping-best-practices/)

---

## âš ï¸ æ³•å¾‹å’Œé“å¾·å£°æ˜

1. **éµå®ˆ robots.txt**
   ```bash
   curl https://hefumiyabi.com/robots.txt
   ```

2. **æ·»åŠ å»¶è¿Ÿ**
   ```javascript
   await page.waitForTimeout(2000); // ç­‰å¾…2ç§’
   ```

3. **å°Šé‡ç½‘ç«™æ¡æ¬¾**
   - ä¸è¦é¢‘ç¹è¯·æ±‚
   - ä¸è¦ç»™æœåŠ¡å™¨é€ æˆè´Ÿæ‹…
   - ä»…ç”¨äºå­¦ä¹ å’Œä¸ªäººé¡¹ç›®

4. **ä¼˜å…ˆä½¿ç”¨å®˜æ–¹ API**
   - å¦‚æœæœ‰å…¬å¼€ APIï¼Œä¼˜å…ˆä½¿ç”¨
   - è€ƒè™‘è”ç³»å®˜æ–¹ç”³è¯·æƒé™

---

## ğŸ“§ è”ç³»æˆ‘ä»¬

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issueã€‚
