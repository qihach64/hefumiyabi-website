# å’Œæœç§Ÿèµå¥—é¤æ•°æ®æ¨¡å‹é‡è®¾è®¡æ–¹æ¡ˆ

> **æ–‡æ¡£æ—¥æœŸ**: 2025-11-02
> **ç›®æ ‡**: è§£å†³"é€‰æ‹©å›°éš¾"é—®é¢˜,å›´ç»•"æ ‡å‡†åŒ–å¥—é¤"æ‰“ç£¨é¢„çº¦æµç¨‹,è®©æ¸¸å®¢æ›´å®¹æ˜“å¿«é€Ÿå†³ç­–

---

## ğŸ“‹ ç›®å½•

1. [æ ¸å¿ƒé—®é¢˜åˆ†æ](#æ ¸å¿ƒé—®é¢˜åˆ†æ)
2. [ç°æœ‰ç³»ç»Ÿæ¶æ„æ€»ç»“](#ç°æœ‰ç³»ç»Ÿæ¶æ„æ€»ç»“)
3. [æ¸¸å®¢å†³ç­–å¿ƒç†æ¨¡å‹](#æ¸¸å®¢å†³ç­–å¿ƒç†æ¨¡å‹)
4. [æ–°çš„ç­›é€‰ç»´åº¦è®¾è®¡](#æ–°çš„ç­›é€‰ç»´åº¦è®¾è®¡)
5. [æ•°æ®æ¨¡å‹é‡è®¾è®¡æ–¹æ¡ˆ](#æ•°æ®æ¨¡å‹é‡è®¾è®¡æ–¹æ¡ˆ)
6. [å‰ç«¯ç­›é€‰å™¨è®¾è®¡](#å‰ç«¯ç­›é€‰å™¨è®¾è®¡)
7. [æ•°æ®è¿ç§»ç­–ç•¥](#æ•°æ®è¿ç§»ç­–ç•¥)
8. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)
9. [å¾…è®¨è®ºå†³ç­–ç‚¹](#å¾…è®¨è®ºå†³ç­–ç‚¹)

---

## æ ¸å¿ƒé—®é¢˜åˆ†æ

### é—®é¢˜é™ˆè¿°

> "æˆ‘å»éº¦å½“åŠ³èƒ½å¤Ÿå¾ˆå¿«å†³å®šè¦åƒé¸¡è…¿æ±‰å ¡ã€ç‰›è‚‰æ±‰å ¡æˆ–è€…é¸¡å—å¥—é¤,ä½†æ˜¯å’Œæœå¥—é¤æ¯ä¸ªçœ‹ä¸Šå»éƒ½å·®ä¸å¤šã€‚"

**æ ¹æœ¬åŸå› **:
- æ¸¸å®¢æ²¡æœ‰æ—¶é—´ã€ç²¾åŠ›å’Œè€æ€§å»ç­›é€‰å’Œå®šåˆ¶å’Œæœå¥—é¤
- å•†å®¶æ²¡æœ‰æ—¶é—´ã€ç²¾åŠ›å’Œæ–¹æ³•æ¥ç®¡ç†ç§ç±»ç¹å¤šçš„åº“å­˜å’Œé¢„çº¦
- **ç¼ºå°‘æ˜ç¡®çš„å·®å¼‚åŒ–å†³ç­–ç»´åº¦**

### å½“å‰å†³ç­–è·¯å¾„å¯¹æ¯”

**éº¦å½“åŠ³å†³ç­– (3ç§’)**:
```
æˆ‘æƒ³åƒä»€ä¹ˆ? â†’ é¸¡è‚‰/ç‰›è‚‰/é±¼ â†’ ä»·æ ¼ â†’ å®Œæˆ
        â†“
    æ˜ç¡®å·®å¼‚åŒ–
```

**å½“å‰å’Œæœç§Ÿèµå†³ç­– (30åˆ†é’Ÿ?)**:
```
æˆ‘æƒ³ç§Ÿä»€ä¹ˆ? â†’ çœ‹åˆ†ç±»(å¥³å£«/ç”·å£«/æƒ…ä¾£...) â†’ çœ‹300ä¸ªå¥—é¤ â†’ ???
        â†“
    å…¨æ˜¯ç…§ç‰‡ + ä»·æ ¼ + "åŒ…å«æœåŠ¡"
    â†“
  çœ‹ä¸å‡ºå·®å¼‚!
```

### ç°æœ‰ç­›é€‰ç»´åº¦çš„é—®é¢˜

| ç­›é€‰ç»´åº¦ | å¯¹æ¸¸å®¢æœ‰ç”¨å—? | é—®é¢˜ |
|---------|--------------|------|
| **åœ°åŒº** (region) | âœ… æœ‰ç”¨ | ä½†æ”¾åœ¨ç¬¬ä¸€ä½ä¸åˆç† |
| **åº—é“º** (storeName) | âš ï¸ ä¸­æ€§ | æ¸¸å®¢ä¸å…³å¿ƒå“ªå®¶åº—,åªå…³å¿ƒä½ç½® |
| **åˆ†ç±»** (category) | âš ï¸ éƒ¨åˆ†æœ‰ç”¨ | LADIES/MENS å¤ªå®½æ³›,SPECIAL æ— æ„ä¹‰ |
| **æ ‡ç­¾** (tags) | âŒ æ— ç”¨ | æ‚ä¹±æ— ç« ,æ²¡æœ‰ç»Ÿä¸€æ ‡å‡† |
| **æ´»åŠ¨** (isCampaign) | âš ï¸ ä¿ƒé”€æ„ä¹‰ | ä¸æ˜¯å†³ç­–ç»´åº¦ |
| **ä»·æ ¼** | âœ… æœ‰ç”¨ | ä½†æ²¡æœ‰ä»·æ ¼åŒºé—´ç­›é€‰å™¨! |

**æ ¸å¿ƒé—®é¢˜**: ç¼ºå°‘**ä½“éªŒç»´åº¦**çš„å·®å¼‚åŒ–!

---

## ç°æœ‰ç³»ç»Ÿæ¶æ„æ€»ç»“

### æ ¸å¿ƒæ•°æ®æ¨¡å‹

#### RentalPlan (ç»Ÿä¸€å¥—é¤æ¨¡å‹)

```prisma
model RentalPlan {
  // åŸºç¡€ä¿¡æ¯
  id            String   @id @default(cuid())
  slug          String   @unique
  name          String
  nameEn        String?
  description   String
  category      PlanCategory  // LADIES/MENS/COUPLE/FAMILY/GROUP/SPECIAL

  // ä»·æ ¼ï¼ˆå•ä½ï¼šåˆ†ï¼‰
  price         Int           // å®é™…é”€å”®ä»·æ ¼
  originalPrice Int?          // çº¿ä¸‹åŸä»·ï¼ˆç”¨äºæ˜¾ç¤ºä¼˜æƒ ï¼‰
  depositAmount Int @default(0)

  // æœåŠ¡ä¿¡æ¯
  duration      Int           // ç§Ÿèµæ—¶é•¿ï¼ˆå°æ—¶ï¼‰
  includes      String[]      // åŒ…å«é¡¹ç›®åˆ—è¡¨
  imageUrl      String?

  // åº—é“ºå’Œåœ°åŒºä¿¡æ¯
  storeName     String?
  region        String?
  tags          String[] @default([])

  // æ´»åŠ¨å…³è”
  campaignId    String?
  campaign      Campaign? @relation(fields: [campaignId], references: [id])

  // æ´»åŠ¨ç‰¹æ€§æ ‡è®°
  isCampaign      Boolean @default(false)
  isLimited       Boolean @default(false)
  maxBookings     Int?
  currentBookings Int @default(0)

  // æ—¶é—´é™åˆ¶
  availableFrom  DateTime?
  availableUntil DateTime?

  // çŠ¶æ€æ§åˆ¶
  isActive   Boolean @default(true)
  isFeatured Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // å…³ç³»
  bookingItems BookingItem[]
  cartItems    CartItem[]
}
```

### ç°æœ‰æ¶æ„é—®é¢˜

1. **æ•°æ®æ¨¡å‹å†—ä½™**: RentalPlan å’Œ CampaignPlan å¹¶å­˜,è¿ç§»æœªå®Œæˆ
2. **Kimono å’Œ RentalPlan å…³ç³»ä¸æ˜ç¡®**: æ— æ³•åœ¨é¢„è®¢æ—¶é€‰æ‹©å…·ä½“å’Œæœæ¬¾å¼
3. **å¤šåº—é“ºé¢„è®¢å¤æ‚æ€§**: åŒä¸€é¢„è®¢å¯ä»¥æœ‰ä¸åŒåº—é“º,ç”¨æˆ·ä½“éªŒæ··ä¹±
4. **åº—é“ºç­›é€‰é€»è¾‘ä¸å‡†ç¡®**: ä½¿ç”¨å­—ç¬¦ä¸² `includes` åŒ¹é…è€Œéå¤–é”®å…³ç³»
5. **ç¼ºå°‘åº“å­˜ç®¡ç†**: æ²¡æœ‰æ—¥æœŸçº§åˆ«çš„å¯ç”¨æ€§æ£€æŸ¥
6. **æ—¶é—´å­—æ®µè®¾è®¡ä¸åˆç†**: `visitTime` å­˜å‚¨ä¸ºå­—ç¬¦ä¸²
7. **å¥—é¤åˆ†ç±»é€»è¾‘ä¸çµæ´»**: ç¡¬ç¼–ç æšä¸¾,æ— æ³•åŠ¨æ€æ‰©å±•
8. **ä»·æ ¼å’Œå®šé‡‘é€»è¾‘æœªå®ç°**: å®šé‡‘å§‹ç»ˆä¸º 0,æ— æ”¯ä»˜æµç¨‹

### å…³é”®æ–‡ä»¶è·¯å¾„

**æ•°æ®æ¨¡å‹**:
- `prisma/schema.prisma` - æ•°æ®åº“ schema

**å‰ç«¯é¡µé¢**:
- `src/app/(main)/plans/page.tsx` - å¥—é¤åˆ—è¡¨
- `src/app/(main)/plans/PlansClient.tsx` - å®¢æˆ·ç«¯ç­›é€‰
- `src/app/(main)/plans/[id]/page.tsx` - å¥—é¤è¯¦æƒ…
- `src/app/(main)/cart/page.tsx` - è´­ç‰©è½¦
- `src/app/(main)/booking/page.tsx` - ç»“ç®—é¡µ

**ç»„ä»¶**:
- `src/components/PlanCard.tsx` - å¥—é¤å¡ç‰‡
- `src/components/BookingCard.tsx` - é¢„è®¢å¡ç‰‡

**çŠ¶æ€ç®¡ç†**:
- `src/store/cart.ts` - è´­ç‰©è½¦çŠ¶æ€

**API**:
- `src/app/api/bookings/route.ts` - é¢„è®¢ API
- `src/app/api/plans/[id]/route.ts` - å¥—é¤è¯¦æƒ… API

**æ•°æ®è„šæœ¬**:
- `scripts/import-unified-plans.ts` - å¯¼å…¥è„šæœ¬
- `data/real-plans-data.json` - å¸¸è§„å¥—é¤æ•°æ® (967ä¸ª)
- `data/real-campaigns-data.json` - æ´»åŠ¨å¥—é¤æ•°æ®

---

## æ¸¸å®¢å†³ç­–å¿ƒç†æ¨¡å‹

### æ¸¸å®¢çœŸæ­£å…³å¿ƒçš„å†³ç­–ç»´åº¦

#### 1. ä½¿ç”¨åœºæ™¯ (æœ€é‡è¦!)

æ¸¸å®¢é¢„è®¢å’Œæœæ˜¯ä¸ºäº†:

```typescript
enum ExperienceScene {
  CASUAL_WALK = 'casual_walk',      // éšä¾¿é€›é€›æ‹ç…§
  TEMPLE_VISIT = 'temple_visit',    // å¯ºåº™å‚æ‹œ
  FESTIVAL = 'festival',            // ç¥­å…¸æ´»åŠ¨
  WEDDING_GUEST = 'wedding_guest',  // å‚åŠ å©šç¤¼
  PHOTOSHOOT = 'photoshoot',        // ä¸“ä¸šå†™çœŸ
  DATE = 'date',                    // çº¦ä¼š
  FAMILY_TRIP = 'family_trip',      // å®¶åº­å‡ºæ¸¸
}
```

**ä¸ºä»€ä¹ˆé‡è¦?**
- ä¸åŒåœºæ™¯å¯¹å’Œæœçš„**æ­£å¼åº¦**ã€**èˆ’é€‚åº¦**ã€**ä»·æ ¼**è¦æ±‚å®Œå…¨ä¸åŒ
- æ¸¸å®¢è„‘æµ·é‡Œçš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯"æˆ‘è¦å¹²å˜›?"è€Œé"æˆ‘è¦ç§Ÿä»€ä¹ˆç±»å‹çš„å’Œæœ?"

#### 2. æ—¶é•¿éœ€æ±‚

```typescript
enum DurationPreference {
  SHORT = '2-3å°æ—¶',   // å¿«é€Ÿä½“éªŒ
  HALF_DAY = '4-6å°æ—¶', // åŠæ—¥æ¸¸
  FULL_DAY = '8å°æ—¶+',  // å…¨æ—¥æ¸¸
  OVERNIGHT = 'è¿‡å¤œ',   // ç‰¹æ®Šåœºæ™¯
}
```

**å½“å‰é—®é¢˜**:
- æ‰€æœ‰å¥—é¤éƒ½æœ‰ `duration` å­—æ®µ,ä½†æ¸¸å®¢**æ— æ³•æŒ‰æ—¶é•¿ç­›é€‰**
- éœ€è¦æ‰‹åŠ¨ç‚¹å¼€æ¯ä¸ªå¥—é¤æŸ¥çœ‹

#### 3. é¢„ç®—åŒºé—´ (è€Œéå…·ä½“ä»·æ ¼)

```typescript
enum PriceRange {
  BUDGET = 'Â¥200ä»¥ä¸‹',      // ç»æµå‹
  STANDARD = 'Â¥200-400',   // æ ‡å‡†å‹
  PREMIUM = 'Â¥400-600',    // é«˜çº§å‹
  LUXURY = 'Â¥600+',        // è±ªåå‹
}
```

**å½“å‰é—®é¢˜**:
- ä»·æ ¼ä»¥"åˆ†"å­˜å‚¨,å‰ç«¯æ²¡æœ‰ä»·æ ¼åŒºé—´ç­›é€‰å™¨
- æ¸¸å®¢éœ€è¦æ»šåŠ¨æ‰€æœ‰å¥—é¤æ¯”è¾ƒä»·æ ¼

#### 4. é£æ ¼/ä¸»é¢˜

```typescript
enum KimonoStyle {
  TRADITIONAL = 'traditional',  // ä¼ ç»Ÿå¤å…¸
  MODERN = 'modern',           // æ—¶å°šç°ä»£
  ELEGANT = 'elegant',         // ä¼˜é›…ç«¯åº„
  CUTE = 'cute',               // å¯çˆ±ç”œç¾
  LUXURIOUS = 'luxurious',     // åä¸½å¥¢å
  SIMPLE = 'simple',           // ç®€çº¦ç´ é›…
}
```

**å½“å‰é—®é¢˜**:
- æ²¡æœ‰é£æ ¼æ ‡ç­¾ç³»ç»Ÿ
- `tags` å­—æ®µæ‚ä¹±æ— ç« ,æ²¡æœ‰æ ‡å‡†åŒ–

#### 5. é€‚åˆäººç¾¤ (æ›´ç²¾ç»†çš„åˆ†ç±»)

```typescript
enum TargetAudience {
  YOUNG_WOMAN = 'young_woman',       // å¹´è½»å¥³æ€§(18-25)
  MATURE_WOMAN = 'mature_woman',     // æˆç†Ÿå¥³æ€§(26-40)
  YOUNG_MAN = 'young_man',           // å¹´è½»ç”·æ€§
  MATURE_MAN = 'mature_man',         // æˆç†Ÿç”·æ€§
  COUPLE = 'couple',                 // æƒ…ä¾£
  FAMILY_WITH_KIDS = 'family_kids',  // äº²å­å®¶åº­
  SENIORS = 'seniors',               // è€å¹´äºº
  PLUS_SIZE = 'plus_size',           // å¤§ç å‹å¥½
}
```

**ä¸ºä»€ä¹ˆé‡è¦?**
- å½“å‰çš„ `category` åªæœ‰ LADIES/MENS,å¤ªç²—ç³™
- ä¸åŒå¹´é¾„æ®µå¯¹å’Œæœæ¬¾å¼çš„éœ€æ±‚å·®å¼‚å·¨å¤§

#### 6. åŒ…å«æœåŠ¡ç­‰çº§

```typescript
enum ServiceLevel {
  BASIC = 'basic',           // åŸºç¡€ï¼šå’Œæœ+é…ä»¶
  STANDARD = 'standard',     // æ ‡å‡†ï¼š+å‘å‹è®¾è®¡
  PREMIUM = 'premium',       // é«˜çº§ï¼š+åŒ–å¦†+æ‘„å½±
  VIP = 'vip',              // VIPï¼š+ä¸“å±é¡¾é—®+ä¿®å›¾
}
```

**å½“å‰é—®é¢˜**:
- `includes` æ˜¯å­—ç¬¦ä¸²æ•°ç»„,æ— æ³•æ ‡å‡†åŒ–æ¯”è¾ƒ
- æ¸¸å®¢æ— æ³•å¿«é€Ÿè¯†åˆ«"è¿™ä¸ªå¥—é¤æ¯”é‚£ä¸ªå¥—é¤å¤šäº†ä»€ä¹ˆ"

#### 7. ä¾¿åˆ©æ€§å› ç´ 

```typescript
interface ConvenienceFeatures {
  freeParking: boolean;        // å…è´¹åœè½¦
  nearStation: boolean;        // åœ°é“ç«™é™„è¿‘
  englishSupport: boolean;     // è‹±æ–‡æœåŠ¡
  wheelchairAccessible: boolean; // æ— éšœç¢é€šé“
  changeRoomPrivate: boolean;  // ç‹¬ç«‹æ›´è¡£å®¤
  luggageStorage: boolean;     // è¡Œæå¯„å­˜
  lastMinuteBooking: boolean;  // æ”¯æŒä¸´æ—¶é¢„çº¦
}
```

**å½“å‰é—®é¢˜**:
- è¿™äº›ä¿¡æ¯æ•£è½åœ¨ `description` æ–‡æœ¬ä¸­
- æ— æ³•ç­›é€‰å’Œå¯¹æ¯”

---

## æ–°çš„ç­›é€‰ç»´åº¦è®¾è®¡

### æ¨èçš„å†³ç­–ç»´åº¦ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ç»´åº¦ | é‡è¦æ€§ | å½“å‰æ”¯æŒ | æ”¹è¿›éš¾åº¦ |
|--------|------|--------|----------|----------|
| **P0** | ä½¿ç”¨åœºæ™¯ | â­â­â­â­â­ | âŒ | ä¸­ |
| **P0** | ä»·æ ¼åŒºé—´ | â­â­â­â­â­ | âŒ | ä½ |
| **P0** | æœåŠ¡ç­‰çº§ | â­â­â­â­â­ | âŒ | ä¸­ |
| **P1** | ç§Ÿèµæ—¶é•¿ | â­â­â­â­ | âš ï¸ (æœ‰å­—æ®µä½†æ— ç­›é€‰) | ä½ |
| **P1** | é£æ ¼ä¸»é¢˜ | â­â­â­â­ | âŒ | ä¸­ |
| **P1** | é€‚åˆäººç¾¤ | â­â­â­â­ | âš ï¸ (categoryå¤ªç²—ç³™) | ä¸­ |
| **P2** | åœ°åŒºä½ç½® | â­â­â­ | âœ… | - |
| **P2** | ä¾¿åˆ©æ€§ç‰¹æ€§ | â­â­â­ | âŒ | é«˜ |
| **P2** | æ´»åŠ¨ä¿ƒé”€ | â­â­ | âœ… | - |

---

## æ•°æ®æ¨¡å‹é‡è®¾è®¡æ–¹æ¡ˆ

### æ–¹æ¡ˆA: æœ€å°æ”¹åŠ¨ (å¿«é€ŸMVP)

åœ¨ç°æœ‰ `RentalPlan` æ¨¡å‹ä¸Šå¢åŠ æ ‡å‡†åŒ–å­—æ®µ:

```prisma
model RentalPlan {
  // ... ä¿ç•™ç°æœ‰å­—æ®µ ...

  // æ–°å¢å†³ç­–ç»´åº¦
  scene           ExperienceScene[]  @default([])  // é€‚ç”¨åœºæ™¯
  style           KimonoStyle[]      @default([])  // é£æ ¼æ ‡ç­¾
  targetAudience  TargetAudience[]   @default([])  // é€‚åˆäººç¾¤
  serviceLevel    ServiceLevel                     // æœåŠ¡ç­‰çº§

  // ä¾¿åˆ©æ€§ç‰¹æ€§
  features        Json?  // å­˜å‚¨ ConvenienceFeatures

  // ä¼˜åŒ–ç°æœ‰å­—æ®µ
  priceRange      PriceRange  // å†—ä½™å­—æ®µ,æ–¹ä¾¿ç­›é€‰
  durationRange   DurationPreference  // å†—ä½™å­—æ®µ

  // å…³è”åº—é“º(ä¿®å¤ç°æœ‰é—®é¢˜)
  storeId         String?
  store           Store? @relation(fields: [storeId])

  @@index([scene])
  @@index([priceRange])
  @@index([style])
  @@index([serviceLevel])
}

// æšä¸¾å®šä¹‰
enum ExperienceScene {
  CASUAL_WALK
  TEMPLE_VISIT
  FESTIVAL
  WEDDING_GUEST
  PHOTOSHOOT
  DATE
  FAMILY_TRIP
}

enum KimonoStyle {
  TRADITIONAL
  MODERN
  ELEGANT
  CUTE
  LUXURIOUS
  SIMPLE
}

enum ServiceLevel {
  BASIC
  STANDARD
  PREMIUM
  VIP
}

enum PriceRange {
  BUDGET      // Â¥200ä»¥ä¸‹
  STANDARD    // Â¥200-400
  PREMIUM     // Â¥400-600
  LUXURY      // Â¥600+
}

enum DurationPreference {
  SHORT       // 2-3å°æ—¶
  HALF_DAY    // 4-6å°æ—¶
  FULL_DAY    // 8å°æ—¶+
  OVERNIGHT   // è¿‡å¤œ
}

enum TargetAudience {
  YOUNG_WOMAN
  MATURE_WOMAN
  YOUNG_MAN
  MATURE_MAN
  COUPLE
  FAMILY_WITH_KIDS
  SENIORS
  PLUS_SIZE
}
```

**ä¼˜ç‚¹**:
- âœ… æ”¹åŠ¨å°,å…¼å®¹ç°æœ‰æ•°æ®
- âœ… å¯ä»¥é€šè¿‡è„šæœ¬è¿ç§»ç°æœ‰å¥—é¤
- âœ… ç«‹å³æ”¯æŒæ–°ç­›é€‰ç»´åº¦
- âœ… æŸ¥è¯¢æ€§èƒ½å¥½(æšä¸¾å­—æ®µ+ç´¢å¼•)

**ç¼ºç‚¹**:
- âŒ éƒ¨åˆ†å­—æ®µå†—ä½™(å¦‚ priceRange å¯ä»¥ä» price è®¡ç®—)
- âŒ æšä¸¾ç±»å‹ä¸å¤Ÿçµæ´»,å¢åŠ æ–°å€¼éœ€è¦è¿ç§»
- âŒ å›½é™…åŒ–æ”¯æŒå›°éš¾

---

### æ–¹æ¡ˆB: æ ‡ç­¾ç³»ç»Ÿé‡æ„ (æ¨è)

å¼•å…¥æ ‡å‡†åŒ–çš„æ ‡ç­¾åˆ†ç±»ç³»ç»Ÿ:

```prisma
// æ ‡ç­¾åˆ†ç±»ä¸»è¡¨
model TagCategory {
  id          String @id @default(cuid())
  code        String @unique  // 'scene', 'style', 'audience' ç­‰
  name        String
  nameEn      String?
  description String?
  order       Int @default(0)
  isRequired  Boolean @default(false)  // æ˜¯å¦å¿…é€‰

  tags        Tag[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// æ ‡ç­¾è¡¨
model Tag {
  id          String @id @default(cuid())
  categoryId  String
  code        String
  name        String
  nameEn      String?
  icon        String?  // Lucide icon name
  description String?
  order       Int @default(0)

  category    TagCategory @relation(fields: [categoryId], references: [id])
  plans       PlanTag[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([categoryId, code])
  @@index([categoryId])
}

// å¥—é¤-æ ‡ç­¾å…³è”è¡¨(å¤šå¯¹å¤š)
model PlanTag {
  id     String @id @default(cuid())
  planId String
  tagId  String

  plan   RentalPlan @relation(fields: [planId], references: [id], onDelete: Cascade)
  tag    Tag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())

  @@unique([planId, tagId])
  @@index([planId])
  @@index([tagId])
}

// ç®€åŒ–åçš„ RentalPlan
model RentalPlan {
  id            String @id @default(cuid())
  slug          String @unique
  name          String
  nameEn        String?
  description   String
  price         Int
  originalPrice Int?
  duration      Int
  includes      Json  // ç»“æ„åŒ–æœåŠ¡åˆ—è¡¨
  imageUrl      String?

  // å…³è”
  storeId       String
  store         Store @relation(fields: [storeId], references: [id])
  tags          PlanTag[]

  // å…ƒæ•°æ®
  isActive      Boolean @default(true)
  isFeatured    Boolean @default(false)
  priority      Int @default(0)

  // æ´»åŠ¨ç›¸å…³
  campaignId    String?
  campaign      Campaign? @relation(fields: [campaignId], references: [id])

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // å…³ç³»
  bookingItems  BookingItem[]
  cartItems     CartItem[]

  @@index([storeId])
  @@index([price])
  @@index([duration])
  @@index([campaignId])
}
```

**ç§å­æ•°æ®ç¤ºä¾‹**:

```typescript
// scripts/seed-tag-system.ts
const tagCategories = [
  {
    code: 'scene',
    name: 'ä½¿ç”¨åœºæ™¯',
    nameEn: 'Scene',
    isRequired: true,
    order: 1,
    tags: [
      { code: 'casual_walk', name: 'è¡—æ‹æ¼«æ­¥', nameEn: 'Casual Walk', icon: 'Camera', order: 1 },
      { code: 'temple_visit', name: 'å¯ºåº™å‚æ‹œ', nameEn: 'Temple Visit', icon: 'Church', order: 2 },
      { code: 'festival', name: 'ç¥­å…¸æ´»åŠ¨', nameEn: 'Festival', icon: 'PartyPopper', order: 3 },
      { code: 'photoshoot', name: 'ä¸“ä¸šå†™çœŸ', nameEn: 'Photoshoot', icon: 'CameraIcon', order: 4 },
      { code: 'date', name: 'æµªæ¼«çº¦ä¼š', nameEn: 'Date', icon: 'Heart', order: 5 },
      { code: 'wedding', name: 'å‚åŠ å©šç¤¼', nameEn: 'Wedding Guest', icon: 'Users', order: 6 },
      { code: 'family', name: 'å®¶åº­å‡ºæ¸¸', nameEn: 'Family Trip', icon: 'Home', order: 7 },
    ],
  },
  {
    code: 'style',
    name: 'é£æ ¼',
    nameEn: 'Style',
    order: 2,
    tags: [
      { code: 'traditional', name: 'ä¼ ç»Ÿå¤å…¸', nameEn: 'Traditional', icon: 'Landmark', order: 1 },
      { code: 'modern', name: 'æ—¶å°šç°ä»£', nameEn: 'Modern', icon: 'Sparkles', order: 2 },
      { code: 'elegant', name: 'ä¼˜é›…ç«¯åº„', nameEn: 'Elegant', icon: 'Crown', order: 3 },
      { code: 'cute', name: 'å¯çˆ±ç”œç¾', nameEn: 'Cute', icon: 'Smile', order: 4 },
      { code: 'luxurious', name: 'åä¸½å¥¢å', nameEn: 'Luxurious', icon: 'Gem', order: 5 },
      { code: 'simple', name: 'ç®€çº¦ç´ é›…', nameEn: 'Simple', icon: 'Minimize', order: 6 },
    ],
  },
  {
    code: 'price_range',
    name: 'ä»·æ ¼åŒºé—´',
    nameEn: 'Price Range',
    isRequired: true,
    order: 3,
    tags: [
      { code: 'budget', name: 'ç»æµå‹ Â¥200ä»¥ä¸‹', nameEn: 'Budget (Under Â¥200)', order: 1 },
      { code: 'standard', name: 'æ ‡å‡†å‹ Â¥200-400', nameEn: 'Standard (Â¥200-400)', order: 2 },
      { code: 'premium', name: 'é«˜çº§å‹ Â¥400-600', nameEn: 'Premium (Â¥400-600)', order: 3 },
      { code: 'luxury', name: 'è±ªåå‹ Â¥600+', nameEn: 'Luxury (Â¥600+)', order: 4 },
    ],
  },
  {
    code: 'service_level',
    name: 'æœåŠ¡ç­‰çº§',
    nameEn: 'Service Level',
    isRequired: true,
    order: 4,
    tags: [
      { code: 'basic', name: 'åŸºç¡€ç‰ˆï¼ˆå’Œæœ+é…ä»¶ï¼‰', nameEn: 'Basic', order: 1 },
      { code: 'standard', name: 'æ ‡å‡†ç‰ˆï¼ˆ+å‘å‹è®¾è®¡ï¼‰', nameEn: 'Standard', order: 2 },
      { code: 'premium', name: 'é«˜çº§ç‰ˆï¼ˆ+åŒ–å¦†ï¼‰', nameEn: 'Premium', order: 3 },
      { code: 'vip', name: 'VIPç‰ˆï¼ˆ+æ‘„å½±+ä¿®å›¾ï¼‰', nameEn: 'VIP', order: 4 },
    ],
  },
  {
    code: 'duration',
    name: 'ç§Ÿèµæ—¶é•¿',
    nameEn: 'Duration',
    order: 5,
    tags: [
      { code: 'short', name: '2-3å°æ—¶', nameEn: '2-3 hours', order: 1 },
      { code: 'half_day', name: '4-6å°æ—¶', nameEn: '4-6 hours', order: 2 },
      { code: 'full_day', name: '8å°æ—¶+', nameEn: '8+ hours', order: 3 },
      { code: 'overnight', name: 'è¿‡å¤œ', nameEn: 'Overnight', order: 4 },
    ],
  },
  {
    code: 'audience',
    name: 'é€‚åˆäººç¾¤',
    nameEn: 'Target Audience',
    order: 6,
    tags: [
      { code: 'young_woman', name: 'å¹´è½»å¥³æ€§(18-25)', nameEn: 'Young Woman', order: 1 },
      { code: 'mature_woman', name: 'æˆç†Ÿå¥³æ€§(26-40)', nameEn: 'Mature Woman', order: 2 },
      { code: 'young_man', name: 'å¹´è½»ç”·æ€§', nameEn: 'Young Man', order: 3 },
      { code: 'mature_man', name: 'æˆç†Ÿç”·æ€§', nameEn: 'Mature Man', order: 4 },
      { code: 'couple', name: 'æƒ…ä¾£', nameEn: 'Couple', order: 5 },
      { code: 'family', name: 'äº²å­å®¶åº­', nameEn: 'Family with Kids', order: 6 },
      { code: 'seniors', name: 'è€å¹´äºº', nameEn: 'Seniors', order: 7 },
      { code: 'plus_size', name: 'å¤§ç å‹å¥½', nameEn: 'Plus Size', order: 8 },
    ],
  },
  {
    code: 'convenience',
    name: 'ä¾¿åˆ©æ€§',
    nameEn: 'Convenience',
    order: 7,
    tags: [
      { code: 'near_station', name: 'åœ°é“ç«™é™„è¿‘', nameEn: 'Near Station', icon: 'Train', order: 1 },
      { code: 'free_parking', name: 'å…è´¹åœè½¦', nameEn: 'Free Parking', icon: 'ParkingCircle', order: 2 },
      { code: 'english_support', name: 'è‹±æ–‡æœåŠ¡', nameEn: 'English Support', icon: 'Languages', order: 3 },
      { code: 'chinese_support', name: 'ä¸­æ–‡æœåŠ¡', nameEn: 'Chinese Support', icon: 'Languages', order: 4 },
      { code: 'wheelchair_accessible', name: 'æ— éšœç¢é€šé“', nameEn: 'Wheelchair Accessible', icon: 'Accessibility', order: 5 },
      { code: 'luggage_storage', name: 'è¡Œæå¯„å­˜', nameEn: 'Luggage Storage', icon: 'Luggage', order: 6 },
      { code: 'last_minute', name: 'ä¸´æ—¶é¢„çº¦', nameEn: 'Last Minute Booking', icon: 'Clock', order: 7 },
      { code: 'private_room', name: 'ç‹¬ç«‹æ›´è¡£å®¤', nameEn: 'Private Changing Room', icon: 'Lock', order: 8 },
    ],
  },
];
```

**ä¼˜ç‚¹**:
1. âœ… **çµæ´»æ‰©å±•**: æ–°å¢ç­›é€‰ç»´åº¦åªéœ€æ·»åŠ  TagCategory å’Œ Tag,æ— éœ€ä¿®æ”¹ schema
2. âœ… **å¤šè¯­è¨€æ”¯æŒ**: å†…ç½® name/nameEn å­—æ®µ
3. âœ… **å‰ç«¯å‹å¥½**: å›¾æ ‡ã€æ’åºã€æè¿°ä¸€åº”ä¿±å…¨
4. âœ… **æ•°æ®ä¸€è‡´æ€§**: é¿å…æšä¸¾å€¼ç¡¬ç¼–ç 
5. âœ… **æ˜“äºç®¡ç†**: å¯é€šè¿‡ç®¡ç†ç•Œé¢åŠ¨æ€å¢åˆ æ ‡ç­¾

**ç¼ºç‚¹**:
- âŒ æŸ¥è¯¢å¤æ‚åº¦å¢åŠ (éœ€è¦å¤šè¡¨ JOIN)
- âŒ è¿ç§»å·¥ä½œé‡è¾ƒå¤§
- âŒ éœ€è¦ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½(ç¼“å­˜ã€ç´¢å¼•)

---

### æ–¹æ¡ˆC: æ··åˆæ–¹æ¡ˆ (å¹³è¡¡)

æ ¸å¿ƒç»´åº¦ç”¨æšä¸¾(é«˜é¢‘æŸ¥è¯¢),æ¬¡è¦ç»´åº¦ç”¨æ ‡ç­¾ç³»ç»Ÿ:

```prisma
model RentalPlan {
  // ... åŸºç¡€å­—æ®µ ...

  // æ ¸å¿ƒç»´åº¦(æšä¸¾,é«˜æ€§èƒ½æŸ¥è¯¢)
  primaryScene    ExperienceScene?  // ä¸»è¦åœºæ™¯
  serviceLevel    ServiceLevel      // æœåŠ¡ç­‰çº§
  priceRange      PriceRange        // ä»·æ ¼åŒºé—´(å†—ä½™,åŠ é€ŸæŸ¥è¯¢)

  // æ¬¡è¦ç»´åº¦(æ ‡ç­¾ç³»ç»Ÿ,çµæ´»æ‰©å±•)
  tags            PlanTag[]

  // ä¾¿åˆ©æ€§ç‰¹æ€§(JSON,ä½é¢‘æŸ¥è¯¢)
  features        Json?

  // å…³è”åº—é“º
  storeId         String
  store           Store @relation(fields: [storeId])

  @@index([primaryScene])
  @@index([serviceLevel])
  @@index([priceRange])
  @@index([storeId])
}

// æ ‡ç­¾ç³»ç»Ÿç”¨äºé£æ ¼ã€äººç¾¤ç­‰æ¬¡è¦ç»´åº¦
model TagCategory { ... }
model Tag { ... }
model PlanTag { ... }
```

**ä¼˜ç‚¹**:
- âœ… å¹³è¡¡æ€§èƒ½ä¸çµæ´»æ€§
- âœ… æ ¸å¿ƒç­›é€‰å¿«é€Ÿå“åº”
- âœ… æ¬¡è¦ç»´åº¦å¯åŠ¨æ€æ‰©å±•

**ç¼ºç‚¹**:
- âš ï¸ æ¶æ„å¤æ‚,éœ€è¦æ¸…æ™°åˆ’åˆ†æ ¸å¿ƒ/æ¬¡è¦ç»´åº¦
- âš ï¸ ç»´æŠ¤æˆæœ¬ä»‹äºæ–¹æ¡ˆAå’ŒBä¹‹é—´

---

### æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“

| ç»´åº¦ | æ–¹æ¡ˆA (æšä¸¾) | æ–¹æ¡ˆB (æ ‡ç­¾ç³»ç»Ÿ) | æ–¹æ¡ˆC (æ··åˆ) |
|------|-------------|-----------------|-------------|
| **å®æ–½éš¾åº¦** | â­â­ ç®€å• | â­â­â­â­ å¤æ‚ | â­â­â­ ä¸­ç­‰ |
| **æŸ¥è¯¢æ€§èƒ½** | â­â­â­â­â­ ä¼˜ç§€ | â­â­â­ ä¸€èˆ¬ | â­â­â­â­ è‰¯å¥½ |
| **æ‰©å±•æ€§** | â­â­ å—é™ | â­â­â­â­â­ ä¼˜ç§€ | â­â­â­â­ è‰¯å¥½ |
| **å¤šè¯­è¨€æ”¯æŒ** | â­â­ éœ€ç¡¬ç¼–ç  | â­â­â­â­â­ åŸç”Ÿæ”¯æŒ | â­â­â­â­ éƒ¨åˆ†æ”¯æŒ |
| **ç»´æŠ¤æˆæœ¬** | â­â­â­â­â­ ä½ | â­â­â­ ä¸­ç­‰ | â­â­â­â­ è¾ƒä½ |
| **è¿ç§»å·¥ä½œé‡** | â­â­â­â­â­ æœ€å° | â­â­ è¾ƒå¤§ | â­â­â­ ä¸­ç­‰ |
| **æ¨èåº¦** | MVPå¿«é€Ÿä¸Šçº¿ | é•¿æœŸå¯æ‰©å±• | å¹³è¡¡é€‰æ‹© |

---

## å‰ç«¯ç­›é€‰å™¨è®¾è®¡

### 1. é¦–é¡µå¿«é€Ÿå…¥å£

åœ¨é¦–é¡µæ·»åŠ åœºæ™¯å¼•å¯¼å¡ç‰‡:

```tsx
// src/app/(main)/page.tsx
<section className="container mx-auto py-12">
  <h2 className="text-3xl font-bold mb-8 text-center">
    æ‚¨æƒ³ä½“éªŒä»€ä¹ˆåœºæ™¯?
  </h2>

  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
    <SceneCard
      icon={<Camera />}
      title="è¡—æ‹æ¼«æ­¥"
      description="éšæ„æ‹ç…§,è½»æ¾ä½“éªŒ"
      image="/images/scenes/casual-walk.jpg"
      link="/plans?scene=casual_walk"
    />
    <SceneCard
      icon={<Church />}
      title="å¯ºåº™å‚æ‹œ"
      description="æ­£å¼ä¼ ç»Ÿ,åº„é‡å¾—ä½“"
      image="/images/scenes/temple-visit.jpg"
      link="/plans?scene=temple_visit"
    />
    <SceneCard
      icon={<Heart />}
      title="æµªæ¼«çº¦ä¼š"
      description="æƒ…ä¾£å¥—é¤,ç•™ä¸‹å›å¿†"
      image="/images/scenes/date.jpg"
      link="/plans?scene=date"
    />
    <SceneCard
      icon={<PartyPopper />}
      title="ç¥­å…¸æ´»åŠ¨"
      description="èŠ‚æ—¥ç‰¹è‰²,çƒ­é—¹æ°›å›´"
      image="/images/scenes/festival.jpg"
      link="/plans?scene=festival"
    />
    <SceneCard
      icon={<CameraIcon />}
      title="ä¸“ä¸šå†™çœŸ"
      description="æ‘„å½±å¸ˆè·Ÿæ‹,ç²¾ä¿®ç…§ç‰‡"
      image="/images/scenes/photoshoot.jpg"
      link="/plans?scene=photoshoot"
    />
    <SceneCard
      icon={<Users />}
      title="å®¶åº­å‡ºæ¸¸"
      description="äº²å­å¥—é¤,å…¨å®¶æ¬¢ä¹"
      image="/images/scenes/family.jpg"
      link="/plans?scene=family_trip"
    />
    <SceneCard
      icon={<Users />}
      title="å‚åŠ å©šç¤¼"
      description="æ­£å¼ç¤¼æœ,éš†é‡å‡ºå¸­"
      image="/images/scenes/wedding.jpg"
      link="/plans?scene=wedding_guest"
    />
    <SceneCard
      icon={<Package />}
      title="æµè§ˆå…¨éƒ¨"
      description="æŸ¥çœ‹æ‰€æœ‰å¥—é¤"
      image="/images/scenes/all.jpg"
      link="/plans"
    />
  </div>
</section>
```

---

### 2. Plans é¡µé¢ç­›é€‰å™¨é‡æ„

**å½“å‰**: ä¾§è¾¹æ  4 ä¸ªç»´åº¦(æ´»åŠ¨/åœ°åŒº/åº—é“º/æ ‡ç­¾)
**å»ºè®®**: ä¾§è¾¹æ  6-7 ä¸ªç»´åº¦,æŒ‰é‡è¦æ€§æ’åº

```tsx
// src/app/(main)/plans/PlansClient.tsx
<div className="flex flex-col lg:flex-row gap-8">
  {/* ç­›é€‰ä¾§è¾¹æ  */}
  <aside className="lg:w-64 flex-shrink-0">
    <div className="sticky top-24 space-y-6">
      {/* 1. ä½¿ç”¨åœºæ™¯(æœ€é‡è¦) */}
      <FilterGroup title="æ‚¨çš„è®¡åˆ’" icon={<MapPin />}>
        <TagFilter
          category="scene"
          multiSelect={true}
          showIcons={true}
        />
      </FilterGroup>

      {/* 2. ä»·æ ¼åŒºé—´ */}
      <FilterGroup title="é¢„ç®—" icon={<DollarSign />}>
        <PriceRangeFilter
          ranges={[
            { code: 'budget', label: 'Â¥200ä»¥ä¸‹', min: 0, max: 200 },
            { code: 'standard', label: 'Â¥200-400', min: 200, max: 400 },
            { code: 'premium', label: 'Â¥400-600', min: 400, max: 600 },
            { code: 'luxury', label: 'Â¥600+', min: 600, max: 999999 },
          ]}
        />
      </FilterGroup>

      {/* 3. ç§Ÿèµæ—¶é•¿ */}
      <FilterGroup title="ç§Ÿèµæ—¶é•¿" icon={<Clock />}>
        <DurationFilter
          options={[
            { code: 'short', label: '2-3å°æ—¶' },
            { code: 'half_day', label: '4-6å°æ—¶' },
            { code: 'full_day', label: '8å°æ—¶+' },
            { code: 'overnight', label: 'è¿‡å¤œ' },
          ]}
        />
      </FilterGroup>

      {/* 4. æœåŠ¡ç­‰çº§ */}
      <FilterGroup title="æœåŠ¡å†…å®¹" icon={<Star />}>
        <ServiceLevelFilter
          levels={[
            { code: 'basic', label: 'åŸºç¡€ç‰ˆ', description: 'å’Œæœ+é…ä»¶' },
            { code: 'standard', label: 'æ ‡å‡†ç‰ˆ', description: '+å‘å‹è®¾è®¡' },
            { code: 'premium', label: 'é«˜çº§ç‰ˆ', description: '+åŒ–å¦†' },
            { code: 'vip', label: 'VIPç‰ˆ', description: '+æ‘„å½±+ä¿®å›¾' },
          ]}
        />
      </FilterGroup>

      {/* 5. é£æ ¼(å¯é€‰,é»˜è®¤æŠ˜å ) */}
      <FilterGroup title="é£æ ¼åå¥½" icon={<Palette />} collapsible defaultOpen={false}>
        <TagFilter
          category="style"
          multiSelect={true}
        />
      </FilterGroup>

      {/* 6. åœ°åŒº */}
      <FilterGroup title="ä½ç½®" icon={<MapPin />} collapsible defaultOpen={false}>
        <RegionFilter />
      </FilterGroup>

      {/* 7. ä¾¿åˆ©æ€§(å¯é€‰,é»˜è®¤æŠ˜å ) */}
      <FilterGroup title="ç‰¹æ®Šéœ€æ±‚" icon={<Settings />} collapsible defaultOpen={false}>
        <ConvenienceFilter
          features={[
            { code: 'near_station', label: 'åœ°é“ç«™é™„è¿‘', icon: <Train /> },
            { code: 'english_support', label: 'è‹±æ–‡æœåŠ¡', icon: <Languages /> },
            { code: 'chinese_support', label: 'ä¸­æ–‡æœåŠ¡', icon: <Languages /> },
            { code: 'free_parking', label: 'å…è´¹åœè½¦', icon: <ParkingCircle /> },
            { code: 'luggage_storage', label: 'è¡Œæå¯„å­˜', icon: <Luggage /> },
            { code: 'last_minute', label: 'ä¸´æ—¶é¢„çº¦', icon: <Clock /> },
          ]}
        />
      </FilterGroup>

      {/* é‡ç½®æŒ‰é’® */}
      <Button variant="outline" onClick={clearFilters} className="w-full">
        <X className="w-4 h-4 mr-2" />
        æ¸…é™¤ç­›é€‰
      </Button>
    </div>
  </aside>

  {/* å¥—é¤åˆ—è¡¨ */}
  <main className="flex-1">
    {/* ç§»åŠ¨ç«¯ç­›é€‰å™¨æŒ‰é’® */}
    <div className="lg:hidden mb-4">
      <Button onClick={toggleFilters} variant="outline" className="w-full">
        <Filter className="w-4 h-4 mr-2" />
        ç­›é€‰ {activeFiltersCount > 0 && `(${activeFiltersCount})`}
      </Button>
    </div>

    {/* å½“å‰ç­›é€‰æ ‡ç­¾ */}
    <div className="flex flex-wrap gap-2 mb-6">
      {activeFilters.map(filter => (
        <Badge key={filter.id} variant="secondary" className="flex items-center gap-1">
          {filter.label}
          <X
            className="w-3 h-3 cursor-pointer"
            onClick={() => removeFilter(filter.id)}
          />
        </Badge>
      ))}
    </div>

    {/* æ’åº + ç»“æœæ•°é‡ */}
    <div className="flex justify-between items-center mb-6">
      <p className="text-sm text-gray-600">
        æ‰¾åˆ° <strong>{filteredPlans.length}</strong> ä¸ªå¥—é¤
      </p>

      <Select value={sortBy} onValueChange={setSortBy}>
        <SelectTrigger className="w-48">
          <SelectValue placeholder="æ’åºæ–¹å¼" />
        </SelectTrigger>
        <SelectContent>
          <SelectItem value="recommended">æ¨è</SelectItem>
          <SelectItem value="price_asc">ä»·æ ¼ä»ä½åˆ°é«˜</SelectItem>
          <SelectItem value="price_desc">ä»·æ ¼ä»é«˜åˆ°ä½</SelectItem>
          <SelectItem value="rating">è¯„åˆ†æœ€é«˜</SelectItem>
          <SelectItem value="popular">æœ€å—æ¬¢è¿</SelectItem>
        </SelectContent>
      </Select>
    </div>

    {/* å¥—é¤ç½‘æ ¼ */}
    <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
      {filteredPlans.map(plan => (
        <PlanCard key={plan.id} plan={plan} />
      ))}
    </div>

    {/* ç©ºçŠ¶æ€ */}
    {filteredPlans.length === 0 && (
      <div className="text-center py-12">
        <Package className="w-16 h-16 mx-auto text-gray-300 mb-4" />
        <h3 className="text-xl font-semibold mb-2">æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å¥—é¤</h3>
        <p className="text-gray-600 mb-4">
          å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æ¸…é™¤ç­›é€‰
        </p>
        <Button onClick={clearFilters}>æ¸…é™¤ç­›é€‰</Button>
      </div>
    )}
  </main>
</div>
```

---

### 3. å¥—é¤å¡ç‰‡ä¼˜åŒ–

åœ¨ PlanCard ä¸Šç›´è§‚æ˜¾ç¤ºå…³é”®å†³ç­–ä¿¡æ¯:

```tsx
// src/components/PlanCard.tsx
<Link href={`/plans/${plan.slug}`}>
  <div className="group block rounded-xl overflow-hidden bg-white shadow-sm hover:shadow-md transition-shadow">
    {/* 3:4 ç«–ç‰ˆå›¾ç‰‡ */}
    <div className="relative aspect-[3/4] overflow-hidden">
      <Image
        src={plan.imageUrl || '/images/placeholder.jpg'}
        alt={plan.name}
        fill
        className="object-cover group-hover:scale-105 transition-transform duration-300"
      />

      {/* å·¦ä¸Šè§’æ ‡ç­¾(æœ€å¤š2ä¸ª) */}
      <div className="absolute top-2 left-2 flex flex-col gap-1">
        {/* ä¼˜æƒ æ ‡ç­¾ */}
        {discountPercent > 0 && (
          <Badge variant="error" className="text-xs">
            -{discountPercent}%
          </Badge>
        )}

        {/* æ´»åŠ¨æ ‡ç­¾ */}
        {plan.isCampaign && (
          <Badge variant="warning" className="text-xs">
            é™æ—¶ä¼˜æƒ 
          </Badge>
        )}

        {/* ä¸»è¦åœºæ™¯æ ‡ç­¾(ä»æ ‡ç­¾ç³»ç»Ÿè·å–) */}
        {plan.tags?.find(t => t.tag.category.code === 'scene') && (
          <Badge variant="default" className="text-xs flex items-center gap-1">
            {getIcon(plan.tags[0].tag.icon)}
            {plan.tags[0].tag.name}
          </Badge>
        )}
      </div>

      {/* å³ä¸Šè§’æ”¶è—æŒ‰é’® */}
      <button
        className="absolute top-2 right-2 p-2 rounded-full bg-white/80 hover:bg-white transition-colors"
        onClick={(e) => {
          e.preventDefault();
          toggleFavorite(plan.id);
        }}
      >
        <Heart
          className={cn(
            "w-4 h-4",
            isFavorited ? "fill-red-500 text-red-500" : "text-gray-600"
          )}
        />
      </button>
    </div>

    {/* ä¿¡æ¯åŒºåŸŸ */}
    <div className="p-4">
      {/* å•†å®¶ä¿¡æ¯ï¼ˆå¹³å°æ¨¡å¼ï¼‰ */}
      <div className="flex items-center gap-1 text-xs text-gray-600 mb-1">
        <MapPin className="w-3 h-3" />
        <span>{plan.store?.name || plan.storeName}</span>
        <span>Â·</span>
        <span>{plan.region || plan.store?.region}</span>
      </div>

      {/* å¥—é¤åç§° */}
      <h3 className="font-semibold text-base mb-1 line-clamp-2 group-hover:text-primary transition-colors">
        {plan.name}
      </h3>

      {/* ç±»å‹ + æ—¶é•¿ */}
      <p className="text-xs text-gray-600 mb-2">
        {getCategoryLabel(plan.category)} Â· {plan.duration}å°æ—¶
      </p>

      {/* æœåŠ¡äº®ç‚¹(å›¾æ ‡) */}
      <div className="flex gap-2 mb-3">
        {/* æ ¹æ® includes æˆ– serviceLevel æ˜¾ç¤ºå›¾æ ‡ */}
        {plan.includes?.includes('å‘å‹è®¾è®¡') && (
          <Tooltip content="å«å‘å‹è®¾è®¡">
            <div className="p-1.5 rounded-md bg-gray-100">
              <Scissors className="w-3 h-3 text-gray-600" />
            </div>
          </Tooltip>
        )}
        {plan.includes?.includes('åŒ–å¦†') && (
          <Tooltip content="å«ä¸“ä¸šåŒ–å¦†">
            <div className="p-1.5 rounded-md bg-gray-100">
              <Sparkles className="w-3 h-3 text-gray-600" />
            </div>
          </Tooltip>
        )}
        {plan.includes?.includes('æ‘„å½±') && (
          <Tooltip content="å«æ‘„å½±æœåŠ¡">
            <div className="p-1.5 rounded-md bg-gray-100">
              <Camera className="w-3 h-3 text-gray-600" />
            </div>
          </Tooltip>
        )}
        {/* ä¸­æ–‡æœåŠ¡æ ‡ç­¾ */}
        {plan.tags?.find(t => t.tag.code === 'chinese_support') && (
          <Tooltip content="æä¾›ä¸­æ–‡æœåŠ¡">
            <div className="p-1.5 rounded-md bg-gray-100">
              <Languages className="w-3 h-3 text-gray-600" />
            </div>
          </Tooltip>
        )}
      </div>

      {/* ä»·æ ¼ */}
      <div className="flex items-baseline gap-2">
        <span className="text-2xl font-bold">
          Â¥{(plan.price / 100).toLocaleString()}
        </span>
        {plan.originalPrice && plan.originalPrice > plan.price && (
          <span className="text-sm text-gray-500 line-through">
            Â¥{(plan.originalPrice / 100).toLocaleString()}
          </span>
        )}
        <span className="text-sm text-gray-600">/ äºº</span>
      </div>

      {/* è¯„åˆ†ï¼ˆå¹³å°æ¨¡å¼,æš‚ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼‰ */}
      <div className="flex items-center gap-1 mt-2">
        <Star className="w-4 h-4 fill-yellow-400 text-yellow-400" />
        <span className="text-sm font-medium">4.8</span>
        <span className="text-xs text-gray-600">(128æ¡è¯„ä»·)</span>
      </div>
    </div>
  </div>
</Link>
```

---

### 4. æ™ºèƒ½æ¨èç®—æ³•

æ ¹æ®æ¸¸å®¢çš„é€‰æ‹©æ¨èç›¸å…³å¥—é¤:

```typescript
// src/lib/recommendation.ts

interface FilterCriteria {
  scenes?: string[];
  priceRange?: string;
  serviceLevel?: string;
  duration?: string;
  styles?: string[];
}

interface Plan {
  id: string;
  price: number;
  tags: { tag: { code: string; category: { code: string } } }[];
  // ... å…¶ä»–å­—æ®µ
}

/**
 * æ¨èç®—æ³• - åŸºäºåŠ æƒè¯„åˆ†
 */
export function getRecommendedPlans(
  plans: Plan[],
  filters: FilterCriteria,
  limit: number = 10
): Plan[] {
  // è¯„åˆ†æƒé‡é…ç½®
  const weights = {
    scene_match: 10,      // åœºæ™¯åŒ¹é…æœ€é‡è¦
    price_range: 5,       // ä»·æ ¼åŒºé—´æ¬¡ä¹‹
    service_level: 3,     // æœåŠ¡ç­‰çº§
    duration: 3,          // æ—¶é•¿
    style_match: 2,       // é£æ ¼åå¥½
  };

  // åœºæ™¯ â†’ æ¨èé£æ ¼æ˜ å°„
  const sceneToStyleMap: Record<string, string[]> = {
    casual_walk: ['modern', 'cute', 'simple'],
    temple_visit: ['traditional', 'elegant'],
    festival: ['luxurious', 'traditional'],
    photoshoot: ['elegant', 'luxurious'],
    date: ['elegant', 'cute', 'modern'],
    wedding_guest: ['elegant', 'luxurious'],
    family_trip: ['simple', 'modern'],
  };

  // ä¸ºæ¯ä¸ªå¥—é¤è®¡ç®—å¾—åˆ†
  const scoredPlans = plans.map(plan => {
    let score = 0;

    // 1. åœºæ™¯åŒ¹é…
    if (filters.scenes?.length) {
      const planScenes = plan.tags
        .filter(t => t.tag.category.code === 'scene')
        .map(t => t.tag.code);

      const matchCount = filters.scenes.filter(s => planScenes.includes(s)).length;
      score += matchCount * weights.scene_match;
    }

    // 2. ä»·æ ¼åŒºé—´åŒ¹é…
    if (filters.priceRange) {
      const planPriceRange = plan.tags.find(
        t => t.tag.category.code === 'price_range'
      )?.tag.code;

      if (planPriceRange === filters.priceRange) {
        score += weights.price_range;
      }
    }

    // 3. æœåŠ¡ç­‰çº§åŒ¹é…
    if (filters.serviceLevel) {
      const planServiceLevel = plan.tags.find(
        t => t.tag.category.code === 'service_level'
      )?.tag.code;

      if (planServiceLevel === filters.serviceLevel) {
        score += weights.service_level;
      }
    }

    // 4. æ—¶é•¿åŒ¹é…
    if (filters.duration) {
      const planDuration = plan.tags.find(
        t => t.tag.category.code === 'duration'
      )?.tag.code;

      if (planDuration === filters.duration) {
        score += weights.duration;
      }
    }

    // 5. é£æ ¼åŒ¹é…(åŸºäºåœºæ™¯æ¨è)
    if (filters.scenes?.length) {
      const recommendedStyles = filters.scenes.flatMap(
        scene => sceneToStyleMap[scene] || []
      );

      const planStyles = plan.tags
        .filter(t => t.tag.category.code === 'style')
        .map(t => t.tag.code);

      const styleMatchCount = recommendedStyles.filter(s =>
        planStyles.includes(s)
      ).length;

      score += styleMatchCount * weights.style_match;
    }

    return { plan, score };
  });

  // æŒ‰å¾—åˆ†æ’åºå¹¶è¿”å›å‰Nä¸ª
  return scoredPlans
    .sort((a, b) => b.score - a.score)
    .slice(0, limit)
    .map(item => item.plan);
}

/**
 * "æ‚¨å¯èƒ½ä¹Ÿå–œæ¬¢"æ¨è
 */
export function getSimilarPlans(
  currentPlan: Plan,
  allPlans: Plan[],
  limit: number = 4
): Plan[] {
  // æå–å½“å‰å¥—é¤çš„æ ‡ç­¾
  const currentTags = currentPlan.tags.map(t => ({
    category: t.tag.category.code,
    code: t.tag.code,
  }));

  // è®¡ç®—å…¶ä»–å¥—é¤çš„ç›¸ä¼¼åº¦
  const similarities = allPlans
    .filter(p => p.id !== currentPlan.id)
    .map(plan => {
      let similarity = 0;

      plan.tags.forEach(tag => {
        if (currentTags.some(
          ct => ct.category === tag.tag.category.code && ct.code === tag.tag.code
        )) {
          // åœºæ™¯å’ŒæœåŠ¡ç­‰çº§æƒé‡æ›´é«˜
          const weight = ['scene', 'service_level'].includes(tag.tag.category.code) ? 2 : 1;
          similarity += weight;
        }
      });

      return { plan, similarity };
    });

  // è¿”å›æœ€ç›¸ä¼¼çš„Nä¸ª
  return similarities
    .sort((a, b) => b.similarity - a.similarity)
    .slice(0, limit)
    .map(item => item.plan);
}
```

---

## æ•°æ®è¿ç§»ç­–ç•¥

### 1. åˆ†æç°æœ‰æ•°æ®

é¦–å…ˆåˆ†æ 967 ä¸ªç°æœ‰å¥—é¤çš„æ•°æ®ç‰¹å¾:

```typescript
// scripts/analyze-existing-plans.ts
import plansData from '../data/real-plans-data.json';
import campaignPlans from '../data/real-campaigns-data.json';
import fs from 'fs';

interface AnalysisResult {
  priceDistribution: Record<string, number>;
  durationDistribution: Record<string, number>;
  commonKeywords: Record<string, number>;
  includesPatterns: Record<string, number>;
  regionDistribution: Record<string, number>;
  tagsDistribution: Record<string, number>;
}

async function analyzePlans() {
  const allPlans = [...plansData, ...campaignPlans];

  const analysis: AnalysisResult = {
    priceDistribution: {},
    durationDistribution: {},
    commonKeywords: {},
    includesPatterns: {},
    regionDistribution: {},
    tagsDistribution: {},
  };

  allPlans.forEach(plan => {
    // 1. ä»·æ ¼åˆ†å¸ƒ
    const priceInYuan = Math.round(plan.price * 0.05); // JPY to CNY
    const priceRange =
      priceInYuan < 200 ? 'budget' :
      priceInYuan < 400 ? 'standard' :
      priceInYuan < 600 ? 'premium' : 'luxury';
    analysis.priceDistribution[priceRange] = (analysis.priceDistribution[priceRange] || 0) + 1;

    // 2. æ—¶é•¿åˆ†å¸ƒ
    const duration = plan.duration || 0;
    const durationRange =
      duration <= 3 ? 'short' :
      duration <= 6 ? 'half_day' :
      duration <= 8 ? 'full_day' : 'overnight';
    analysis.durationDistribution[durationRange] = (analysis.durationDistribution[durationRange] || 0) + 1;

    // 3. å…³é”®è¯é¢‘ç‡
    const text = `${plan.name} ${plan.description || ''} ${plan.tags?.join(' ') || ''}`.toLowerCase();
    const keywords = ['è¡—æ‹', 'å¯ºåº™', 'å‚æ‹œ', 'ç¥­å…¸', 'å†™çœŸ', 'æ‘„å½±', 'æƒ…ä¾£', 'äº²å­', 'ä¼ ç»Ÿ', 'ç°ä»£', 'ä¼˜é›…', 'å¯çˆ±'];
    keywords.forEach(keyword => {
      if (text.includes(keyword)) {
        analysis.commonKeywords[keyword] = (analysis.commonKeywords[keyword] || 0) + 1;
      }
    });

    // 4. åŒ…å«æœåŠ¡æ¨¡å¼
    const includes = plan.includes || [];
    includes.forEach(item => {
      analysis.includesPatterns[item] = (analysis.includesPatterns[item] || 0) + 1;
    });

    // 5. åœ°åŒºåˆ†å¸ƒ
    if (plan.region) {
      analysis.regionDistribution[plan.region] = (analysis.regionDistribution[plan.region] || 0) + 1;
    }

    // 6. æ ‡ç­¾åˆ†å¸ƒ
    if (plan.tags) {
      plan.tags.forEach(tag => {
        analysis.tagsDistribution[tag] = (analysis.tagsDistribution[tag] || 0) + 1;
      });
    }
  });

  // ä¿å­˜åˆ†æç»“æœ
  fs.writeFileSync(
    'data/analysis-result.json',
    JSON.stringify(analysis, null, 2)
  );

  console.log('åˆ†æå®Œæˆ! ç»“æœå·²ä¿å­˜åˆ° data/analysis-result.json');
  console.log('\n--- æ‘˜è¦ ---');
  console.log('æ€»å¥—é¤æ•°:', allPlans.length);
  console.log('ä»·æ ¼åˆ†å¸ƒ:', analysis.priceDistribution);
  console.log('æ—¶é•¿åˆ†å¸ƒ:', analysis.durationDistribution);
  console.log('Top 10 å…³é”®è¯:', Object.entries(analysis.commonKeywords)
    .sort((a, b) => b[1] - a[1])
    .slice(0, 10)
  );
}

analyzePlans();
```

**æ‰§è¡Œå‘½ä»¤**:
```bash
pnpm tsx scripts/analyze-existing-plans.ts
```

---

### 2. æ™ºèƒ½æ ‡ç­¾æ¨æ–­

ä½¿ç”¨è§„åˆ™ä¸ºç°æœ‰å¥—é¤è‡ªåŠ¨æ‰“æ ‡ç­¾:

```typescript
// scripts/auto-tag-plans.ts
import prisma from '../src/lib/prisma';

interface TagAssignment {
  categoryCode: string;
  tagCode: string;
  confidence: number; // 0-1,ç½®ä¿¡åº¦
}

/**
 * ä¸ºå¥—é¤æ¨æ–­æ ‡ç­¾
 */
function inferTags(plan: {
  name: string;
  description: string;
  price: number;
  duration: number;
  includes: string[];
  tags?: string[];
}): TagAssignment[] {
  const assignments: TagAssignment[] = [];
  const text = `${plan.name} ${plan.description} ${plan.includes.join(' ')} ${plan.tags?.join(' ') || ''}`.toLowerCase();

  // 1. åœºæ™¯æ¨æ–­
  const sceneRules: Array<{ keywords: string[]; code: string; confidence: number }> = [
    { keywords: ['è¡—æ‹', 'æ‹ç…§', 'æ¼«æ­¥', 'æ•£æ­¥'], code: 'casual_walk', confidence: 0.9 },
    { keywords: ['å¯ºåº™', 'å‚æ‹œ', 'ç¥ç¤¾', 'æ¸…æ°´å¯º', 'æµ…è‰å¯º'], code: 'temple_visit', confidence: 0.95 },
    { keywords: ['ç¥­å…¸', 'ç¥­ã‚Š', 'èŠ‚æ—¥', 'èŠ±ç«'], code: 'festival', confidence: 0.95 },
    { keywords: ['å†™çœŸ', 'ä¸“ä¸šæ‘„å½±', 'æ‘„å½±å¸ˆ', 'è·Ÿæ‹'], code: 'photoshoot', confidence: 0.9 },
    { keywords: ['çº¦ä¼š', 'æƒ…ä¾£', 'couple', 'ãƒ‡ãƒ¼ãƒˆ'], code: 'date', confidence: 0.85 },
    { keywords: ['å©šç¤¼', 'ç»“å©šå¼', 'wedding'], code: 'wedding_guest', confidence: 0.95 },
    { keywords: ['äº²å­', 'å®¶åº­', 'family', 'å­©å­'], code: 'family_trip', confidence: 0.9 },
  ];

  sceneRules.forEach(rule => {
    if (rule.keywords.some(kw => text.includes(kw))) {
      assignments.push({
        categoryCode: 'scene',
        tagCode: rule.code,
        confidence: rule.confidence,
      });
    }
  });

  // 2. é£æ ¼æ¨æ–­
  const styleRules = [
    { keywords: ['ä¼ ç»Ÿ', 'å¤å…¸', 'æ­£ç»Ÿ', 'traditional'], code: 'traditional', confidence: 0.8 },
    { keywords: ['æ—¶å°š', 'ç°ä»£', 'modern', 'ãƒ¢ãƒ€ãƒ³'], code: 'modern', confidence: 0.8 },
    { keywords: ['ä¼˜é›…', 'ç«¯åº„', 'elegant'], code: 'elegant', confidence: 0.75 },
    { keywords: ['å¯çˆ±', 'ç”œç¾', 'cute', 'ã‹ã‚ã„ã„'], code: 'cute', confidence: 0.8 },
    { keywords: ['åä¸½', 'å¥¢å', 'è±ªå', 'luxury'], code: 'luxurious', confidence: 0.85 },
    { keywords: ['ç®€çº¦', 'ç´ é›…', 'simple'], code: 'simple', confidence: 0.75 },
  ];

  styleRules.forEach(rule => {
    if (rule.keywords.some(kw => text.includes(kw))) {
      assignments.push({
        categoryCode: 'style',
        tagCode: rule.code,
        confidence: rule.confidence,
      });
    }
  });

  // 3. ä»·æ ¼åŒºé—´(100%å‡†ç¡®)
  const priceInYuan = plan.price / 100;
  const priceRange =
    priceInYuan < 200 ? 'budget' :
    priceInYuan < 400 ? 'standard' :
    priceInYuan < 600 ? 'premium' : 'luxury';
  assignments.push({
    categoryCode: 'price_range',
    tagCode: priceRange,
    confidence: 1.0,
  });

  // 4. æœåŠ¡ç­‰çº§(åŸºäº includes)
  const includesText = plan.includes.join(' ').toLowerCase();
  let serviceLevel = 'basic';
  let serviceLevelConfidence = 0.9;

  if (includesText.includes('æ‘„å½±') && (includesText.includes('åŒ–å¦†') || includesText.includes('ãƒ¡ã‚¤ã‚¯'))) {
    serviceLevel = 'vip';
  } else if (includesText.includes('åŒ–å¦†') || includesText.includes('ãƒ¡ã‚¤ã‚¯')) {
    serviceLevel = 'premium';
  } else if (includesText.includes('å‘å‹') || includesText.includes('ãƒ˜ã‚¢ã‚»ãƒƒãƒˆ')) {
    serviceLevel = 'standard';
  }

  assignments.push({
    categoryCode: 'service_level',
    tagCode: serviceLevel,
    confidence: serviceLevelConfidence,
  });

  // 5. æ—¶é•¿
  const durationRange =
    plan.duration <= 3 ? 'short' :
    plan.duration <= 6 ? 'half_day' :
    plan.duration <= 8 ? 'full_day' : 'overnight';
  assignments.push({
    categoryCode: 'duration',
    tagCode: durationRange,
    confidence: 1.0,
  });

  // 6. é€‚åˆäººç¾¤
  if (text.includes('æƒ…ä¾£') || text.includes('couple')) {
    assignments.push({ categoryCode: 'audience', tagCode: 'couple', confidence: 0.9 });
  }
  if (text.includes('äº²å­') || text.includes('family')) {
    assignments.push({ categoryCode: 'audience', tagCode: 'family', confidence: 0.9 });
  }
  if (text.includes('ç”·å£«') || text.includes('ãƒ¡ãƒ³ã‚º')) {
    assignments.push({ categoryCode: 'audience', tagCode: 'young_man', confidence: 0.7 });
  }
  if (text.includes('å¥³æ€§') || text.includes('ãƒ¬ãƒ‡ã‚£ãƒ¼ã‚¹')) {
    assignments.push({ categoryCode: 'audience', tagCode: 'young_woman', confidence: 0.7 });
  }

  // 7. ä¾¿åˆ©æ€§ç‰¹æ€§
  if (text.includes('ä¸­æ–‡') || text.includes('ä¸­å›½èª')) {
    assignments.push({ categoryCode: 'convenience', tagCode: 'chinese_support', confidence: 0.95 });
  }
  if (text.includes('è‹±è¯­') || text.includes('english')) {
    assignments.push({ categoryCode: 'convenience', tagCode: 'english_support', confidence: 0.95 });
  }
  if (text.includes('åœ°é“') || text.includes('é§…è¿‘')) {
    assignments.push({ categoryCode: 'convenience', tagCode: 'near_station', confidence: 0.8 });
  }
  if (text.includes('åœè½¦') || text.includes('é§è»Š')) {
    assignments.push({ categoryCode: 'convenience', tagCode: 'free_parking', confidence: 0.8 });
  }
  if (text.includes('è¡Œæ') || text.includes('è·ç‰©')) {
    assignments.push({ categoryCode: 'convenience', tagCode: 'luggage_storage', confidence: 0.85 });
  }

  return assignments;
}

/**
 * æ‰¹é‡ä¸ºå¥—é¤æ‰“æ ‡ç­¾
 */
async function autoTagAllPlans() {
  console.log('å¼€å§‹è‡ªåŠ¨æ ‡æ³¨...');

  // 1. è·å–æ‰€æœ‰æ ‡ç­¾æ˜ å°„
  const tagCategories = await prisma.tagCategory.findMany({
    include: { tags: true },
  });

  const tagMap = new Map<string, string>(); // key: "categoryCode:tagCode", value: tagId
  tagCategories.forEach(category => {
    category.tags.forEach(tag => {
      tagMap.set(`${category.code}:${tag.code}`, tag.id);
    });
  });

  // 2. è·å–æ‰€æœ‰å¥—é¤
  const plans = await prisma.rentalPlan.findMany({
    select: {
      id: true,
      name: true,
      description: true,
      price: true,
      duration: true,
      includes: true,
      tags: true, // ç°æœ‰çš„å­—ç¬¦ä¸²æ•°ç»„æ ‡ç­¾
    },
  });

  console.log(`æ‰¾åˆ° ${plans.length} ä¸ªå¥—é¤`);

  // 3. ä¸ºæ¯ä¸ªå¥—é¤æ¨æ–­æ ‡ç­¾
  let successCount = 0;
  let errorCount = 0;

  for (const plan of plans) {
    try {
      const assignments = inferTags({
        name: plan.name,
        description: plan.description,
        price: plan.price,
        duration: plan.duration,
        includes: plan.includes as string[],
        tags: plan.tags as string[],
      });

      // 4. åªä¿ç•™ç½®ä¿¡åº¦ >= 0.7 çš„æ ‡ç­¾
      const highConfidenceAssignments = assignments.filter(a => a.confidence >= 0.7);

      // 5. åˆ›å»º PlanTag å…³è”
      const planTagData = highConfidenceAssignments
        .map(a => {
          const tagId = tagMap.get(`${a.categoryCode}:${a.tagCode}`);
          if (!tagId) {
            console.warn(`æ ‡ç­¾æœªæ‰¾åˆ°: ${a.categoryCode}:${a.tagCode}`);
            return null;
          }
          return {
            planId: plan.id,
            tagId,
          };
        })
        .filter(Boolean) as { planId: string; tagId: string }[];

      // 6. æ‰¹é‡åˆ›å»º(ä½¿ç”¨ createMany è·³è¿‡é‡å¤)
      if (planTagData.length > 0) {
        await prisma.planTag.createMany({
          data: planTagData,
          skipDuplicates: true,
        });
      }

      successCount++;
      if (successCount % 50 === 0) {
        console.log(`å·²å¤„ç† ${successCount}/${plans.length}...`);
      }
    } catch (error) {
      console.error(`å¤„ç†å¥—é¤ ${plan.id} æ—¶å‡ºé”™:`, error);
      errorCount++;
    }
  }

  console.log('\nè‡ªåŠ¨æ ‡æ³¨å®Œæˆ!');
  console.log(`æˆåŠŸ: ${successCount}, å¤±è´¥: ${errorCount}`);
}

// æ‰§è¡Œ
autoTagAllPlans()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
```

**æ‰§è¡Œå‘½ä»¤**:
```bash
# å…ˆç¡®ä¿æ ‡ç­¾ç³»ç»Ÿå·²ç§å­
pnpm tsx scripts/seed-tag-system.ts

# ç„¶åæ‰§è¡Œè‡ªåŠ¨æ ‡æ³¨
pnpm tsx scripts/auto-tag-plans.ts
```

---

### 3. äººå·¥å®¡æ ¸ç•Œé¢

æ„å»ºç®¡ç†ç•Œé¢è®©å›¢é˜Ÿæˆå‘˜æ‰¹é‡å®¡æ ¸å’Œè°ƒæ•´æ ‡ç­¾:

```tsx
// src/app/admin/tag-review/page.tsx
'use client';

import { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import { Badge } from '@/components/ui/badge';
import { Textarea } from '@/components/ui/textarea';
import Image from 'next/image';

export default function TagReviewPage() {
  const [plans, setPlans] = useState([]);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [selectedTags, setSelectedTags] = useState<Record<string, string[]>>({});
  const [tagCategories, setTagCategories] = useState([]);
  const [loading, setLoading] = useState(true);

  const currentPlan = plans[currentIndex];

  useEffect(() => {
    loadData();
  }, []);

  async function loadData() {
    // åŠ è½½æœªå®¡æ ¸æˆ–éœ€è¦å®¡æ ¸çš„å¥—é¤
    const response = await fetch('/api/admin/plans?needsReview=true');
    const data = await response.json();
    setPlans(data.plans);
    setTagCategories(data.tagCategories);
    setLoading(false);
  }

  async function saveAndNext() {
    // ä¿å­˜å½“å‰å¥—é¤çš„æ ‡ç­¾
    await fetch(`/api/admin/plans/${currentPlan.id}/tags`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ tags: selectedTags }),
    });

    // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª
    setCurrentIndex(prev => prev + 1);
    setSelectedTags({});
  }

  async function autoTag() {
    // è°ƒç”¨ AI è‡ªåŠ¨æ ‡æ³¨
    const response = await fetch(`/api/admin/plans/${currentPlan.id}/auto-tag`, {
      method: 'POST',
    });
    const data = await response.json();
    setSelectedTags(data.suggestedTags);
  }

  function skip() {
    setCurrentIndex(prev => prev + 1);
    setSelectedTags({});
  }

  if (loading) return <div>åŠ è½½ä¸­...</div>;
  if (!currentPlan) return <div>æ‰€æœ‰å¥—é¤å·²å®¡æ ¸å®Œæˆ!</div>;

  return (
    <div className="container mx-auto py-8">
      <div className="mb-4">
        <h1 className="text-2xl font-bold">æ ‡ç­¾å®¡æ ¸</h1>
        <p className="text-gray-600">
          è¿›åº¦: {currentIndex + 1} / {plans.length}
        </p>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
        {/* å·¦ä¾§: å¥—é¤é¢„è§ˆ */}
        <div className="space-y-4">
          <div className="relative aspect-[3/4] rounded-lg overflow-hidden">
            <Image
              src={currentPlan.imageUrl || '/placeholder.jpg'}
              alt={currentPlan.name}
              fill
              className="object-cover"
            />
          </div>

          <div>
            <h2 className="text-xl font-semibold mb-2">{currentPlan.name}</h2>
            <p className="text-gray-600 mb-4">{currentPlan.description}</p>

            <div className="space-y-2">
              <div>
                <strong>ä»·æ ¼:</strong> Â¥{currentPlan.price / 100}
                {currentPlan.originalPrice && (
                  <span className="ml-2 line-through text-gray-500">
                    Â¥{currentPlan.originalPrice / 100}
                  </span>
                )}
              </div>
              <div><strong>æ—¶é•¿:</strong> {currentPlan.duration}å°æ—¶</div>
              <div><strong>åœ°åŒº:</strong> {currentPlan.region}</div>
              <div><strong>åº—é“º:</strong> {currentPlan.storeName}</div>
              <div>
                <strong>åŒ…å«æœåŠ¡:</strong>
                <ul className="list-disc list-inside">
                  {currentPlan.includes?.map((item, i) => (
                    <li key={i}>{item}</li>
                  ))}
                </ul>
              </div>
            </div>
          </div>
        </div>

        {/* å³ä¾§: æ ‡ç­¾ç¼–è¾‘å™¨ */}
        <div className="space-y-6">
          {tagCategories.map(category => (
            <div key={category.id} className="border rounded-lg p-4">
              <h3 className="font-semibold mb-3 flex items-center gap-2">
                {category.name}
                {category.isRequired && (
                  <Badge variant="error" className="text-xs">å¿…é€‰</Badge>
                )}
              </h3>

              <div className="grid grid-cols-2 gap-2">
                {category.tags.map(tag => (
                  <label
                    key={tag.id}
                    className="flex items-center gap-2 p-2 rounded hover:bg-gray-50 cursor-pointer"
                  >
                    <Checkbox
                      checked={selectedTags[category.code]?.includes(tag.code)}
                      onCheckedChange={(checked) => {
                        setSelectedTags(prev => {
                          const categoryTags = prev[category.code] || [];
                          return {
                            ...prev,
                            [category.code]: checked
                              ? [...categoryTags, tag.code]
                              : categoryTags.filter(c => c !== tag.code),
                          };
                        });
                      }}
                    />
                    <span className="text-sm">{tag.name}</span>
                  </label>
                ))}
              </div>
            </div>
          ))}

          {/* å¤‡æ³¨ */}
          <div>
            <label className="block font-semibold mb-2">å®¡æ ¸å¤‡æ³¨</label>
            <Textarea placeholder="å¦‚æœ‰éœ€è¦,è¯·æ·»åŠ å¤‡æ³¨..." rows={3} />
          </div>

          {/* æ“ä½œæŒ‰é’® */}
          <div className="flex gap-3">
            <Button onClick={saveAndNext} className="flex-1">
              ä¿å­˜å¹¶ä¸‹ä¸€ä¸ª
            </Button>
            <Button onClick={autoTag} variant="outline">
              AI è‡ªåŠ¨æ ‡æ³¨
            </Button>
            <Button onClick={skip} variant="ghost">
              è·³è¿‡
            </Button>
          </div>
        </div>
      </div>
    </div>
  );
}
```

---

### 4. è¿ç§»å·¥ä½œæµç¨‹

**æ¨èæµç¨‹**:

```mermaid
graph TD
    A[åˆ†æç°æœ‰æ•°æ®] --> B[åˆ›å»ºæ ‡ç­¾ç³»ç»Ÿè¡¨]
    B --> C[ç§å­æ ‡ç­¾æ•°æ®]
    C --> D[è¿è¡Œæ™ºèƒ½æ ‡æ³¨è„šæœ¬]
    D --> E[äººå·¥å®¡æ ¸é«˜ä¼˜å…ˆçº§å¥—é¤100ä¸ª]
    E --> F[è°ƒæ•´è§„åˆ™]
    F --> G{å‡†ç¡®ç‡ > 90%?}
    G -->|å¦| D
    G -->|æ˜¯| H[æ‰¹é‡æ ‡æ³¨æ‰€æœ‰å¥—é¤]
    H --> I[å‰ç«¯å®ç°æ–°ç­›é€‰å™¨]
    I --> J[A/B æµ‹è¯•]
    J --> K[å…¨é‡ä¸Šçº¿]
```

**æ—¶é—´ä¼°ç®—**:
- åˆ†ææ•°æ®: 0.5å¤©
- åˆ›å»ºæ ‡ç­¾ç³»ç»Ÿ: 1å¤©
- æ™ºèƒ½æ ‡æ³¨è„šæœ¬: 1.5å¤©
- äººå·¥å®¡æ ¸(100ä¸ª): 2å¤©
- æ‰¹é‡æ ‡æ³¨: 0.5å¤©
- å‰ç«¯å®ç°: 3å¤©
- æµ‹è¯•ä¼˜åŒ–: 2å¤©

**æ€»è®¡**: çº¦10-12ä¸ªå·¥ä½œæ—¥

---

## å®æ–½è·¯çº¿å›¾

### Phase 1: æ•°æ®åˆ†æä¸è®¾è®¡ (1å‘¨)

**ä»»åŠ¡**:
- [ ] è¿è¡Œæ•°æ®åˆ†æè„šæœ¬,ç”ŸæˆæŠ¥å‘Š
- [ ] ç¡®å®šæœ€ç»ˆæ ‡ç­¾åˆ†ç±»ä½“ç³»(åŸºäºåˆ†æç»“æœ)
- [ ] è®¾è®¡æœ€ç»ˆ Prisma schema
- [ ] åŸå‹æµ‹è¯•ç­›é€‰å™¨ UI (Figma/æ‰‹ç»˜)
- [ ] è¯„å®¡å¹¶ç¡®è®¤æ–¹æ¡ˆ(æ–¹æ¡ˆA/B/C)

**äº§å‡º**:
- `data/analysis-result.json` - æ•°æ®åˆ†ææŠ¥å‘Š
- `docs/final-tag-system.md` - æœ€ç»ˆæ ‡ç­¾ä½“ç³»
- `prisma/schema-v2.prisma` - æ–°ç‰ˆ schema
- ç­›é€‰å™¨ UI åŸå‹

---

### Phase 2: æ•°æ®åº“è¿ç§» (1å‘¨)

**ä»»åŠ¡**:
- [ ] åˆ›å»ºæ ‡ç­¾ç³»ç»Ÿè¡¨ (TagCategory, Tag, PlanTag)
- [ ] è¿è¡Œç§å­è„šæœ¬,å¯¼å…¥æ ‡ç­¾æ•°æ®
- [ ] ç¼–å†™æ™ºèƒ½æ ‡ç­¾æ¨æ–­è„šæœ¬
- [ ] æµ‹è¯•æ ‡æ³¨å‡†ç¡®ç‡(æŠ½æ ·50ä¸ª)
- [ ] è°ƒæ•´è§„åˆ™,é‡æ–°æ ‡æ³¨
- [ ] æ‰¹é‡ä¸ºæ‰€æœ‰967ä¸ªå¥—é¤æ‰“æ ‡ç­¾
- [ ] äººå·¥å®¡æ ¸å‰100ä¸ªé«˜ä¼˜å…ˆçº§å¥—é¤

**äº§å‡º**:
- æ–°çš„æ•°æ®åº“è¡¨å’Œå…³ç³»
- æ‰€æœ‰å¥—é¤å®Œæˆåˆæ­¥æ ‡æ³¨
- é«˜ä¼˜å…ˆçº§å¥—é¤äººå·¥å®¡æ ¸å®Œæˆ

**æ‰§è¡Œå‘½ä»¤**:
```bash
# 1. åˆ›å»ºè¿ç§»
pnpm prisma migrate dev --name add_tag_system

# 2. ç§å­æ ‡ç­¾
pnpm tsx scripts/seed-tag-system.ts

# 3. åˆ†æç°æœ‰æ•°æ®
pnpm tsx scripts/analyze-existing-plans.ts

# 4. æ™ºèƒ½æ ‡æ³¨
pnpm tsx scripts/auto-tag-plans.ts

# 5. å¯åŠ¨å®¡æ ¸ç•Œé¢
pnpm dev
# è®¿é—® http://localhost:3000/admin/tag-review
```

---

### Phase 3: å‰ç«¯é‡æ„ (2å‘¨)

**ä»»åŠ¡**:
- [ ] å®ç°æ–°çš„ç­›é€‰å™¨ç»„ä»¶
  - [ ] TagFilter
  - [ ] PriceRangeFilter
  - [ ] DurationFilter
  - [ ] ServiceLevelFilter
  - [ ] ConvenienceFilter
- [ ] é‡æ„ PlansClient é¡µé¢
- [ ] ä¼˜åŒ– PlanCard æ˜¾ç¤ºæ ‡ç­¾
- [ ] æ·»åŠ é¦–é¡µåœºæ™¯å¿«é€Ÿå…¥å£
- [ ] å®ç°æ™ºèƒ½æ¨èç®—æ³•
- [ ] å®ç°"ç›¸ä¼¼å¥—é¤"æ¨è
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] æ€§èƒ½ä¼˜åŒ–(è™šæ‹Ÿæ»šåŠ¨ã€æ‡’åŠ è½½)

**äº§å‡º**:
- å®Œæ•´çš„æ–°ç‰ˆç­›é€‰ç³»ç»Ÿ
- ä¼˜åŒ–çš„å¥—é¤å¡ç‰‡å±•ç¤º
- é¦–é¡µåœºæ™¯å¼•å¯¼
- æ™ºèƒ½æ¨èåŠŸèƒ½

---

### Phase 4: æµ‹è¯•ä¸ä¼˜åŒ– (1å‘¨)

**ä»»åŠ¡**:
- [ ] å•å…ƒæµ‹è¯•(ç­›é€‰é€»è¾‘ã€æ¨èç®—æ³•)
- [ ] é›†æˆæµ‹è¯•(å®Œæ•´é¢„è®¢æµç¨‹)
- [ ] æ€§èƒ½æµ‹è¯•(æŸ¥è¯¢å“åº”æ—¶é—´)
- [ ] A/B æµ‹è¯•æ–°æ—§ç­›é€‰å™¨(å¦‚æœæœ‰æµé‡)
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
  - [ ] æ·»åŠ æ•°æ®åº“ç´¢å¼•
  - [ ] å®ç° Redis ç¼“å­˜
  - [ ] ä¼˜åŒ– SQL æŸ¥è¯¢
- [ ] è°ƒæ•´æ ‡ç­¾æƒé‡
- [ ] ä¿®å¤ bug

**äº§å‡º**:
- æµ‹è¯•æŠ¥å‘Š
- æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š
- ç”¨æˆ·åé¦ˆæ€»ç»“
- æœ€ç»ˆç‰ˆæœ¬

---

### Phase 5: ä¸Šçº¿ä¸ç›‘æ§ (æŒç»­)

**ä»»åŠ¡**:
- [ ] ç°åº¦å‘å¸ƒ(10% æµé‡)
- [ ] ç›‘æ§å…³é”®æŒ‡æ ‡
  - ç­›é€‰å™¨ä½¿ç”¨ç‡
  - å¹³å‡å†³ç­–æ—¶é—´
  - è½¬åŒ–ç‡(æµè§ˆâ†’é¢„è®¢)
  - æŸ¥è¯¢æ€§èƒ½
- [ ] å…¨é‡å‘å¸ƒ
- [ ] æŒç»­ä¼˜åŒ–æ ‡ç­¾æ•°æ®
- [ ] å®šæœŸå®¡æ ¸æ–°å¢å¥—é¤æ ‡ç­¾

**å…³é”®æŒ‡æ ‡**:
| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ |
|------|------|------|
| å¹³å‡ç­›é€‰æ¬¡æ•° | ? | 2-3æ¬¡ |
| å¹³å‡å†³ç­–æ—¶é—´ | ? | < 5åˆ†é’Ÿ |
| è½¬åŒ–ç‡ | ? | +20% |
| ç­›é€‰å™¨ä½¿ç”¨ç‡ | ? | > 60% |

---

## å¾…è®¨è®ºå†³ç­–ç‚¹

### 1. æ ‡ç­¾ç³»ç»Ÿæ¶æ„é€‰æ‹©

**é—®é¢˜**: é€‰æ‹©å“ªç§æ•°æ®æ¨¡å‹æ–¹æ¡ˆ?

**é€‰é¡¹**:
- **æ–¹æ¡ˆA**: æšä¸¾å­—æ®µ (å¿«é€Ÿ MVP,æ€§èƒ½æœ€ä¼˜)
- **æ–¹æ¡ˆB**: å®Œå…¨æ ‡ç­¾ç³»ç»Ÿ (çµæ´»æ‰©å±•,é•¿æœŸæœ€ä¼˜)
- **æ–¹æ¡ˆC**: æ··åˆæ–¹æ¡ˆ (å¹³è¡¡æ€§èƒ½ä¸çµæ´»æ€§)

**å»ºè®®**:
- å¦‚æœéœ€è¦å¿«é€Ÿä¸Šçº¿ (1-2å‘¨): é€‰æ‹©**æ–¹æ¡ˆA**
- å¦‚æœè¿½æ±‚é•¿æœŸå¯ç»´æŠ¤æ€§: é€‰æ‹©**æ–¹æ¡ˆB**
- å¦‚æœéœ€è¦å¹³è¡¡: é€‰æ‹©**æ–¹æ¡ˆC**

**æ‚¨çš„é€‰æ‹©**: _________

---

### 2. é¦–é¡µå¼•å¯¼ç­–ç•¥

**é—®é¢˜**: æ¸¸å®¢è¿›å…¥ç½‘ç«™å,åº”è¯¥å¦‚ä½•å¼•å¯¼?

**é€‰é¡¹**:
- **A**: ç›´æ¥çœ‹åˆ°æ‰€æœ‰å¥—é¤ (å½“å‰æ–¹å¼)
- **B**: å…ˆé€‰æ‹©åœºæ™¯å†çœ‹æ¨èå¥—é¤ (åœºæ™¯å¡ç‰‡)
- **C**: é—®ç­”å¼å¼•å¯¼ (å¦‚"æ‚¨è®¡åˆ’å‡ ä¸ªäºº?", "æƒ³ç©å¤šä¹…?")
- **D**: æ··åˆ: é¦–é¡µæœ‰åœºæ™¯å¡ç‰‡ + "æµè§ˆå…¨éƒ¨"æŒ‰é’®

**å»ºè®®**: é€‰æ‹© **D** (æ··åˆæ–¹å¼)
- ç»™æƒ³å¿«é€Ÿå†³ç­–çš„ç”¨æˆ·æä¾›åœºæ™¯å…¥å£
- ç»™æƒ³è‡ªå·±æ¢ç´¢çš„ç”¨æˆ·æä¾›å…¨éƒ¨æµè§ˆ

**æ‚¨çš„é€‰æ‹©**: _________

---

### 3. æ•°æ®è¿ç§»ç­–ç•¥

**é—®é¢˜**: å¯¹äº 967 ä¸ªç°æœ‰å¥—é¤,å¦‚ä½•æ‰“æ ‡ç­¾?

**é€‰é¡¹**:
- **æ‰‹åŠ¨**: äººå·¥é€ä¸€å®¡æ ¸æ‰“æ ‡ç­¾ (å‡†ç¡®ä½†éœ€è¦ 967 * 3åˆ†é’Ÿ â‰ˆ 48å°æ—¶)
- **åŠè‡ªåŠ¨**: AIæ¨æ–­ + äººå·¥å®¡æ ¸å‰100ä¸ªé«˜ä¼˜å…ˆçº§å¥—é¤ (å¹³è¡¡)
- **å…¨è‡ªåŠ¨**: å®Œå…¨ä¾èµ–è§„åˆ™æ¨æ–­ (å¿«ä½†å¯èƒ½ä¸å‡†ç¡®)

**å»ºè®®**: é€‰æ‹© **åŠè‡ªåŠ¨**
- æ™ºèƒ½è„šæœ¬æ ‡æ³¨æ‰€æœ‰å¥—é¤
- äººå·¥å®¡æ ¸é«˜ä¼˜å…ˆçº§(featuredã€é«˜ä»·ã€é«˜æµé‡)å¥—é¤
- åç»­æ ¹æ®ç”¨æˆ·åé¦ˆé€æ­¥ä¼˜åŒ–

**æ‚¨çš„é€‰æ‹©**: _________

---

### 4. MVP èŒƒå›´

**é—®é¢˜**: ç¬¬ä¸€ä¸ªç‰ˆæœ¬åº”è¯¥åŒ…å«å“ªäº›ç­›é€‰ç»´åº¦?

**æ¨èçš„ MVP èŒƒå›´**:
1. âœ… **ä½¿ç”¨åœºæ™¯** (P0 - æœ€é‡è¦)
2. âœ… **ä»·æ ¼åŒºé—´** (P0)
3. âœ… **æœåŠ¡ç­‰çº§** (P0)
4. âš ï¸ ç§Ÿèµæ—¶é•¿ (P1)
5. âŒ é£æ ¼ä¸»é¢˜ (P2 - åç»­ç‰ˆæœ¬)
6. âŒ é€‚åˆäººç¾¤ (P2)
7. âŒ ä¾¿åˆ©æ€§ç‰¹æ€§ (P2)
8. âœ… åœ°åŒº (ä¿ç•™ç°æœ‰)

**å»ºè®®**: MVP åªå®ç° P0 çº§åˆ«çš„ 3 ä¸ªæ ¸å¿ƒç»´åº¦
- æœ€å°åŒ–å¼€å‘å·¥ä½œé‡
- å¿«é€ŸéªŒè¯æ•ˆæœ
- æ ¹æ®æ•°æ®å†³å®šåç»­è¿­ä»£

**æ‚¨çš„é€‰æ‹©**: _________

---

### 5. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

**é—®é¢˜**: å¦‚ä½•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½?

**é€‰é¡¹**:
- **A**: ä»…ä¾èµ–æ•°æ®åº“ç´¢å¼•
- **B**: æ•°æ®åº“ç´¢å¼• + Redis ç¼“å­˜æ ‡ç­¾æ•°æ®
- **C**: æ•°æ®åº“ç´¢å¼• + Redis ç¼“å­˜ + Elasticsearch å…¨æ–‡æœç´¢
- **D**: å†—ä½™å­—æ®µ(å¦‚ priceRange)å‡å°‘ JOIN

**å»ºè®®**:
- MVP: **A + D** (æ•°æ®åº“ç´¢å¼• + éƒ¨åˆ†å†—ä½™å­—æ®µ)
- ç”Ÿäº§ç¯å¢ƒ: **B** (å¢åŠ  Redis ç¼“å­˜)

**æ‚¨çš„é€‰æ‹©**: _________

---

### 6. å›½é™…åŒ–æ”¯æŒ

**é—®é¢˜**: æ˜¯å¦ç°åœ¨å°±æ”¯æŒå¤šè¯­è¨€?

**é€‰é¡¹**:
- **æ˜¯**: æ ‡ç­¾ç³»ç»Ÿè®¾è®¡æ—¶åŒ…å« nameEn å­—æ®µ
- **å¦**: æš‚æ—¶åªæ”¯æŒä¸­æ–‡,åç»­å†åŠ 

**å»ºè®®**: **æ˜¯**
- æ ‡ç­¾ç³»ç»Ÿæœ¬èº«å°±æ”¯æŒå¤šè¯­è¨€(TagCategory/Tag æœ‰ nameEn)
- å¢åŠ çš„æˆæœ¬å¾ˆå°
- é¿å…åç»­é‡æ„

**æ‚¨çš„é€‰æ‹©**: _________

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨

1. **ç¡®è®¤æ¶æ„æ–¹æ¡ˆ**: é€‰æ‹©æ–¹æ¡ˆ A/B/C
2. **è¿è¡Œæ•°æ®åˆ†æ**: `pnpm tsx scripts/analyze-existing-plans.ts`
3. **å®¡æŸ¥æ ‡ç­¾ä½“ç³»**: ç¡®è®¤ç§å­æ•°æ®æ˜¯å¦ç¬¦åˆä¸šåŠ¡éœ€æ±‚
4. **è¯„ä¼°æ—¶é—´é¢„ç®—**: ç¡®è®¤å„é˜¶æ®µæ—¶é—´æ˜¯å¦å¯è¡Œ

### éœ€è¦æ‚¨çš„è¾“å…¥

è¯·æ˜ç¡®ä»¥ä¸‹å†³ç­–:
- [ ] é€‰æ‹©çš„æ•°æ®æ¨¡å‹æ–¹æ¡ˆ: _________
- [ ] é¦–é¡µå¼•å¯¼ç­–ç•¥: _________
- [ ] æ•°æ®è¿ç§»ç­–ç•¥: _________
- [ ] MVP èŒƒå›´: _________
- [ ] æ€§èƒ½ä¼˜åŒ–ç­–ç•¥: _________
- [ ] æ˜¯å¦æ”¯æŒå›½é™…åŒ–: _________

---

## é™„å½•

### A. å‚è€ƒèµ„æ–™

- [Prisma å¤šå¯¹å¤šå…³ç³»æ–‡æ¡£](https://www.prisma.io/docs/concepts/components/prisma-schema/relations/many-to-many-relations)
- [Next.js æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ](https://nextjs.org/docs/advanced-features/performance-optimization)
- [Airbnb ç­›é€‰å™¨ UX ç ”ç©¶](https://airbnb.design/)

### B. ç›¸å…³æ–‡ä»¶

- `/docs/rental-plan-redesign.md` - æœ¬æ–‡æ¡£
- `/CLAUDE.md` - é¡¹ç›®æŠ€æœ¯æ–‡æ¡£
- `/prisma/schema.prisma` - å½“å‰æ•°æ®åº“ schema
- `/data/real-plans-data.json` - ç°æœ‰å¥—é¤æ•°æ®
- `/scripts/import-unified-plans.ts` - ç°æœ‰å¯¼å…¥è„šæœ¬

### C. è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–éœ€è¦è®¨è®º,è¯·:
- æ›´æ–°æœ¬æ–‡æ¡£å¹¶æäº¤ PR
- åœ¨é¡¹ç›® issue ä¸­è®¨è®º
- è”ç³»æŠ€æœ¯è´Ÿè´£äºº

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-11-02
**ç»´æŠ¤è€…**: Claude Code
**çŠ¶æ€**: ğŸ“ å¾…å®¡æ‰¹
