# 主页 Theme 分类重构计划

## 目标

将主页套餐展示从 `PlanCategory`（LADIES/MENS/COUPLE...）改为 `Theme`（潮流出片/盛大礼遇/亲友同行...）分类。

**参考**: Airbnb Services 页面 - 简洁的 Section 堆叠 + 横向滚动卡片

---

## 二、数据结构

### Theme 模型（已存在）

```prisma
model Theme {
  id           String   @id
  slug         String   @unique    // trendy-photo, formal-ceremony...
  name         String              // 潮流出片
  description  String?             // 详细说明
  icon         String?             // Lucide icon name (Camera, Crown...)
  color        String?             // 主题色 #FF6B6B
  coverImage   String?             // 主题封面图
  displayOrder Int      @default(0)
  isActive     Boolean  @default(true)
  seasonStart  DateTime?           // 季节限定开始
  seasonEnd    DateTime?           // 季节限定结束
  plans        RentalPlan[]
}
```

### 当前 Theme 数据

| Theme | slug | icon | color | 套餐数 |
|-------|------|------|-------|--------|
| 潮流出片 | trendy-photo | Camera | #FF6B6B | 3 |
| 盛大礼遇 | formal-ceremony | Crown | #9B59B6 | 3 |
| 亲友同行 | together | Users | #E91E63 | 4 |
| 季节限定 | seasonal | Leaf | #4CAF50 | 4 |
| 轻装漫步 | casual-stroll | Footprints | #00BCD4 | 0 |
| 特色套餐 | specialty | Sparkles | #FF9800 | 3 |

**活跃套餐**: 17 个（有 themeId 的套餐）

---

## 三、UI/UX 设计方案

### 方案 A：Tab 切换 + 横向滚动（Airbnb 风格）

```
┌─────────────────────────────────────────────────────────┐
│  [Hero Banner / 搜索栏]                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐    │
│  │📷     │ │👑     │ │👥     │ │🍂     │ │✨     │    │
│  │潮流出片│ │盛大礼遇│ │亲友同行│ │季节限定│ │特色套餐│    │
│  └───────┘ └───────┘ └───────┘ └───────┘ └───────┘    │
│     ▲ active                                            │
│                                                         │
│  ← [套餐卡片1] [套餐卡片2] [套餐卡片3] →                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**优点**：
- 界面简洁，一屏展示一个 Theme
- 用户聚焦，减少决策负担
- 横向滚动符合移动端习惯

**缺点**：
- 用户需要点击 Tab 才能发现其他 Theme
- 每个 Theme 套餐较少（3-4个），内容不够丰满

---

### 方案 B：Section 堆叠 + 横向滚动（当前风格改进）

```
┌─────────────────────────────────────────────────────────┐
│  [Hero Banner / 搜索栏]                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📷 潮流出片                                    查看更多 →│
│  ────────────────────────────────────────────────────   │
│  ← [套餐1] [套餐2] [套餐3] →                             │
│                                                         │
│  👑 盛大礼遇                                    查看更多 →│
│  ────────────────────────────────────────────────────   │
│  ← [套餐1] [套餐2] [套餐3] →                             │
│                                                         │
│  👥 亲友同行                                    查看更多 →│
│  ────────────────────────────────────────────────────   │
│  ← [套餐1] [套餐2] [套餐3] [套餐4] →                     │
│                                                         │
│  ...                                                    │
└─────────────────────────────────────────────────────────┘
```

**优点**：
- 用户滚动即可浏览所有 Theme
- 保留当前 UI 框架，改动较小
- 每个 Theme 都有展示机会

**缺点**：
- 页面较长，需要滚动较多
- 视觉上可能略显单调

---

### 方案 C：Hero 卡片 + 展开详情（杂志风格）

```
┌─────────────────────────────────────────────────────────┐
│  [Hero Banner / 搜索栏]                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │                                                 │   │
│  │         [Theme Cover Image: 潮流出片]           │   │
│  │                                                 │   │
│  │     📷 潮流出片                                 │   │
│  │     "用镜头定格你的和服瞬间"                    │   │
│  │                                                 │   │
│  │              [ 探索套餐 ]                       │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ 👑 盛大礼遇  │  │ 👥 亲友同行  │  │ 🍂 季节限定  │  │
│  │              │  │              │  │              │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**优点**：
- 视觉冲击力强，品牌调性好
- 突出重点 Theme（可轮播）
- 利用 `coverImage` 字段

**缺点**：
- 需要高质量封面图
- 开发工作量较大
- 套餐展示不直接，多一层点击

---

### 方案 D：混合模式（推荐）

结合方案 A 和 B 的优点：

```
┌─────────────────────────────────────────────────────────┐
│  [Hero Banner / 搜索栏]                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ── 选择你的和服体验 ──                                  │
│                                                         │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐              │
│  │ 📷 │ │ 👑 │ │ 👥 │ │ 🍂 │ │ ✨ │  ← 横向滚动     │
│  │潮流 │ │盛大 │ │亲友 │ │季节 │ │特色 │              │
│  │出片 │ │礼遇 │ │同行 │ │限定 │ │套餐 │              │
│  └─────┘ └─────┘ └─────┘ └─────┘ └─────┘              │
│     ▲                                                   │
│                                                         │
│  📷 潮流出片                                            │
│  "用镜头定格你的和服瞬间，打造社交爆款"                   │
│  ────────────────────────────────────────────────────   │
│                                                         │
│  ┌────────┐ ┌────────┐ ┌────────┐                      │
│  │        │ │        │ │        │                      │
│  │ 套餐1  │ │ 套餐2  │ │ 套餐3  │                      │
│  │        │ │        │ │        │                      │
│  │ ¥5980  │ │ ¥8980  │ │ ¥15800 │                      │
│  └────────┘ └────────┘ └────────┘                      │
│                                                         │
│  ── 其他精选 ──                                         │
│                                                         │
│  👑 盛大礼遇                                   查看更多 →│
│  ← [套餐1] [套餐2] [套餐3] →                             │
│                                                         │
│  👥 亲友同行                                   查看更多 →│
│  ← [套餐1] [套餐2] [套餐3] [套餐4] →                     │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**特点**：
1. **Theme 快捷入口**：顶部横向滚动的 Theme Pills
2. **焦点 Theme 展示**：点击 Pill 后，该 Theme 展开详情
3. **其他 Theme 预览**：折叠显示其他 Theme 的套餐
4. **平滑过渡**：切换 Theme 时页面不跳转，内容区更新

---

## 四、交互设计

### 4.1 Theme 切换

| 操作 | 行为 |
|-----|------|
| 点击 Theme Pill | 焦点区展示该 Theme 套餐，其他 Theme 折叠 |
| 滚动页面 | 其他 Theme Section 正常展示 |
| URL 同步 | `/?theme=trendy-photo` 可直接定位 |

### 4.2 筛选器整合

当前的筛选器（店铺、地区、标签）保留，但：
- Theme 作为**主分类**，不在筛选器中
- 筛选器在 Theme 内部生效

### 4.3 移动端适配

- Theme Pills 横向滚动，当前选中居中
- 套餐卡片单列或双列网格
- 底部可固定「快速筛选」按钮

---

## 五、视觉设计

### 5.1 Theme Pill 组件

```
┌──────────────────┐
│  [Icon]          │
│  Theme Name      │
│                  │
│  (active: 边框高亮 + 背景色淡化)
└──────────────────┘
```

- 尺寸：80px × 80px（移动端）/ 100px × 100px（桌面端）
- 图标：使用 Lucide React（Camera, Crown, Users, Leaf, Sparkles）
- 颜色：使用 Theme 的 `color` 字段作为主题色
- 状态：hover 放大，active 边框 + 背景

### 5.2 Theme Header

```
📷 潮流出片
用镜头定格你的和服瞬间，打造社交爆款
```

- 图标 + 名称：大字，Theme 颜色
- 描述：副标题，灰色
- 可选：右侧「查看全部」链接

### 5.3 配色方案

使用 Theme 自带颜色，搭配樱花美学基调：

| Theme | color | 应用 |
|-------|-------|-----|
| 潮流出片 | #FF6B6B | Pill 边框、标题色 |
| 盛大礼遇 | #9B59B6 | Pill 边框、标题色 |
| 亲友同行 | #E91E63 | Pill 边框、标题色 |
| 季节限定 | #4CAF50 | Pill 边框、标题色 |
| 特色套餐 | #FF9800 | Pill 边框、标题色 |

---

## 六、技术实现

### 6.1 数据层改动

**page.tsx**：
```typescript
// 获取所有活跃的 Theme（按 displayOrder 排序）
const themes = await prisma.theme.findMany({
  where: { isActive: true },
  orderBy: { displayOrder: 'asc' },
});

// 获取有 themeId 的套餐
const plans = await prisma.rentalPlan.findMany({
  where: {
    isActive: true,
    themeId: { not: null },
  },
  include: { theme: true },
});

// 按 Theme 分组
const themeSections = themes.map(theme => ({
  ...theme,
  plans: plans.filter(p => p.themeId === theme.id),
})).filter(section => section.plans.length > 0);
```

### 6.2 组件结构

```
HomeClient.tsx
├── ThemePills.tsx          // 顶部 Theme 快捷入口
├── ThemeSection.tsx        // 单个 Theme 的套餐展示
│   ├── ThemeHeader.tsx     // Theme 标题 + 描述
│   └── PlanCardList.tsx    // 套餐卡片列表（复用现有）
└── FilterDrawer.tsx        // 筛选器（保留现有）
```

### 6.3 状态管理

```typescript
// URL 参数同步
const [activeTheme, setActiveTheme] = useState<string | null>(
  searchParams.get('theme') || themes[0]?.slug || null
);

// 切换 Theme 时更新 URL
const handleThemeChange = (slug: string) => {
  setActiveTheme(slug);
  router.push(`/?theme=${slug}`, { scroll: false });
};
```

---

## 七、实施步骤

### Phase 1：数据层准备
- [ ] 确认 17 个有 Theme 的套餐数据完整
- [ ] 确保 Theme 的 icon、color、description 字段已填充
- [ ] 添加 coverImage（可选，后续优化）

### Phase 2：组件开发
- [ ] 创建 ThemePill 组件
- [ ] 创建 ThemeSection 组件
- [ ] 修改 HomeClient 使用新组件

### Phase 3：交互完善
- [ ] 实现 Theme 切换动画
- [ ] URL 参数同步
- [ ] 移动端适配

### Phase 4：视觉优化
- [ ] 应用 Theme 配色
- [ ] 添加 hover/active 状态
- [ ] 响应式布局调整

---

## 八、已确认决策

| 问题 | 决策 | 说明 |
|-----|------|------|
| PlanCategory | ✅ 移除 | 完全使用 Theme 分类，不再使用 LADIES/MENS 等 |
| 无套餐 Theme | ✅ 显示「即将上线」 | 如「轻装漫步」显示但置灰 |
| 季节限定控制 | ✅ 暂不需要 | 手动管理，不自动隐藏 |
| 方案选择 | ✅ 方案 D（混合模式） | 顶部 Pills + 焦点展开 + 其他预览 |

---

## 九、细节讨论

### 9.1 Theme Pills 设计

**样式选项**：

```
选项 A: 圆形图标 + 文字（竖排）     选项 B: 胶囊按钮（横排）
┌───────┐                         ┌─────────────┐
│  📷   │                         │ 📷 潮流出片 │
│       │                         └─────────────┘
│潮流出片│
└───────┘

选项 C: 卡片式（带背景色）
┌─────────────────┐
│ ░░░░░░░░░░░░░░░ │  ← 淡主题色背景
│      📷        │
│    潮流出片     │
│  "拍照打卡首选"  │  ← 可选副标题
└─────────────────┘
```

**推荐选项 A**（圆形图标 + 文字竖排）：
- 视觉紧凑，移动端友好
- 类似 Airbnb 的分类入口
- 图标作为视觉锚点

### 9.2 焦点 Theme 展示区

当用户选中一个 Theme 后，焦点区如何展示？

**选项 A: 展开式（当前位置展开）**
```
┌─────┐ ┌─────┐ ┌─────┐
│ 📷 │ │ 👑 │ │ 👥 │
│潮流 │ │盛大 │ │亲友 │
└──▲──┘ └─────┘ └─────┘
   │
   ▼ 展开
┌─────────────────────────────────┐
│ 📷 潮流出片                     │
│ "用镜头定格你的和服瞬间"        │
│                                 │
│ [套餐1] [套餐2] [套餐3]         │
└─────────────────────────────────┘
```

**选项 B: 固定区域（Pills 下方固定位置）**
```
┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐
│ 📷 │ │ 👑 │ │ 👥 │ │ 🍂 │
│ ▲  │ └─────┘ └─────┘ └─────┘
└─────┘
────────────────────────────────── ← 固定分隔线
┌─────────────────────────────────┐
│ 📷 潮流出片                     │
│ "用镜头定格你的和服瞬间"        │
│                                 │
│ [套餐1] [套餐2] [套餐3]         │
└─────────────────────────────────┘
```

**推荐选项 B**（固定区域）：
- 布局稳定，不会因切换而跳动
- 用户心智模型清晰

### 9.3 「即将上线」Theme 展示

```
┌─────────────────┐
│      🚶        │  ← 灰色图标
│    轻装漫步     │  ← 灰色文字
│                 │
│   即将上线      │  ← 小标签
└─────────────────┘
```

点击时：
- 选项 A: 无反应（禁用状态）
- 选项 B: 弹出提示「敬请期待」
- 选项 C: 跳转到「订阅通知」表单

**推荐选项 B**（弹出提示）：简单友好

### 9.4 其他 Theme 预览区

焦点 Theme 下方，其他 Theme 如何展示？

**选项 A: 折叠式（仅标题 + 查看更多）**
```
👑 盛大礼遇 ────────────────── 查看全部 →

👥 亲友同行 ────────────────── 查看全部 →
```

**选项 B: 预览式（显示 1-2 个套餐）**
```
👑 盛大礼遇                        查看全部 →
← [套餐1] [套餐2] →

👥 亲友同行                        查看全部 →
← [套餐1] [套餐2] [套餐3] →
```

**选项 C: 网格预览（紧凑卡片）**
```
── 探索更多体验 ──

┌─────────┐ ┌─────────┐ ┌─────────┐
│👑 盛大  │ │👥 亲友  │ │🍂 季节  │
│ 礼遇    │ │ 同行    │ │ 限定    │
│ 3个套餐 │ │ 4个套餐 │ │ 4个套餐 │
└─────────┘ └─────────┘ └─────────┘
```

**推荐选项 B**（预览式）：
- 用户可以快速浏览
- 减少点击次数
- 保持页面活跃感

### 9.5 移动端适配

**Theme Pills**:
- 横向滚动，当前选中居中
- Pills 尺寸: 64px × 64px

**焦点区套餐卡片**:
- 选项 A: 单列全宽
- 选项 B: 双列网格
- 选项 C: 横向滚动（保持与桌面一致）

**推荐选项 C**（横向滚动）：交互一致性好

**其他预览区**:
- 保持横向滚动
- 每个 Theme 显示 2 个套餐预览

### 9.6 动画与过渡

| 交互 | 动画 |
|-----|------|
| 切换 Theme | 焦点区内容 fade + slide (300ms) |
| Pill hover | scale(1.05) + shadow |
| Pill active | border 高亮 + 背景淡色 |
| 套餐卡片 hover | scale(1.02) + shadow |

### 9.7 URL 与分享

```
/                        → 默认显示第一个 Theme
/?theme=trendy-photo     → 直接定位到「潮流出片」
/?theme=seasonal         → 直接定位到「季节限定」
```

好处：
- 可分享特定主题链接
- SEO 友好
- 浏览器后退可用

---

## 十、待确认细节

请确认以下选择：

| 问题 | 你的选择 |
|-----|---------|
| 9.1 Pills 样式 | A(圆形竖排) / B(胶囊横排) / C(卡片式) |
| 9.2 焦点展示 | A(展开式) / B(固定区域) |
| 9.3 即将上线交互 | A(禁用) / B(弹提示) / C(订阅表单) |
| 9.4 其他预览 | A(折叠) / B(预览式) / C(网格) |
| 9.5 移动端卡片 | A(单列) / B(双列) / C(横向滚动) |

---

## 十一、参考设计

- Airbnb 首页分类体验
- Klook 活动分类
- 小红书内容分类

---

**确认细节后，即可开始开发。**
