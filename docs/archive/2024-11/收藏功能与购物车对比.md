# 收藏功能（爱心）vs 购物车功能 - 设计讨论

## 当前实现状态

### 1. 收藏功能（❤️ 爱心按钮）

**位置**：`src/components/PlanCard/index.tsx:81-96`

```tsx
const [isFavorited, setIsFavorited] = useState(false);

<button onClick={(e) => {
  e.preventDefault();
  setIsFavorited(!isFavorited);
}}>
  <Heart className={isFavorited ? 'fill-sakura-500' : 'text-gray-700'} />
</button>
```

**问题：**
- ❌ 仅为本地 state，刷新页面就丢失
- ❌ 没有调用后端 API 持久化
- ❌ 没有用户收藏列表页面
- ⚠️ 数据库中的 `Favorite` 模型只针对 `Kimono`（单品），不支持 `RentalPlan`（套餐）

**实际效果**：目前是一个**假按钮**，点击了也不会真正保存。

### 2. 购物车功能（🛒 购物车）

**位置**：`src/store/cart.ts`

**数据库支持**：
```prisma
model Cart {
  userId    String?    @unique
  sessionId String?    @unique
  expiresAt DateTime
  items     CartItem[]
}

model CartItem {
  planId    String?
  quantity  Int
  addOns    String[]
  storeId   String?
  // ...
}
```

**功能：**
- ✅ Zustand + localStorage 持久化
- ✅ 支持游客和登录用户
- ✅ 支持数量、店铺选择、附加服务
- ✅ 有完整的结账流程
- ✅ 数据库备份（Cart 表）

**实际效果**：完整的电商购物车功能。

---

## 功能重叠分析

### 相似点：都是"保存套餐以便稍后处理"

| 功能 | 收藏（Favorite） | 购物车（Cart） |
|------|-----------------|---------------|
| **触发位置** | 套餐卡片上的爱心 | 详情页"加入购物车"按钮 |
| **用户意图** | "我对这个感兴趣，标记一下" | "我想预订这个，暂存起来" |
| **持久性** | 长期保存（月/年） | 短期保存（天/周） |
| **数量** | 单个套餐（不支持数量） | 支持多个数量 |
| **购买决策** | 未决定 | 已决定，但还没结账 |
| **后续操作** | 浏览、比较、分享 | 立即结账 |

### 差异点：购买漏斗的不同阶段

```
发现套餐 → 收藏（兴趣） → 加入购物车（意向） → 结账（转化）
  ↓           ↓                 ↓                    ↓
浏览列表    标记喜欢的          确定要买的           完成支付
```

---

## 问题与改进方向

### ❓ 核心问题：我们真的需要收藏功能吗？

#### 方案 A：保留收藏 + 完善实现（传统电商模式）

**理由：**
- 长决策周期产品（和服体验需要计划行程）
- 用户可能同时比较多个套餐
- 支持分享收藏列表给朋友/家人
- Airbnb、Booking.com 都有心愿单功能

**需要做的事：**
1. 数据库扩展：添加 `FavoritePlan` 模型
   ```prisma
   model FavoritePlan {
     id        String   @id @default(cuid())
     userId    String
     planId    String
     createdAt DateTime @default(now())

     user      User       @relation(...)
     plan      RentalPlan @relation(...)

     @@unique([userId, planId])
   }
   ```

2. API 实现：
   - `POST /api/favorites/plans` - 添加收藏
   - `DELETE /api/favorites/plans/:id` - 取消收藏
   - `GET /api/favorites/plans` - 获取收藏列表

3. 前端页面：
   - `/profile/favorites` - 收藏列表页
   - 收藏列表支持批量操作（全部加入购物车、删除）

4. 组件修复：
   - PlanCard 调用收藏 API
   - 支持未登录用户（提示登录）
   - 服务端获取收藏状态（避免闪烁）

**优点：**
- ✅ 符合传统电商用户习惯
- ✅ 降低购物车压力（购物车只放确定要买的）
- ✅ 提高回访率（用户想回来看收藏）
- ✅ 数据分析价值（收藏但未购买的套餐是什么？）

**缺点：**
- ❌ 增加开发成本（API + UI + 数据库）
- ❌ 增加系统复杂度
- ❌ 可能造成困惑（"收藏和购物车有什么区别？"）

---

#### 方案 B：移除收藏功能（简化模式）

**理由：**
- 和服体验是**冲动消费**（看到喜欢的就想订）
- 预订流程已经很简单（单页结账）
- 购物车本身就支持"暂存"功能
- 减少用户决策点（符合"减少选择困难"设计哲学）

**需要做的事：**
1. 删除 PlanCard 上的爱心按钮
2. 强化购物车的"暂存"角色：
   - 延长购物车过期时间（7天 → 30天）
   - 购物车改名为"我的套餐"或"待预订"
   - 购物车页面支持浏览模式（不只是结账前一步）

**优点：**
- ✅ 简化 UI（少一个按钮，少一个功能）
- ✅ 降低开发成本
- ✅ 符合"减少选择困难"的设计原则
- ✅ 购物车就是唯一的"暂存区"

**缺点：**
- ❌ 失去社交分享功能（"看看我收藏的套餐"）
- ❌ 无法区分"感兴趣"和"要购买"
- ❌ 购物车混合了两种意图

---

#### 方案 C：混合模式 - 购物车作为收藏（Notion/GitHub 模式）

**设计理念：**
- 购物车不只是"临时购物篮"，而是"我的套餐工作区"
- 添加状态标记：`status: SAVED | TO_BOOK | RESERVED`

**数据库扩展：**
```prisma
model CartItem {
  // ... 现有字段
  status    String   @default("SAVED")  // SAVED | TO_BOOK | RESERVED
  priority  Int?                        // 优先级（排序用）
  tags      String[]                    // 自定义标签（"蜜月"、"家庭出游"）
}
```

**UI 变化：**
```
购物车页面：
┌─────────────────────────────────────┐
│ 我的套餐                             │
├─────────────────────────────────────┤
│ [已保存] [待预订] [已预约]            │  ← Tab 切换
├─────────────────────────────────────┤
│ □ 经典女士套餐     ¥399   [预订]     │
│ □ 浴衣体验套餐     ¥299   [预订]     │
│ □ 情侣和服套餐     ¥699   [预订]     │
└─────────────────────────────────────┘
  [全选] [立即预订选中的 3 个套餐]
```

**优点：**
- ✅ 一个功能解决两个需求
- ✅ 灵活性高（用户自己标记状态）
- ✅ 符合现代应用趋势（Notion 的 Database，GitHub 的 Project）

**缺点：**
- ❌ 概念复杂（"购物车"不再是传统购物车）
- ❌ 需要重新设计 UI
- ❌ 可能困惑老年用户

---

## 推荐方案

### 短期（MVP）：方案 B - 移除收藏功能

**原因：**
1. **符合产品定位**："减少选择困难" → 少一个功能就是减少困惑
2. **降低开发成本**：当前收藏功能是假的，修复它需要大量工作
3. **购物车足够用**：和服预订不是高频消费，购物车已经够用
4. **测试假设**：观察用户行为，看是否真的需要收藏

**具体行动：**
```
1. 删除 PlanCard 上的爱心按钮
2. 购物车过期时间从 7天 → 30天
3. 购物车页面添加"保存的套餐"提示
4. 添加分析埋点：跟踪购物车使用模式
```

---

### 长期（根据数据决定）：方案 A 或 C

**观察指标：**
- 用户是否频繁清空/重新添加购物车？
- 购物车平均存放时间是多久？
- 用户是否会询问"能保存喜欢的套餐吗？"

**决策规则：**
- 如果用户需要"长期保存" → 实现方案 A（独立收藏功能）
- 如果用户需要"灵活管理" → 实现方案 C（购物车扩展）
- 如果用户没有痛点 → 保持方案 B（不加收藏）

---

## 其他电商平台对比

| 平台 | 收藏 | 购物车 | 设计逻辑 |
|------|-----|--------|----------|
| **Amazon** | ❤️ 心愿单 | 🛒 购物车 | 明确分离：心愿单=长期，购物车=短期 |
| **Airbnb** | ❤️ 心愿单 | 无购物车 | 单次预订为主，心愿单用于旅行计划 |
| **美团** | ⭐ 收藏店铺 | 🛒 购物车 | 收藏店铺（不是商品），购物车用于下单 |
| **大众点评** | ⭐ 收藏 | 无购物车 | 本地服务，无需购物车（即订即用）|
| **小红书** | ❤️ 收藏笔记 | 无购物车 | 内容平台，收藏用于稍后阅读 |

**和服租赁更像谁？**
- **60% Airbnb**（体验预订，非商品购买）
- **30% 美团**（本地服务）
- **10% Amazon**（有购物车流程）

**结论**：Airbnb 没有购物车也运营得很好，说明体验类产品可以不要购物车，或者让"心愿单"承担更多功能。

---

## 最终建议

### 立即行动（本周）：

1. **移除假的爱心按钮**
   - 删除 `PlanCard/index.tsx` 中的收藏按钮（line 81-96）
   - 避免给用户错误预期

2. **优化购物车提示文案**
   - "购物车" → "我的预订"
   - "已加入购物车" → "已暂存，可随时查看"

### 中期观察（3个月）：

3. **添加分析埋点**
   - 跟踪购物车使用模式
   - 用户反馈收集（是否需要收藏功能）

### 长期迭代（根据数据）：

4. **如果需要收藏**
   - 实现方案 A（独立收藏系统）
   - 或实现方案 C（购物车扩展为工作区）

---

**最后更新**：2025-01-05
**讨论参与者**：产品团队
