# Service Hotmap Integration Design (v9)

## è®¾è®¡å†³ç­–

- **æ ¸å¿ƒç›®çš„**ï¼šå±•ç¤ºä¿¡æ¯å®Œæ•´æ€§ï¼ˆå¥—é¤åŒ…å«çš„æ‰€æœ‰æœåŠ¡ï¼‰
- **çƒ­ç‚¹å›¾å¯é€‰**ï¼šå•†æˆ·å¯ä»¥é€‰æ‹©ä¸åˆ›å»ºçƒ­ç‚¹å›¾ï¼Œåªé€‰æœåŠ¡ç»„ä»¶å³å¯
- **çƒ­ç‚¹å›¾å›¾ç‰‡**ï¼šåªæœ‰ä¸¤ç§æ¥æº - è‡ªå®šä¹‰ä¸Šä¼  æˆ– å¹³å°æ¨¡æ¿
- **ç»„ä»¶åˆ†ç±»**ï¼šä¸¤ç§ç±»å‹ - OUTFIT (ç€è£…é¡¹) / ADDON (å¢å€¼æœåŠ¡)
- **ç»„ä»¶æ‰€æœ‰æƒ**ï¼š**ä»…å¹³å°ç»„ä»¶**ï¼Œå•†æˆ·ä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶
- **ç»„ä»¶ç®¡ç†**ï¼šå¹³å°ç»Ÿä¸€ç®¡ç†ç»„ä»¶ï¼ŒæŒ‰ä¸»é¢˜ç»„ç»‡
- **ä»·æ ¼ç®¡ç†**ï¼šå•†æˆ·çº§åˆ«å®šä»·ï¼ˆè®¾ä¸€æ¬¡ï¼Œæ‰€æœ‰å¥—é¤é€šç”¨ï¼‰
- **æ•°æ®å­˜å‚¨**ï¼šçƒ­ç‚¹ä½ç½®å­˜åœ¨ `PlanComponent` é‡Œï¼ˆæ¯ä¸ªå¥—é¤ç‹¬ç«‹ï¼‰
- **æœåŠ¡å‡çº§**ï¼šåŒç±»å‹ç»„ä»¶æ”¯æŒä»˜è´¹å‡çº§ï¼Œæé«˜å®¢å•ä»·
- **ä¸»é¢˜ç»‘å®š**ï¼šç»„ä»¶ä¸ä¸»é¢˜å…³è”ï¼Œå•†æˆ·é€‰ä¸»é¢˜åè·å¾—æ¨èç»„ä»¶é›†

---

## ç»„ä»¶ç±»å‹è®¾è®¡

### OUTFIT vs ADDON çš„æ ¸å¿ƒå·®å¼‚

| ç‰¹æ€§ | OUTFIT (ç€è£…é¡¹) | ADDON (å¢å€¼æœåŠ¡) |
|------|----------------|------------------|
| çƒ­å›¾å®šä½ | âœ… éœ€è¦ hotmapX/Y | âŒ ä¸éœ€è¦ |
| å›¾ç‰‡å±•ç¤º | âœ… å¯é€‰ imageUrl | âœ… å¯é€‰ imageUrl |
| åŸºç¡€ä»·æ ¼ | âœ… æ”¯æŒ basePrice | âœ… æ”¯æŒ basePrice |
| åŒ…å«æ¨¡å¼ | âœ… isIncluded=true | âœ… isIncluded=true |
| å¯é€‰åŠ è´­ | âœ… isIncluded=false | âœ… isIncluded=false |
| å‡çº§è·¯å¾„ | âœ… ComponentUpgrade | âœ… ComponentUpgrade |

**ç»“è®ºï¼šä¸¤ç§ç±»å‹å…±ç”¨åŒä¸€å¥—æ•°æ®æ¨¡å‹ï¼Œåªæœ‰çƒ­å›¾å®šä½çš„å·®å¼‚ã€‚**

### åŒ…å«æ¨¡å¼ vs å¯é€‰åŠ è´­æ¨¡å¼

```
åŒ…å«æ¨¡å¼ (isIncluded = true)
â”œâ”€â”€ ç»„ä»¶å·²åŒ…å«åœ¨å¥—é¤åŸºç¡€ä»·ä¸­
â”œâ”€â”€ é¡¾å®¢æ— éœ€é¢å¤–ä»˜è´¹
â””â”€â”€ ç¤ºä¾‹ï¼šè±ªåå¥—é¤è‡ªå¸¦ã€Œä¸“ä¸šè·Ÿæ‹ã€

å¯é€‰åŠ è´­æ¨¡å¼ (isIncluded = false)
â”œâ”€â”€ ç»„ä»¶ä¸åœ¨å¥—é¤åŸºç¡€ä»·ä¸­
â”œâ”€â”€ é¡¾å®¢é€‰ä¸­åé¢å¤–ä»˜è´¹
â””â”€â”€ ç¤ºä¾‹ï¼šåŸºç¡€å¥—é¤å¯é€‰åŠ è´­ã€Œä¸“ä¸šè·Ÿæ‹ +Â¥1,800ã€
```

### ä»·æ ¼è®¡ç®—ï¼ˆv9 å•†æˆ·å®šä»·ï¼‰

```typescript
// å¥—é¤æ€»ä»· = åŸºç¡€ä»· + Î£(é¡¾å®¢é€‰ä¸­çš„å¯é€‰ç»„ä»¶ä»·æ ¼)
async function calculateTotal(
  plan: RentalPlan,
  selectedOptionalIds: string[],  // é¡¾å®¢é€‰ä¸­çš„å¯é€‰ç»„ä»¶
  merchantId: string
) {
  let total = plan.price;  // åŸºç¡€å¥—é¤ä»·

  for (const pc of plan.planComponents) {
    // è·³è¿‡å·²åŒ…å«çš„ç»„ä»¶ (ä¸é¢å¤–æ”¶è´¹)
    if (pc.isIncluded) continue;

    // é¡¾å®¢é€‰ä¸­äº†è¿™ä¸ªå¯é€‰ç»„ä»¶
    if (selectedOptionalIds.includes(pc.componentId)) {
      // è·å–å•†æˆ·å®šä»·ï¼ˆä¼˜å…ˆï¼‰æˆ–å¹³å°å»ºè®®ä»·
      total += await getEffectivePrice(pc.componentId, merchantId);
    }
  }

  return total;
}

// è·å–æœ‰æ•ˆä»·æ ¼ï¼šå•†æˆ·å®šä»· > å¹³å°å»ºè®®ä»·
async function getEffectivePrice(componentId: string, merchantId: string) {
  const merchantPrice = await prisma.merchantComponentPrice.findUnique({
    where: { merchantId_componentId: { merchantId, componentId } }
  });

  if (merchantPrice) {
    return merchantPrice.price;
  }

  const component = await prisma.serviceComponent.findUnique({
    where: { id: componentId }
  });

  return component?.basePrice ?? 0;
}
```

**v9 è®¾è®¡è¯´æ˜**ï¼š

- ç»„ä»¶ç”±å¹³å°ç»Ÿä¸€ç®¡ç†ï¼Œå•†æˆ·ä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶
- å•†æˆ·é€šè¿‡ `MerchantComponentPrice` è®¾ç½®è‡ªå·±çš„ä»·æ ¼
- ä»·æ ¼ä¸ºå•†æˆ·çº§åˆ«ï¼ˆè®¾ä¸€æ¬¡ï¼Œæ‰€æœ‰å¥—é¤é€šç”¨ï¼‰
- æœªè®¾ç½®å•†æˆ·ä»·æ ¼æ—¶ï¼Œä½¿ç”¨å¹³å°å»ºè®®ä»·

---

## æ ¸å¿ƒå®ä½“å…³ç³»ï¼ˆv9 å¹³å°ç»Ÿä¸€ç®¡ç†ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å¹³å°å±‚ (Platform)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Theme (ä¸»é¢˜)                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æŒ¯è¢–ä¸»é¢˜ / è®¿é—®ç€ä¸»é¢˜ / ç”·å£«ç¾½ç»‡ä¸»é¢˜ / æƒ…ä¾£ä¸»é¢˜ / ...            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                                               â”‚
â”‚         â”‚ ThemeComponent (ä¸»é¢˜-ç»„ä»¶å…³è”)                                â”‚
â”‚         â–¼                                                               â”‚
â”‚  ServiceComponent (å¹³å°ç»„ä»¶åº“ - ç»Ÿä¸€ç®¡ç†)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  OUTFIT (ç€è£…é¡¹)                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ‘˜ æŒ¯è¢–å’Œæœ      basePrice: Â¥5,000 (å»ºè®®ä»·)                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ‘˜ è®¿é—®ç€        basePrice: Â¥3,000                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ€ å¸¯ãƒ»å¸¯ç· ã‚    basePrice: Â¥1,000                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€ ğŸ’„ å‘å‹è®¾è®¡      basePrice: Â¥500                            â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  ADDON (å¢å€¼æœåŠ¡)                                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ“¸ ä¸“ä¸šè·Ÿæ‹      basePrice: Â¥2,000                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ’ è¡Œæå¯„å­˜      basePrice: Â¥300                            â”‚   â”‚
â”‚  â”‚  â””â”€â”€ ğŸš— æ¥é€æœåŠ¡      basePrice: Â¥1,500                          â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  ğŸ’¡ ç»„ä»¶ç”±å¹³å°ç»Ÿä¸€ç®¡ç†ï¼Œå•†æˆ·ä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶                       â”‚   â”‚
â”‚  â”‚  ğŸ’¡ åç§°ã€å›¾æ ‡ã€æè¿°ç­‰ç”±å¹³å°æ§åˆ¶ï¼Œä¿è¯ç”¨æˆ·ä½“éªŒä¸€è‡´                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                          å•†æˆ·è®¾ç½®ä»·æ ¼
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å•†æˆ·å±‚ (Merchant)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  MerchantComponentPrice (å•†æˆ·å®šä»· - å•†æˆ·çº§åˆ«ï¼Œæ‰€æœ‰å¥—é¤é€šç”¨)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å•†æˆ·A çš„å®šä»·ï¼š                                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ‘˜ æŒ¯è¢–å’Œæœ      price: Â¥4,500 (ä½äºå»ºè®®ä»·)                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ€ å¸¯ãƒ»å¸¯ç· ã‚    price: Â¥1,000 (ä½¿ç”¨å»ºè®®ä»·)                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ“¸ ä¸“ä¸šè·Ÿæ‹      price: Â¥1,800                              â”‚   â”‚
â”‚  â”‚  â””â”€â”€ ğŸš— æ¥é€æœåŠ¡      (æœªå¯ç”¨)                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  RentalPlan (å¥—é¤)                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ themeId: 'æŒ¯è¢–ä¸»é¢˜'                                               â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚ PlanComponent[] (å…³è”å¹³å°ç»„ä»¶ï¼Œä½¿ç”¨å•†æˆ·å®šä»·)                       â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ â”‚ ğŸ‘˜ æŒ¯è¢–å’Œæœ       hotmapX: 0.5, hotmapY: 0.3, isIncluded: T  â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ ğŸ€ å¸¯ãƒ»å¸¯ç· ã‚     hotmapX: 0.4, hotmapY: 0.6, isIncluded: T  â”‚  â”‚   â”‚
â”‚  â”‚ â”‚ ğŸ“¸ ä¸“ä¸šè·Ÿæ‹       hotmapX: null, isIncluded: F (å¯é€‰åŠ è´­)    â”‚  â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### v9 è®¾è®¡ä¼˜åŠ¿

1. **é£æ ¼ç»Ÿä¸€**ï¼šç»„ä»¶åç§°ã€å›¾æ ‡ã€æè¿°ç”±å¹³å°ç»Ÿä¸€ç®¡ç†
2. **ä¸»é¢˜ç®¡ç†**ï¼šå¹³å°å¯æŒ‰ä¸»é¢˜ç»„ç»‡ç»„ä»¶ï¼Œæ¨ä¸»é¢˜æ´»åŠ¨æ—¶ç»Ÿä¸€æ§åˆ¶
3. **ä»·æ ¼çµæ´»**ï¼šå•†æˆ·å¯è®¾ç½®è‡ªå·±çš„ä»·æ ¼ï¼Œå•†æˆ·çº§åˆ«ï¼ˆæ‰€æœ‰å¥—é¤é€šç”¨ï¼‰
4. **æ“ä½œç®€å•**ï¼šå•†æˆ·ç›´æ¥é€‰ç»„ä»¶ + è®¾ä»·æ ¼ï¼Œæ— éœ€ç®¡ç†"æˆ‘çš„æœåŠ¡åº“"
5. **å‡å°‘é€‰æ‹©**ï¼šä¸»é¢˜æ¨èç»„ä»¶ï¼Œå‡å°‘å•†æˆ·é€‰æ‹©å›°éš¾

---

## æœåŠ¡ç»„ä»¶å‡çº§æœºåˆ¶

### è®¾è®¡ç›®æ ‡

**æé«˜å®¢å•ä»·**ï¼šè®©ç”¨æˆ·åœ¨åŸºç¡€å¥—é¤ä¸Šè¿½åŠ æ¶ˆè´¹ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±é€‰æ‹©é«˜ä»·å¥—é¤ã€‚

åˆ©ç”¨ã€Œé”šå®šæ•ˆåº”ã€+ ã€Œæ¸è¿›å¼æ‰¿è¯ºã€å¿ƒç†ï¼š
- ç”¨æˆ·å…ˆè¢«ä½ä»·å¸å¼•è¿›å…¥
- çœ‹åˆ°å…·ä½“å†…å®¹åï¼Œæ„¿æ„ä¸ºã€Œæ›´å¥½çš„ä½“éªŒã€ä»˜è´¹

### å‡çº§æ¨¡å¼ï¼šæ··åˆæ¨¡å¼

```
åŸºç¡€å¥—é¤ Â¥9,800

ğŸ’ æ¨èå‡çº§                        [ä¸€é”®å‡çº§ +Â¥10,000]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‡çº§ä¸ºè±ªåä½“éªŒï¼š                                                         â”‚
â”‚ âœ“ å°çº¹ â†’ æŒ¯è¢–                                                          â”‚
â”‚ âœ“ åŸºç¡€é€ å‹ â†’ ä¸“ä¸šé€ å‹                                                  â”‚
â”‚ âœ“ æ–°å¢ 30åˆ†é’Ÿæ‘„å½±                                                      â”‚
â”‚                                                                         â”‚
â”‚ å•ç‹¬å‡çº§éœ€ Â¥15,000ï¼Œæ‰“åŒ…èŠ‚çœ Â¥5,000                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”§ è‡ªå®šä¹‰å‡çº§
â”œâ”€ ğŸ‘˜ å’Œæœå‡çº§
â”‚     â—‹ å°çº¹ï¼ˆå½“å‰ï¼‰
â”‚     â—‹ æŒ¯è¢– +Â¥5,000
â”‚     â—‹ é«˜çº§æŒ¯è¢– +Â¥10,000
â”œâ”€ ğŸ’„ é€ å‹å‡çº§
â”‚     â—‹ åŸºç¡€é€ å‹ï¼ˆå½“å‰ï¼‰
â”‚     â—‹ ä¸“ä¸šé€ å‹ +Â¥2,000
```

**æ··åˆæ¨¡å¼ä¼˜åŠ¿**ï¼š
- ã€Œæ¨èå‡çº§åŒ…ã€ç®€åŒ–å†³ç­–ï¼Œæ‰“åŒ…æŠ˜æ‰£å¢åŠ å¸å¼•åŠ›
- ã€Œè‡ªå®šä¹‰å‡çº§ã€ä¿ç•™çµæ´»æ€§ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–éœ€æ±‚

### å‡çº§å‘ç”Ÿæ—¶æœº

| æ—¶æœº | å®ç° |
|-----|------|
| **å¥—é¤è¯¦æƒ…é¡µ** | âœ… æ˜¾ç¤ºå‡çº§é€‰é¡¹ï¼Œç”¨æˆ·å†³ç­–å‰ä¿¡æ¯å……åˆ† |
| **ç»“ç®—é¡µé¢** | âœ… å†æ¬¡æé†’ï¼Œæœ€åä¸€æ¬¡è¿½åŠ é”€å”®æœºä¼š |

### å‡çº§é…ç½®æ¨¡å¼ï¼šæ··åˆæ¨¡å¼

- **å¹³å°é¢„è®¾**ï¼šæŒ‰ä¸»é¢˜æä¾›é»˜è®¤å‡çº§è·¯å¾„ï¼ˆå¦‚ã€ŒæŒ¯è¢–ä¸»é¢˜ã€çš„æ ‡å‡†å‡çº§ç»„åˆï¼‰
- **å•†æˆ·è‡ªå®šä¹‰**ï¼šå•†æˆ·å¯è°ƒæ•´å‡çº§é€‰é¡¹å’Œä»·æ ¼

```
å¹³å°é¢„è®¾çš„æŒ¯è¢–ä¸»é¢˜å‡çº§è·¯å¾„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘˜ å’Œæœå‡çº§è·¯å¾„ï¼ˆå¹³å°é¢„è®¾ï¼‰                                            â”‚
â”‚  å°çº¹ â†’ æŒ¯è¢– (+Â¥5,000) â†’ é«˜çº§æŒ¯è¢– (+Â¥10,000) â†’ é¡¶çº§æ‰‹å·¥æŒ¯è¢– (+Â¥30,000) â”‚
â”‚                                                                        â”‚
â”‚  ğŸ’„ é€ å‹å‡çº§è·¯å¾„ï¼ˆå¹³å°é¢„è®¾ï¼‰                                            â”‚
â”‚  åŸºç¡€é€ å‹ â†’ ä¸“ä¸šé€ å‹ (+Â¥2,000) â†’ æ˜æ˜Ÿé€ å‹å¸ˆ (+Â¥8,000)                  â”‚
â”‚                                                                        â”‚
â”‚  ğŸ“¸ æ‘„å½±å‡çº§è·¯å¾„ï¼ˆå¹³å°é¢„è®¾ï¼‰                                            â”‚
â”‚  æ—  â†’ 30åˆ†é’Ÿ (+Â¥8,000) â†’ 60åˆ†é’Ÿ (+Â¥15,000) â†’ åŠæ—¥è·Ÿæ‹ (+Â¥30,000)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å•†æˆ·å¯ä»¥ï¼š
âœ“ ä½¿ç”¨å¹³å°é¢„è®¾ï¼ˆçœäº‹ï¼‰
âœ“ è°ƒæ•´å‡çº§å·®ä»·ï¼ˆå¦‚æŒ¯è¢– +Â¥4,500 è€Œé Â¥5,000ï¼‰
âœ“ æ·»åŠ è‡ªå®šä¹‰å‡çº§é€‰é¡¹ï¼ˆå¦‚ã€Œå•†æˆ·ç‹¬å®¶é‡‘çº¿åˆºç»£ã€ï¼‰
âœ“ ç¦ç”¨æŸäº›å‡çº§é€‰é¡¹
```

---

## æ•°æ®æ¨¡å‹è®¾è®¡ï¼ˆv9 å¹³å°ç»Ÿä¸€ç®¡ç†ï¼‰

### ServiceComponentï¼ˆå¹³å°ç»„ä»¶ - ç»Ÿä¸€ç®¡ç†ï¼‰

```prisma
model ServiceComponent {
  id              String          @id @default(cuid())
  code            String          @unique  // å…¨å±€å”¯ä¸€

  // åŸºæœ¬ä¿¡æ¯ï¼ˆå¹³å°ç»Ÿä¸€ç®¡ç†ï¼Œå•†æˆ·ä¸å¯ä¿®æ”¹ï¼‰
  name            String
  nameJa          String?         @map("name_ja")
  nameEn          String?         @map("name_en")
  description     String?         @db.Text

  // ========== ç»„ä»¶ç±»å‹ ==========
  type            ComponentType   // OUTFIT | ADDON

  // ========== å±•ç¤ºä¿¡æ¯ ==========
  icon            String?         // Emoji å›¾æ ‡
  imageUrl        String?         @map("image_url")  // å¡ç‰‡å›¾ç‰‡

  // ========== å‡çº§å±‚çº§ ==========
  tier            Int             @default(0)
  tierLabel       String?         @map("tier_label")

  // ========== å®šä»·ä¿¡æ¯ ==========
  basePrice       Int             @default(0) @map("base_price")  // å¹³å°å»ºè®®ä»·

  // å…ƒæ•°æ®
  displayOrder    Int             @default(0) @map("display_order")
  isActive        Boolean         @default(true) @map("is_active")
  createdAt       DateTime        @default(now()) @map("created_at")
  updatedAt       DateTime        @updatedAt @map("updated_at")

  // å…³è”
  planComponents       PlanComponent[]
  merchantPrices       MerchantComponentPrice[]  // å•†æˆ·å®šä»·
  themeComponents      ThemeComponent[]          // ä¸»é¢˜å…³è”
  mapHotspots          MapHotspot[]

  // å‡çº§å…³è”
  upgradesFrom      ComponentUpgrade[] @relation("UpgradeFrom")
  upgradesTo        ComponentUpgrade[] @relation("UpgradeTo")

  @@index([type, isActive])
  @@index([tier])
  @@map("service_components")
}

enum ComponentType {
  OUTFIT    // ç€è£…é¡¹ (éœ€è¦çƒ­å›¾å®šä½)
  ADDON     // å¢å€¼æœåŠ¡ (ä¸éœ€è¦çƒ­å›¾å®šä½)
}
```

### ThemeComponentï¼ˆä¸»é¢˜-ç»„ä»¶å…³è”ï¼‰ã€æ–°å¢ã€‘

```prisma
// ä¸»é¢˜ä¸ç»„ä»¶çš„å…³è”ï¼Œç”¨äºæŒ‰ä¸»é¢˜æ¨èç»„ä»¶
model ThemeComponent {
  id            String   @id @default(cuid())

  // ä¸»é¢˜
  themeId       String   @map("theme_id")
  theme         Theme    @relation(fields: [themeId], references: [id], onDelete: Cascade)

  // ç»„ä»¶
  componentId   String   @map("component_id")
  component     ServiceComponent @relation(fields: [componentId], references: [id], onDelete: Cascade)

  // ========== æ¨èé…ç½® ==========
  isRequired    Boolean  @default(false) @map("is_required")   // å¿…é€‰ç»„ä»¶
  isRecommended Boolean  @default(true)  @map("is_recommended") // æ¨èç»„ä»¶
  displayOrder  Int      @default(0) @map("display_order")

  createdAt     DateTime @default(now()) @map("created_at")

  @@unique([themeId, componentId])
  @@index([themeId])
  @@map("theme_components")
}
```

### MerchantComponentPriceï¼ˆå•†æˆ·å®šä»·ï¼‰ã€æ–°å¢ã€‘

```prisma
// å•†æˆ·å¯¹å¹³å°ç»„ä»¶çš„å®šä»·ï¼ˆå•†æˆ·çº§åˆ«ï¼Œæ‰€æœ‰å¥—é¤é€šç”¨ï¼‰
model MerchantComponentPrice {
  id            String   @id @default(cuid())

  // å•†æˆ·
  merchantId    String   @map("merchant_id")
  merchant      Merchant @relation(fields: [merchantId], references: [id], onDelete: Cascade)

  // å¹³å°ç»„ä»¶
  componentId   String   @map("component_id")
  component     ServiceComponent @relation(fields: [componentId], references: [id], onDelete: Cascade)

  // ========== å•†æˆ·å®šä»· ==========
  price         Int      // å•†æˆ·è®¾å®šçš„ä»·æ ¼ï¼ˆå¿…å¡«ï¼‰

  // ========== å¯ç”¨çŠ¶æ€ ==========
  isEnabled     Boolean  @default(true) @map("is_enabled")

  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@unique([merchantId, componentId])
  @@index([merchantId])
  @@map("merchant_component_prices")
}
```

### v9 è®¾è®¡è¯´æ˜

**æ ¸å¿ƒå˜åŒ–ï¼š**

1. **ç»„ä»¶ç”±å¹³å°ç»Ÿä¸€ç®¡ç†**
   - å•†æˆ·ä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶
   - åç§°ã€å›¾æ ‡ã€æè¿°ç­‰ç”±å¹³å°æ§åˆ¶
   - ä¿è¯ç”¨æˆ·ä½“éªŒä¸€è‡´æ€§

2. **å•†æˆ·åªæ§åˆ¶ä»·æ ¼**
   - `MerchantComponentPrice` å­˜å‚¨å•†æˆ·å®šä»·
   - å•†æˆ·çº§åˆ«ï¼ˆè®¾ä¸€æ¬¡ï¼Œæ‰€æœ‰å¥—é¤é€šç”¨ï¼‰
   - å¯ç¦ç”¨ä¸æƒ³æä¾›çš„ç»„ä»¶

3. **ä¸»é¢˜å…³è”ç»„ä»¶**
   - `ThemeComponent` å…³è”ä¸»é¢˜å’Œç»„ä»¶
   - å•†æˆ·é€‰æ‹©ä¸»é¢˜åï¼Œè·å¾—æ¨èç»„ä»¶åˆ—è¡¨
   - å‡å°‘é€‰æ‹©å›°éš¾

**ä»·æ ¼è§£æé€»è¾‘ï¼š**

```typescript
// è·å–ç»„ä»¶ä»·æ ¼
async function getComponentPrice(
  componentId: string,
  merchantId: string
): Promise<number> {
  // æŸ¥æ‰¾å•†æˆ·å®šä»·
  const merchantPrice = await prisma.merchantComponentPrice.findUnique({
    where: { merchantId_componentId: { merchantId, componentId } }
  });

  // æœ‰å•†æˆ·å®šä»·åˆ™ä½¿ç”¨ï¼Œå¦åˆ™ä½¿ç”¨å¹³å°å»ºè®®ä»·
  if (merchantPrice) {
    return merchantPrice.price;
  }

  const component = await prisma.serviceComponent.findUnique({
    where: { id: componentId }
  });

  return component?.basePrice ?? 0;
}
```

### RentalPlan æ›´æ–°

```prisma
model RentalPlan {
  // ... ç°æœ‰å­—æ®µ ...

  // ========== çƒ­ç‚¹å›¾é…ç½®ï¼ˆå¯é€‰ï¼‰==========
  // å•†æˆ·è‡ªå®šä¹‰çƒ­ç‚¹å›¾ç‰‡
  hotmapImageUrl     String?      @map("hotmap_image_url")

  // é€‰æ‹©çš„å¹³å°æ¨¡æ¿
  hotmapTemplateId   String?      @map("hotmap_template_id")
  hotmapTemplate     MapTemplate? @relation(fields: [hotmapTemplateId], references: [id])

  // éƒ½ä¸ºç©º = ä¸æ˜¾ç¤ºçƒ­ç‚¹å›¾ï¼Œå¥—é¤è¯¦æƒ…åªå±•ç¤ºæœåŠ¡ç»„ä»¶åˆ—è¡¨
}
```

### PlanComponent æ›´æ–°

```prisma
model PlanComponent {
  // ... ç°æœ‰å­—æ®µ ...

  // ========== çƒ­ç‚¹å›¾é…ç½® ==========
  // çƒ­ç‚¹ä½ç½®ï¼ˆç™¾åˆ†æ¯”åæ ‡ 0-1ï¼Œnull = ä¸æ˜¾ç¤ºåœ¨å›¾ä¸Šï¼‰
  hotmapX              Float?   @map("hotmap_x")
  hotmapY              Float?   @map("hotmap_y")

  // æ ‡ç­¾æ˜¾ç¤ºæ–¹å‘
  hotmapLabelPosition  String   @default("right") @map("hotmap_label_position")

  // çƒ­ç‚¹æ˜¾ç¤ºé¡ºåºï¼ˆç”¨äºåŠ¨ç”»ã€å±‚çº§ï¼‰
  hotmapOrder          Int      @default(0) @map("hotmap_order")

  updatedAt            DateTime @updatedAt @map("updated_at")
}
```

### ComponentUpgradeï¼ˆç»Ÿä¸€å‡çº§é…ç½®è¡¨ï¼‰

```prisma
// ç»Ÿä¸€çš„ç»„ä»¶å‡çº§é…ç½®
// æ”¯æŒä¸¤ç§ scopeï¼šPLATFORMï¼ˆå¹³å°é¢„è®¾ï¼‰å’Œ MERCHANTï¼ˆå•†æˆ·è‡ªå®šä¹‰ï¼‰
model ComponentUpgrade {
  id                String   @id @default(cuid())

  // å‡çº§æ¥æºç»„ä»¶
  fromComponentId   String   @map("from_component_id")
  fromComponent     ServiceComponent @relation("UpgradeFrom", fields: [fromComponentId], references: [id])

  // å‡çº§ç›®æ ‡ç»„ä»¶
  toComponentId     String   @map("to_component_id")
  toComponent       ServiceComponent @relation("UpgradeTo", fields: [toComponentId], references: [id])

  // å‡çº§å·®ä»·
  priceDiff         Int      @map("price_diff")

  // ========== ä½œç”¨åŸŸ ==========
  scope             UpgradeScope  // PLATFORM | MERCHANT

  // ä½œç”¨åŸŸ IDï¼š
  // - PLATFORM: themeIdï¼ˆæŒ‰ä¸»é¢˜ï¼‰æˆ– nullï¼ˆå…¨å±€ï¼‰
  // - MERCHANT: merchantId
  scopeId           String?   @map("scope_id")

  // ========== å±•ç¤ºä¿¡æ¯ ==========
  label             String?   // "å‡çº§ä¸ºæŒ¯è¢–"
  description       String?   // "æ›´åä¸½çš„æ­£è£…ä½“éªŒ"
  isRecommended     Boolean   @default(false) @map("is_recommended")
  displayOrder      Int       @default(0) @map("display_order")
  isActive          Boolean   @default(true) @map("is_active")

  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")

  @@unique([fromComponentId, toComponentId, scope, scopeId])
  @@index([fromComponentId, scope, isActive])
  @@index([scopeId])
  @@map("component_upgrades")
}

enum UpgradeScope {
  PLATFORM   // å¹³å°é¢„è®¾ï¼ˆscopeId = themeId æˆ– nullï¼‰
  MERCHANT   // å•†æˆ·è‡ªå®šä¹‰ï¼ˆscopeId = merchantIdï¼‰
}
```

**æŸ¥è¯¢ä¼˜å…ˆçº§**ï¼šMERCHANT > PLATFORMï¼ˆå•†æˆ·é…ç½®è¦†ç›–å¹³å°é¢„è®¾ï¼‰

```typescript
// è·å–ç»„ä»¶çš„å¯ç”¨å‡çº§é€‰é¡¹
async function getUpgradeOptions(
  fromComponentId: string,
  merchantId: string,
  themeId?: string
) {
  // ä¸€æ¬¡æŸ¥è¯¢ï¼Œè·å–æ‰€æœ‰å¯èƒ½çš„å‡çº§é€‰é¡¹
  const upgrades = await prisma.componentUpgrade.findMany({
    where: {
      fromComponentId,
      isActive: true,
      OR: [
        // å•†æˆ·è‡ªå®šä¹‰ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
        { scope: 'MERCHANT', scopeId: merchantId },
        // å¹³å°é¢„è®¾ - ä¸»é¢˜ç‰¹å®š
        { scope: 'PLATFORM', scopeId: themeId },
        // å¹³å°é¢„è®¾ - å…¨å±€
        { scope: 'PLATFORM', scopeId: null },
      ],
    },
    include: { toComponent: true },
    orderBy: { displayOrder: 'asc' },
  });

  // å»é‡ï¼šåŒä¸€ä¸ª toComponentId åªä¿ç•™æœ€é«˜ä¼˜å…ˆçº§çš„
  // ä¼˜å…ˆçº§ï¼šMERCHANT > PLATFORM(themeId) > PLATFORM(null)
  const priorityMap = new Map<string, typeof upgrades[0]>();

  for (const upgrade of upgrades) {
    const key = upgrade.toComponentId;
    const existing = priorityMap.get(key);

    if (!existing) {
      priorityMap.set(key, upgrade);
      continue;
    }

    // æ¯”è¾ƒä¼˜å…ˆçº§
    const getPriority = (u: typeof upgrade) => {
      if (u.scope === 'MERCHANT') return 3;
      if (u.scope === 'PLATFORM' && u.scopeId === themeId) return 2;
      return 1; // PLATFORM global
    };

    if (getPriority(upgrade) > getPriority(existing)) {
      priorityMap.set(key, upgrade);
    }
  }

  return Array.from(priorityMap.values())
    .sort((a, b) => a.displayOrder - b.displayOrder);
}
```

### PlanUpgradeBundleï¼ˆå¥—é¤å‡çº§åŒ…ï¼‰

```prisma
// å¥—é¤çš„ã€Œä¸€é”®å‡çº§ã€æ‰“åŒ…æ–¹æ¡ˆ
model PlanUpgradeBundle {
  id              String   @id @default(cuid())

  // æ‰€å±å¥—é¤
  planId          String   @map("plan_id")
  plan            RentalPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  // å±•ç¤ºä¿¡æ¯
  label           String   // "è±ªåå‡çº§åŒ…"
  description     String?  // "ä¸€é”®å‡çº§ä¸ºè±ªåä½“éªŒ"

  // å‡çº§å†…å®¹ï¼ˆç»„ä»¶æ›¿æ¢æ¸…å•ï¼‰
  // JSON: [{ "fromComponentId": "xxx", "toComponentId": "yyy" }, { "addComponentId": "zzz" }]
  upgradeItems    Json     @map("upgrade_items")

  // æ‰“åŒ…ä»·æ ¼
  bundlePrice     Int      @map("bundle_price")      // æ‰“åŒ…å‡çº§ä»·
  originalPrice   Int      @map("original_price")    // å•ç‹¬å‡çº§æ€»ä»·ï¼ˆç”¨äºæ˜¾ç¤ºã€ŒèŠ‚çœ X å…ƒã€ï¼‰

  // å±•ç¤ºé…ç½®
  isRecommended   Boolean  @default(true) @map("is_recommended")
  displayOrder    Int      @default(0) @map("display_order")
  isActive        Boolean  @default(true) @map("is_active")

  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  @@index([planId, isActive])
  @@map("plan_upgrade_bundles")
}
```

---

## ç»„ä»¶å¯è§æ€§è§„åˆ™ï¼ˆv9 å¹³å°ç»Ÿä¸€ç®¡ç†ï¼‰

### è·å–å¹³å°ç»„ä»¶åº“

```typescript
// æ‰€æœ‰å¹³å°ç»„ä»¶ï¼ˆå•†æˆ·ç¼–è¾‘å¥—é¤æ—¶é€‰æ‹©ï¼‰
async function getAllComponents() {
  return prisma.serviceComponent.findMany({
    where: { isActive: true },
    orderBy: [
      { type: 'asc' },
      { displayOrder: 'asc' },
    ]
  });
}
```

### æŒ‰ä¸»é¢˜è·å–æ¨èç»„ä»¶

```typescript
// å•†æˆ·é€‰æ‹©ä¸»é¢˜åï¼Œè·å–è¯¥ä¸»é¢˜çš„æ¨èç»„ä»¶
async function getThemeComponents(themeId: string) {
  return prisma.themeComponent.findMany({
    where: { themeId },
    include: { component: true },
    orderBy: [
      { isRequired: 'desc' },      // å¿…é€‰ç»„ä»¶ä¼˜å…ˆ
      { isRecommended: 'desc' },   // æ¨èç»„ä»¶æ¬¡ä¹‹
      { displayOrder: 'asc' },
    ]
  });
}
```

### è·å–å•†æˆ·å®šä»·

```typescript
// è·å–å•†æˆ·å¯¹ç»„ä»¶çš„å®šä»·é…ç½®
async function getMerchantPrices(merchantId: string) {
  return prisma.merchantComponentPrice.findMany({
    where: { merchantId },
    include: { component: true },
  });
}

// è·å–ç»„ä»¶çš„æœ‰æ•ˆä»·æ ¼ï¼ˆå•†æˆ·ä»· > å¹³å°å»ºè®®ä»·ï¼‰
async function getEffectivePrice(
  componentId: string,
  merchantId: string
): Promise<number> {
  const merchantPrice = await prisma.merchantComponentPrice.findUnique({
    where: { merchantId_componentId: { merchantId, componentId } }
  });

  if (merchantPrice) {
    return merchantPrice.price;
  }

  const component = await prisma.serviceComponent.findUnique({
    where: { id: componentId }
  });

  return component?.basePrice ?? 0;
}
```

### è®¾ç½®å•†æˆ·ä»·æ ¼ï¼ˆé¦–æ¬¡ä½¿ç”¨æ—¶ï¼‰

```typescript
// å•†æˆ·é¦–æ¬¡ä½¿ç”¨ç»„ä»¶æ—¶è®¾ç½®ä»·æ ¼
async function setMerchantPrice(
  merchantId: string,
  componentId: string,
  price: number
) {
  return prisma.merchantComponentPrice.upsert({
    where: { merchantId_componentId: { merchantId, componentId } },
    create: {
      merchantId,
      componentId,
      price,
      isEnabled: true,
    },
    update: {
      price,
    }
  });
}
```

---

## çƒ­ç‚¹å›¾å›¾ç‰‡æ¥æº

### ç®€åŒ–é€»è¾‘ï¼ˆåªæœ‰ä¸¤ç§é€‰æ‹©ï¼‰

```typescript
async function getHotmapImage(plan: RentalPlan): Promise<string | null> {
  // 1. å•†æˆ·è‡ªå®šä¹‰å›¾ç‰‡
  if (plan.hotmapImageUrl) {
    return plan.hotmapImageUrl;
  }

  // 2. å•†æˆ·é€‰æ‹©çš„å¹³å°æ¨¡æ¿
  if (plan.hotmapTemplateId) {
    const template = await prisma.mapTemplate.findUnique({
      where: { id: plan.hotmapTemplateId }
    });
    return template?.imageUrl ?? null;
  }

  // éƒ½ä¸ºç©º = ä¸æ˜¾ç¤ºçƒ­ç‚¹å›¾
  return null;
}
```

### UI å¼•å¯¼ï¼ˆå•†æˆ·ç¼–è¾‘å™¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çƒ­ç‚¹å›¾è®¾ç½® (å¯é€‰)                                            [è·³è¿‡]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ğŸ“¸ ä¸Šä¼ æ‚¨çš„å’Œæœå±•ç¤ºå›¾                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚     [ç‚¹å‡»ä¸Šä¼ ] æˆ– æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚     å»ºè®®æ¯”ä¾‹ 2:3ï¼Œå±•ç¤ºå’Œæœæ•´ä½“æ•ˆæœ                                â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æˆ–è€… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
â”‚                                                                         â”‚
â”‚  ğŸ“‹ ä½¿ç”¨å¹³å°æ¨¡æ¿                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ å¥³å£«æŒ¯è¢– â”‚ â”‚ å¥³å£«è®¿é—®â”‚ â”‚ ç”·å£«ç¾½ç»‡â”‚ â”‚  æƒ…ä¾£   â”‚                      â”‚
â”‚  â”‚  [é€‰æ‹©]  â”‚ â”‚  [é€‰æ‹©] â”‚ â”‚  [é€‰æ‹©] â”‚ â”‚ [é€‰æ‹©]  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                         â”‚
â”‚  â“˜ è·³è¿‡æ­¤æ­¥éª¤ï¼Œå¥—é¤è¯¦æƒ…é¡µå°†åªå±•ç¤ºæœåŠ¡ç»„ä»¶åˆ—è¡¨                          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¥—é¤è¯¦æƒ…é¡µ UI

### æœ‰çƒ­ç‚¹å›¾æ—¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è±ªåæŒ¯è¢–ä½“éªŒ                                              Â¥19,800     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚                                     â”‚                               â”‚
â”‚  â”‚    [çƒ­ç‚¹å›¾å±•ç¤ºåŒºåŸŸ]                  â”‚                               â”‚
â”‚  â”‚                                     â”‚                               â”‚
â”‚  â”‚    â—â”€â”€æŒ¯è¢–å’Œæœ                      â”‚                               â”‚
â”‚  â”‚           â—â”€â”€ç‰¹åˆ¶å‘é¥°               â”‚                               â”‚
â”‚  â”‚                  â—â”€â”€å¸¯              â”‚                               â”‚
â”‚  â”‚                                     â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                         â”‚
â”‚  å¥—é¤åŒ…å«                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘˜ æŒ¯è¢–å’Œæœ      ğŸ€ å¸¯ãƒ»å¸¯ç· ã‚      âœ¨ ç‰¹åˆ¶é‡‘ç®”å‘é¥°              â”‚   â”‚
â”‚  â”‚ ğŸ’„ å‘å‹è®¾è®¡      ğŸ‘  è‰å±¥ãƒ»è¶³è¢‹                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ— çƒ­ç‚¹å›¾æ—¶ï¼ˆåªå±•ç¤ºæœåŠ¡ç»„ä»¶åˆ—è¡¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸºç¡€æŒ¯è¢–ä½“éªŒ                                              Â¥9,800      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚                                     â”‚                               â”‚
â”‚  â”‚    [å¥—é¤å°é¢å›¾/å•†å“å›¾]               â”‚                               â”‚
â”‚  â”‚                                     â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                         â”‚
â”‚  å¥—é¤åŒ…å«                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸ‘˜ å’Œæœ                                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ æŒ¯è¢–å’Œæœ                                                     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸ€ é…é¥°                                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ å¸¯ãƒ»å¸¯ç· ã‚                                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ è‰å±¥ãƒ»è¶³è¢‹                                                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸ’„ é€ å‹                                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ å‘å‹è®¾è®¡                                                     â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»„ä»¶æ¸²æŸ“é€»è¾‘

```typescript
function PlanDetailPage({ plan }: { plan: RentalPlanWithComponents }) {
  const hotmapImage = await getHotmapImage(plan);
  const components = plan.planComponents.filter(pc => pc.isIncluded);

  return (
    <div>
      {/* çƒ­ç‚¹å›¾ æˆ– å°é¢å›¾ */}
      {hotmapImage ? (
        <HotmapViewer
          imageUrl={hotmapImage}
          hotspots={components.filter(c => c.hotmapX !== null)}
        />
      ) : (
        <Image src={plan.imageUrl} alt={plan.name} />
      )}

      {/* æœåŠ¡ç»„ä»¶åˆ—è¡¨ï¼ˆå§‹ç»ˆå±•ç¤ºï¼‰ */}
      <ServiceComponentList components={components} />
    </div>
  );
}

function ServiceComponentList({ components }: Props) {
  // æŒ‰ç±»å‹åˆ†ç»„
  const grouped = groupBy(components, c => c.component.type);

  return (
    <div className="å¥—é¤åŒ…å«">
      <h3>å¥—é¤åŒ…å«</h3>
      {Object.entries(grouped).map(([type, items]) => (
        <div key={type}>
          <span>{getTypeIcon(type)} {getTypeLabel(type)}</span>
          <ul>
            {items.map(item => (
              <li key={item.id}>
                {item.component.icon} {item.nameOverride || item.component.name}
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  );
}
```

---

## æœåŠ¡å‡çº§ UI

### å¥—é¤è¯¦æƒ…é¡µå‡çº§åŒºåŸŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸºç¡€æŒ¯è¢–ä½“éªŒ                                              Â¥9,800      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  [å¥—é¤å›¾ç‰‡/çƒ­ç‚¹å›¾]                                                      â”‚
â”‚                                                                         â”‚
â”‚  å¥—é¤åŒ…å«                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘˜ å°çº¹å’Œæœ      ğŸ€ å¸¯ãƒ»å¸¯ç· ã‚      ğŸ’„ åŸºç¡€é€ å‹                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                         â”‚
â”‚  ğŸ’ æ¨èå‡çº§                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸŒŸ è±ªåä½“éªŒå‡çº§åŒ…                            [ä¸€é”®å‡çº§ +Â¥10,000] â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ âœ“ å°çº¹ â†’ æŒ¯è¢–å’Œæœ                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ âœ“ åŸºç¡€é€ å‹ â†’ ä¸“ä¸šé€ å‹                                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ âœ“ æ–°å¢ 30åˆ†é’Ÿä¸“ä¸šæ‘„å½±                                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ’° å•ç‹¬å‡çº§éœ€ Â¥15,000ï¼Œæ‰“åŒ…èŠ‚çœ Â¥5,000                     â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  ğŸ”§ è‡ªå®šä¹‰å‡çº§                                           [å±•å¼€/æ”¶èµ·]   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸ‘˜ å’Œæœ                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ å°çº¹å’Œæœï¼ˆå½“å‰ï¼‰                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ æŒ¯è¢–å’Œæœ                                    +Â¥5,000     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ é«˜çº§æŒ¯è¢–ï¼ˆæ‰‹å·¥åˆºç»£ï¼‰                        +Â¥10,000    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ é¡¶çº§æ‰‹å·¥æŒ¯è¢–                                +Â¥30,000    â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸ’„ é€ å‹                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ åŸºç¡€é€ å‹ï¼ˆå½“å‰ï¼‰                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ ä¸“ä¸šé€ å‹ï¼ˆå«å‘é¥°ï¼‰                          +Â¥2,000     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â—‹ æ˜æ˜Ÿé€ å‹å¸ˆ                                  +Â¥8,000     â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ğŸ“¸ æ‘„å½±ï¼ˆå¯é€‰æ·»åŠ ï¼‰                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  â˜ 30åˆ†é’Ÿä¸“ä¸šæ‘„å½±                              +Â¥8,000     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â˜ 60åˆ†é’Ÿä¸“ä¸šæ‘„å½±                              +Â¥15,000    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â˜ åŠæ—¥è·Ÿæ‹                                    +Â¥30,000    â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                         â”‚
â”‚  å½“å‰ä»·æ ¼ï¼šÂ¥9,800 + å‡çº§ Â¥7,000 = Â¥16,800                              â”‚
â”‚                                                                         â”‚
â”‚                                              [åŠ å…¥è´­ç‰©è½¦]  [ç«‹å³é¢„è®¢]   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»“ç®—é¡µé¢å‡çº§æé†’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¡®è®¤è®¢å•                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ğŸ“¦ è®¢å•å†…å®¹                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  åŸºç¡€æŒ¯è¢–ä½“éªŒ                                          Â¥9,800   â”‚   â”‚
â”‚  â”‚  â””â”€ å‡çº§ï¼šæŒ¯è¢–å’Œæœ                                    +Â¥5,000   â”‚   â”‚
â”‚  â”‚  â””â”€ å‡çº§ï¼šä¸“ä¸šé€ å‹                                    +Â¥2,000   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  ğŸ’¡ è¿˜å¯ä»¥å‡çº§                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“¸ æ·»åŠ  30åˆ†é’Ÿä¸“ä¸šæ‘„å½±                   +Â¥8,000   [æ·»åŠ ]      â”‚   â”‚
â”‚  â”‚     è®°å½•æ‚¨çš„å’Œæœä½“éªŒï¼Œä¸“ä¸šæ‘„å½±å¸ˆå…¨ç¨‹è·Ÿæ‹                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  å•†å“å°è®¡ï¼šÂ¥16,800                                                      â”‚
â”‚  æœåŠ¡è´¹ï¼šÂ¥0                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åˆè®¡ï¼šÂ¥16,800                                                          â”‚
â”‚                                                                         â”‚
â”‚                                                    [ç¡®è®¤æ”¯ä»˜]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è´­ç‰©è½¦ä¸­çš„å‡çº§å±•ç¤º

```typescript
// CartItem ç»“æ„
interface CartItem {
  type: 'PLAN';
  planId: string;
  name: string;
  basePrice: number;          // åŸºç¡€å¥—é¤ä»·æ ¼

  // å‡çº§é…ç½®
  upgrades: {
    planComponentId: string;  // åŸç»„ä»¶
    targetComponentId: string; // å‡çº§ç›®æ ‡
    priceDiff: number;        // å‡çº§å·®ä»·
    label: string;            // "æŒ¯è¢–å’Œæœ"
  }[];

  // æ–°å¢ç»„ä»¶ï¼ˆå¦‚æ‘„å½±ï¼‰
  addons: {
    componentId: string;
    price: number;
    label: string;
  }[];

  // è®¡ç®—å±æ€§
  totalPrice: number;  // basePrice + sum(upgrades) + sum(addons)
}
```

### å‡çº§é€‰æ‹©é€»è¾‘

å‡çº§æŸ¥è¯¢é€»è¾‘å·²åœ¨ `ComponentUpgrade` æ¨¡å‹å®šä¹‰å¤„è¯´æ˜ã€‚

```typescript
// è·å–å¥—é¤çš„æ¨èå‡çº§åŒ…
async function getUpgradeBundles(planId: string) {
  return prisma.planUpgradeBundle.findMany({
    where: {
      planId,
      isActive: true,
    },
    orderBy: [
      { isRecommended: 'desc' },
      { displayOrder: 'asc' },
    ],
  });
}
```

---

## å•†æˆ·å‡çº§é…ç½® UI

### å¥—é¤ç¼–è¾‘å™¨ä¸­çš„å‡çº§é…ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¥—é¤å†…å®¹ç¼–è¾‘å™¨                                            [ä¿å­˜] [é¢„è§ˆ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ğŸ‘˜ å’Œæœ                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å½“å‰é…ç½®ï¼šå°çº¹å’Œæœ                                              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  å‡çº§é€‰é¡¹ï¼š                                      [+ æ·»åŠ å‡çº§é€‰é¡¹] â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ â˜‘ ä½¿ç”¨å¹³å°é¢„è®¾                                              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   Â· æŒ¯è¢–å’Œæœ      å¹³å°å»ºè®® +Â¥5,000    [è‡ªå®šä¹‰ä»·æ ¼: Â¥    ]   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   Â· é«˜çº§æŒ¯è¢–      å¹³å°å»ºè®® +Â¥10,000   [è‡ªå®šä¹‰ä»·æ ¼: Â¥    ]   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   Â· é¡¶çº§æ‰‹å·¥æŒ¯è¢–  å¹³å°å»ºè®® +Â¥30,000   [è‡ªå®šä¹‰ä»·æ ¼: Â¥    ]   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ å•†æˆ·è‡ªå®šä¹‰å‡çº§                                              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   Â· å•†æˆ·ç‹¬å®¶é‡‘çº¿åˆºç»£æŒ¯è¢–  +Â¥25,000              [Ã—åˆ é™¤]    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   [+ æ·»åŠ è‡ªå®šä¹‰å‡çº§]                                        â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  ğŸ“¸ æ‘„å½±ï¼ˆå¯æ·»åŠ é¡¹ï¼‰                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å½“å‰é…ç½®ï¼šä¸åŒ…å«æ‘„å½±                                            â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  å¯é€‰æ·»åŠ ï¼š                                                      â”‚   â”‚
â”‚  â”‚  â˜‘ 30åˆ†é’Ÿä¸“ä¸šæ‘„å½±    å¹³å°å»ºè®® +Â¥8,000    [è‡ªå®šä¹‰ä»·æ ¼: Â¥8,000 ]  â”‚   â”‚
â”‚  â”‚  â˜‘ 60åˆ†é’Ÿä¸“ä¸šæ‘„å½±    å¹³å°å»ºè®® +Â¥15,000   [è‡ªå®šä¹‰ä»·æ ¼: Â¥15,000]  â”‚   â”‚
â”‚  â”‚  â˜ åŠæ—¥è·Ÿæ‹          å¹³å°å»ºè®® +Â¥30,000   [ç¦ç”¨æ­¤é€‰é¡¹]           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                         â”‚
â”‚  ğŸ’ å‡çº§åŒ…é…ç½®                                          [+ æ·»åŠ å‡çº§åŒ…] â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸŒŸ è±ªåä½“éªŒå‡çº§åŒ…                                   [ç¼–è¾‘] [Ã—] â”‚   â”‚
â”‚  â”‚  åŒ…å«ï¼šæŒ¯è¢– + ä¸“ä¸šé€ å‹ + 30åˆ†é’Ÿæ‘„å½±                             â”‚   â”‚
â”‚  â”‚  æ‰“åŒ…ä»·ï¼šÂ¥10,000ï¼ˆåŸä»· Â¥15,000ï¼ŒèŠ‚çœ Â¥5,000ï¼‰                   â”‚   â”‚
â”‚  â”‚  â˜‘ è®¾ä¸ºæ¨è                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å•†æˆ·å®šä»·ç®¡ç†é¡µé¢ (/merchant/pricing)

å•†æˆ·å¯ä»¥åœ¨æ­¤é¡µé¢ç»Ÿä¸€ç®¡ç†ç»„ä»¶å®šä»·ï¼Œé€‚ç”¨äºæ‰€æœ‰å¥—é¤ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡å®šä»·ç®¡ç†                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ğŸ’¡ åœ¨æ­¤è®¾ç½®çš„ä»·æ ¼é€‚ç”¨äºæ‚¨çš„æ‰€æœ‰å¥—é¤                                    â”‚
â”‚                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                         â”‚
â”‚  ğŸ‘˜ ç€è£…é¡¹ (OUTFIT)                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚  â”‚ ç»„ä»¶      â”‚ å¹³å°å»ºè®®ä»·    â”‚ æˆ‘çš„å®šä»·    â”‚ çŠ¶æ€    â”‚           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ‘˜ æŒ¯è¢–å’Œæœâ”‚ Â¥5,000       â”‚ [Â¥4,500   ] â”‚ â˜‘ å¯ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ‘˜ è®¿é—®ç€  â”‚ Â¥3,000       â”‚ [Â¥3,000   ] â”‚ â˜‘ å¯ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ€ å¸¯ãƒ»å¸¯ç· â”‚ Â¥1,000       â”‚ [Â¥1,000   ] â”‚ â˜‘ å¯ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ’„ å‘å‹è®¾è®¡â”‚ Â¥500         â”‚ [Â¥600     ] â”‚ â˜‘ å¯ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                         â”‚
â”‚  âœ¨ å¢å€¼æœåŠ¡ (ADDON)                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚  â”‚ æœåŠ¡      â”‚ å¹³å°å»ºè®®ä»·    â”‚ æˆ‘çš„å®šä»·    â”‚ çŠ¶æ€    â”‚           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ“· ä¸“ä¸šè·Ÿæ‹â”‚ Â¥2,000       â”‚ [Â¥1,800   ] â”‚ â˜‘ å¯ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ’ è¡Œæå¯„å­˜â”‚ Â¥300         â”‚ [Â¥300     ] â”‚ â˜‘ å¯ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸš— æ¥é€æœåŠ¡â”‚ Â¥1,500       â”‚ [         ] â”‚ â˜ ç¦ç”¨  â”‚           â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â“˜ ç•™ç©ºå®šä»· = ä½¿ç”¨å¹³å°å»ºè®®ä»·                                     â”‚   â”‚
â”‚  â”‚  â“˜ ç¦ç”¨çš„ç»„ä»¶ä¸ä¼šå‡ºç°åœ¨å¥—é¤ç¼–è¾‘å™¨ä¸­                              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚                                                    [ä¿å­˜æ‰€æœ‰æ›´æ”¹]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**v9 è¯´æ˜**ï¼šå•†æˆ·ä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶ï¼Œåªèƒ½å¯¹å¹³å°æä¾›çš„ç»„ä»¶è®¾ç½®ä»·æ ¼ã€‚
å¦‚éœ€æ–°ç»„ä»¶ï¼Œè¯·è”ç³»å¹³å°ç®¡ç†å‘˜ã€‚

---

## å¥—é¤ç¼–è¾‘å™¨å¸ƒå±€ (v2)

å°†ã€Œç€è£…é¡¹+çƒ­å›¾ã€å’Œã€Œå¢å€¼æœåŠ¡ã€åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹åŒºåŸŸã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¥—é¤å†…å®¹ç¼–è¾‘å™¨                                            [ä¿å­˜] [é¢„è§ˆ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ ç€è£…é¡¹ + çƒ­ç‚¹å›¾ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚                                                                      â”‚
â”‚  â”‚  â”Œâ”€â”€ ç€è£…é¡¹åˆ—è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€ çƒ­ç‚¹å›¾é¢„è§ˆ (3:4) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”‚                        â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ‘˜ ç€è£…é¡¹ (3)         â”‚   â”‚      [å•†æˆ·ä¸Šä¼ çš„å’Œæœå›¾ç‰‡]          â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â˜‘ åŸºç¡€å’Œæœ     â”‚   â”‚   â”‚      â€¢ åŸºç¡€å’Œæœ â”€â”€â—               â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   â— åŒ…å«       â”‚   â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â˜‘ åŸºç¡€è…°å¸¦     â”‚   â”‚   â”‚           â—â”€â”€ åŸºç¡€è…°å¸¦            â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   â— åŒ…å«       â”‚   â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ â˜ é«˜çº§å°ç‰©     â”‚   â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚   â—‹ å¯é€‰ +Â¥500 â”‚   â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚                        â”‚   â”‚                                   â”‚ â”‚
â”‚  â”‚  â”‚  [+ æ·»åŠ ç€è£…é¡¹]        â”‚   â”‚   æ‹–æ‹½è°ƒæ•´ä½ç½® Â· ç‚¹å‡»ç§»é™¤          â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â”‚  ğŸ’¡ å‹¾é€‰ç€è£…é¡¹åè‡ªåŠ¨è¿›å…¥æ”¾ç½®æ¨¡å¼ï¼Œç‚¹å‡»çƒ­å›¾ç¡®å®šä½ç½®                    â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚  â”Œâ”€ å¢å€¼æœåŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚                                                                      â”‚
â”‚  â”‚  âœ¨ å¢å€¼æœåŠ¡ (3)                                  [+ æ·»åŠ å¢å€¼æœåŠ¡]   â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  â”‚ [å›¾ç‰‡]      â”‚ â”‚ [å›¾ç‰‡]      â”‚ â”‚ [å›¾ç‰‡]      â”‚                    â”‚
â”‚  â”‚  â”‚ ğŸ“· ä¸“ä¸šè·Ÿæ‹ â”‚ â”‚ ğŸ’‡ å‘å‹è®¾è®¡ â”‚ â”‚ ğŸ’ è¡Œæå¯„å­˜ â”‚                    â”‚
â”‚  â”‚  â”‚ Â¥1,800     â”‚ â”‚ Â¥500       â”‚ â”‚ Â¥300       â”‚                    â”‚
â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚                    â”‚
â”‚  â”‚  â”‚ â— åŒ…å«      â”‚ â”‚ â—‹ å¯é€‰     â”‚ â”‚ â—‹ å¯é€‰     â”‚                    â”‚
â”‚  â”‚  â”‚     [âœ•]     â”‚ â”‚     [âœ•]     â”‚ â”‚     [âœ•]     â”‚                    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â”‚  ğŸ’¡ ã€ŒåŒ…å«ã€= å·²å«åœ¨å¥—é¤ä»·ä¸­ï¼Œã€Œå¯é€‰ã€= é¡¾å®¢å¯åŠ è´­                    â”‚
â”‚  â”‚  ğŸ’¡ ä»·æ ¼åœ¨ã€Œå¢å€¼æœåŠ¡ç®¡ç†ã€ä¸­ç»Ÿä¸€è®¾ç½®                                  â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ·»åŠ å¢å€¼æœåŠ¡å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ å¢å€¼æœåŠ¡                                                    [âœ•]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ğŸ¢ å¹³å°æœåŠ¡                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚  â”‚ [å›¾ç‰‡]   â”‚ â”‚ [å›¾ç‰‡]   â”‚ â”‚ [å›¾ç‰‡]   â”‚ â”‚ [å›¾ç‰‡]   â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ“· è·Ÿæ‹  â”‚ â”‚ ğŸ’‡ å‘å‹  â”‚ â”‚ ğŸš— æ¥é€  â”‚ â”‚ ğŸ’ å¯„å­˜  â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ Â¥1,800  â”‚ â”‚ Â¥500    â”‚ â”‚ Â¥1,500  â”‚ â”‚ Â¥300    â”‚           â”‚   â”‚
â”‚  â”‚  â”‚ [å·²æ·»åŠ ] â”‚ â”‚ [+ æ·»åŠ ] â”‚ â”‚ [+ æ·»åŠ ] â”‚ â”‚ [å·²æ·»åŠ ] â”‚           â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚   â”‚
â”‚  â”‚  â”‚ [å›¾ç‰‡]   â”‚ â”‚ [å›¾ç‰‡]   â”‚                                      â”‚   â”‚
â”‚  â”‚  â”‚ ğŸµ èŒ¶é“  â”‚ â”‚ ğŸ ç¤¼å“  â”‚                                      â”‚   â”‚
â”‚  â”‚  â”‚ Â¥1,200  â”‚ â”‚ Â¥800    â”‚                                      â”‚   â”‚
â”‚  â”‚  â”‚ [+ æ·»åŠ ] â”‚ â”‚ [+ æ·»åŠ ] â”‚                                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â“˜ ä»·æ ¼æ˜¾ç¤ºä¸ºæ‚¨åœ¨ã€ŒæœåŠ¡å®šä»·ç®¡ç†ã€ä¸­è®¾ç½®çš„ä»·æ ¼                           â”‚
â”‚  â“˜ å¦‚éœ€æ–°ç»„ä»¶ï¼Œè¯·è”ç³»å¹³å°ç®¡ç†å‘˜                                         â”‚
â”‚                                                                         â”‚
â”‚                                                            [å®Œæˆ]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**v9 è¯´æ˜**ï¼šå•†æˆ·åªèƒ½é€‰æ‹©å¹³å°æä¾›çš„ç»„ä»¶ï¼Œä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶ã€‚å¦‚éœ€ç‰¹æ®ŠæœåŠ¡ï¼Œè¯·è”ç³»å¹³å°ç®¡ç†å‘˜ç”³è¯·æ·»åŠ ã€‚

---

## æ—§ç‰ˆç¼–è¾‘å™¨å¸ƒå±€ (v1 - å·²åºŸå¼ƒ)

> **æ³¨æ„**ï¼šæ­¤å¸ƒå±€åœ¨ v9 ä¸­å·²åºŸå¼ƒã€‚v9 ä¸æ”¯æŒ"æˆ‘çš„ç»„ä»¶"åŠŸèƒ½ï¼Œå•†æˆ·åªèƒ½ä½¿ç”¨å¹³å°æä¾›çš„ç»„ä»¶ã€‚
> ä¿ç•™æ­¤å¸ƒå±€ä»…ä¾›å†å²å‚è€ƒï¼Œè¯·å‹¿åœ¨æ–°å¼€å‘ä¸­ä½¿ç”¨ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¥—é¤å†…å®¹ç¼–è¾‘å™¨                                            [ä¿å­˜] [é¢„è§ˆ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç»„ä»¶åº“                â”‚  çƒ­ç‚¹å›¾                                  â”‚  â”‚
â”‚  â”‚                       â”‚                                          â”‚  â”‚
â”‚  â”‚  ğŸ¢ å¹³å°ç»„ä»¶           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ‘˜ å’Œæœ         â”‚  â”‚  â”‚    [å•†æˆ·ä¸Šä¼ çš„å’Œæœå›¾ç‰‡]             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Â· æŒ¯è¢–å’Œæœ     â”‚  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Â· è®¿é—®ç€       â”‚  â”‚  â”‚    â—â”€â”€æŒ¯è¢–å’Œæœ                     â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚           â—â”€â”€ç‰¹åˆ¶å‘é¥°              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ€ é…é¥°         â”‚  â”‚  â”‚                  â—â”€â”€å¸¯             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Â· å¸¯ãƒ»å¸¯ç· ã‚   â”‚  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Â· è‰å±¥ãƒ»è¶³è¢‹   â”‚  â”‚  â”‚    [æ‹–æ‹½ç»„ä»¶åˆ°æ­¤å¤„]                 â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ’„ é€ å‹         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”‚  Â· å‘å‹è®¾è®¡     â”‚  â”‚                                          â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  å·²æ·»åŠ ç»„ä»¶ï¼š                             â”‚  â”‚
â”‚  â”‚                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â­ æˆ‘çš„ç»„ä»¶          â”‚  â”‚ ğŸ“ æ˜¾ç¤ºåœ¨å›¾ä¸Š (3)                   â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  ğŸ‘˜ æŒ¯è¢–å’Œæœ         [éšè—] [åˆ é™¤] â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  âœ¨ ç‰¹åˆ¶é‡‘ç®”å‘é¥°â”‚  â”‚  â”‚  âœ¨ ç‰¹åˆ¶å‘é¥°         [éšè—] [åˆ é™¤] â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  ğŸŒ¸ æ¨±èŠ±å°ç‰©    â”‚  â”‚  â”‚  ğŸ€ å¸¯ãƒ»å¸¯ç· ã‚      [éšè—] [åˆ é™¤] â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ [+ æ·»åŠ æ–°ç»„ä»¶]  â”‚  â”‚  â”‚ ğŸ“¦ æœªæ˜¾ç¤º (1)                       â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  ğŸ’„ å‘å‹è®¾è®¡         [æ˜¾ç¤º] [åˆ é™¤] â”‚  â”‚  â”‚
â”‚  â”‚                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API è®¾è®¡ï¼ˆv9 å¹³å°ç»Ÿä¸€ç®¡ç†ï¼‰

### å¹³å°ç»„ä»¶åº“

#### GET /api/service-components

è·å–æ‰€æœ‰å¹³å°ç»„ä»¶ï¼ˆå•†æˆ·ç¼–è¾‘å¥—é¤æ—¶ä½¿ç”¨ï¼‰

```typescript
// Query params
?type=OUTFIT|ADDON     // å¯é€‰ï¼ŒæŒ‰ç±»å‹è¿‡æ»¤
?themeId=xxx           // å¯é€‰ï¼ŒæŒ‰ä¸»é¢˜ç­›é€‰æ¨èç»„ä»¶

// Response
{
  components: ServiceComponent[],
  categories: {
    type: 'OUTFIT' | 'ADDON',
    label: string,
    icon: string,
    components: ServiceComponent[]
  }[]
}
```

#### GET /api/themes/[id]/components

è·å–æŒ‡å®šä¸»é¢˜çš„æ¨èç»„ä»¶

```typescript
// Response
{
  theme: Theme,
  required: ServiceComponent[],    // å¿…é€‰ç»„ä»¶
  recommended: ServiceComponent[], // æ¨èç»„ä»¶
  optional: ServiceComponent[],    // å¯é€‰ç»„ä»¶
}
```

### å•†æˆ·å®šä»·

#### GET /api/merchant/component-prices

è·å–å•†æˆ·çš„ç»„ä»¶å®šä»·é…ç½®

```typescript
// Response
{
  prices: (MerchantComponentPrice & {
    component: ServiceComponent
  })[],
  // æœªè®¾ç½®å®šä»·çš„ç»„ä»¶ä¼šä½¿ç”¨å¹³å°å»ºè®®ä»·
}
```

#### PUT /api/merchant/component-prices

æ‰¹é‡æ›´æ–°å•†æˆ·å®šä»·

```typescript
// Request
{
  prices: {
    componentId: string,
    price: number,       // å•†æˆ·è®¾å®šä»·æ ¼
    isEnabled: boolean   // æ˜¯å¦å¯ç”¨
  }[]
}

// Response
{
  prices: MerchantComponentPrice[]
}
```

#### POST /api/merchant/component-prices/[componentId]

è®¾ç½®å•ä¸ªç»„ä»¶çš„å•†æˆ·ä»·æ ¼ï¼ˆé¦–æ¬¡ä½¿ç”¨æ—¶ï¼‰

```typescript
// Request
{
  price: number,
  isEnabled?: boolean
}

// Response
{
  price: MerchantComponentPrice
}
```

### ç®¡ç†å‘˜ç›¸å…³

#### POST /api/admin/components

ç®¡ç†å‘˜åˆ›å»ºæ–°ç»„ä»¶

```typescript
// Request
{
  code: string,
  name: string,
  type: 'OUTFIT' | 'ADDON',
  icon?: string,
  imageUrl?: string,
  basePrice: number,
  description?: string
}

// Response
{
  component: ServiceComponent
}
```

#### PATCH /api/admin/components/[id]

ç®¡ç†å‘˜ç¼–è¾‘ç»„ä»¶

#### DELETE /api/admin/components/[id]

ç®¡ç†å‘˜åˆ é™¤ç»„ä»¶

#### POST /api/admin/themes/[id]/components

ç®¡ç†å‘˜é…ç½®ä¸»é¢˜ç»„ä»¶å…³è”

```typescript
// Request
{
  components: {
    componentId: string,
    isRequired: boolean,
    isRecommended: boolean,
    displayOrder: number
  }[]
}

// Response
{
  themeComponents: ThemeComponent[]
}
```

---

## MapHotspot çš„è§’è‰²

### ä¿ç•™åŸå› 

å½“å•†æˆ·é€‰æ‹©ä½¿ç”¨å¹³å°æ¨¡æ¿æ—¶ï¼Œ`MapHotspot` æä¾›ã€Œæ¨èä½ç½®ã€å‚è€ƒã€‚

### é€‚ç”¨åœºæ™¯

| çƒ­ç‚¹å›¾æ¥æº | MapHotspot ä½œç”¨ |
|-----------|----------------|
| å•†æˆ·è‡ªå®šä¹‰å›¾ç‰‡ | âŒ ä¸é€‚ç”¨ |
| å•†æˆ·é€‰æ‹©æ¨¡æ¿ | âœ… æä¾›æ¨èä½ç½® |
| è‡ªåŠ¨ä½¿ç”¨ä¸»é¢˜æ¨¡æ¿ | âœ… æä¾›æ¨èä½ç½® |

### æ¨èä½ç½®çš„ä½¿ç”¨

```typescript
// å½“å•†æˆ·ä½¿ç”¨å¹³å°æ¨¡æ¿æ—¶ï¼Œæ˜¾ç¤ºæ¨èä½ç½®æ ‡è®°
function getPresetPositions(plan: RentalPlan) {
  // è‡ªå®šä¹‰å›¾ç‰‡ â†’ æ— æ¨èä½ç½®
  if (plan.hotmapImageUrl) {
    return [];
  }

  // è·å–æ¨¡æ¿ ID
  const templateId = plan.hotmapTemplateId ??
    await getThemeTemplateId(plan.themeId);

  if (!templateId) return [];

  // è¿”å›æ¨¡æ¿çš„é¢„è®¾çƒ­ç‚¹
  return prisma.mapHotspot.findMany({
    where: { templateId },
    include: { component: true }
  });
}
```

---

## å®ç°è®¡åˆ’ï¼ˆv9 å¹³å°ç»Ÿä¸€ç®¡ç†ï¼‰

### Phase 1ï¼šæ•°æ®æ¨¡å‹æ›´æ–°

1. æ›´æ–° `ServiceComponent` schema
   - æ·»åŠ  `imageUrl` å­—æ®µ
   - æ›´æ–° `type` ä¸º `OUTFIT | ADDON`
   - ç§»é™¤ `merchantId` ç›¸å…³å­—æ®µï¼ˆç»„ä»¶ä¸å†å½’å•†æˆ·æ‰€æœ‰ï¼‰
2. æ–°å¢ `ThemeComponent` schemaï¼ˆä¸»é¢˜-ç»„ä»¶å…³è”ï¼‰
3. æ–°å¢ `MerchantComponentPrice` schemaï¼ˆå•†æˆ·å®šä»·ï¼‰
4. ä¿ç•™ç°æœ‰ `ComponentUpgrade` schemaï¼ˆå‡çº§é…ç½®ï¼‰
5. ä¿ç•™ç°æœ‰ `PlanUpgradeBundle` schemaï¼ˆå¥—é¤å‡çº§åŒ…ï¼‰
6. è¿è¡Œ migration

### Phase 2ï¼šç®¡ç†å‘˜ç»„ä»¶ç®¡ç†

1. åˆ›å»º `/admin/components` é¡µé¢
2. å®ç°ç»„ä»¶ CRUD åŠŸèƒ½
3. å®ç°ä¸»é¢˜-ç»„ä»¶å…³è”é…ç½®
4. å®ç° APIï¼š
   - `POST/PATCH/DELETE /api/admin/components`
   - `POST /api/admin/themes/[id]/components`

### Phase 3ï¼šå•†æˆ·å®šä»·é¡µé¢

1. åˆ›å»º `/merchant/pricing` é¡µé¢ï¼ˆæˆ–æ•´åˆåˆ°ç°æœ‰è®¾ç½®é¡µï¼‰
2. æ˜¾ç¤ºæ‰€æœ‰å¹³å°ç»„ä»¶ + å¹³å°å»ºè®®ä»·
3. å•†æˆ·å¯è®¾ç½®è‡ªå·±çš„ä»·æ ¼
4. å•†æˆ·å¯ç¦ç”¨ä¸æƒ³æä¾›çš„ç»„ä»¶
5. å®ç° APIï¼š
   - `GET /api/merchant/component-prices`
   - `PUT /api/merchant/component-prices`
   - `POST /api/merchant/component-prices/[componentId]`

### Phase 4ï¼šå¥—é¤ç¼–è¾‘å™¨é‡æ„

1. åˆ†ç¦»ã€Œç€è£…é¡¹+çƒ­å›¾ã€å’Œã€Œå¢å€¼æœåŠ¡ã€ä¸¤ä¸ªåŒºåŸŸ
2. ç€è£…é¡¹åŒºåŸŸï¼šä¿æŒç°æœ‰çƒ­å›¾ç¼–è¾‘å™¨é€»è¾‘
3. å¢å€¼æœåŠ¡åŒºåŸŸï¼š
   - å¡ç‰‡ç½‘æ ¼å±•ç¤º
   - åŒ…å«/å¯é€‰åˆ‡æ¢
   - ã€Œæ·»åŠ å¢å€¼æœåŠ¡ã€å¼¹çª—
4. æ›´æ–° `PlanComponent` ä¿å­˜é€»è¾‘

### Phase 5ï¼šç”¨æˆ·ç«¯å¥—é¤è¯¦æƒ…é¡µ

1. æ˜¾ç¤ºã€Œå·²åŒ…å«ã€ç»„ä»¶åˆ—è¡¨
2. æ˜¾ç¤ºã€Œå¯é€‰å¢å€¼æœåŠ¡ã€å¡ç‰‡
3. å®ç°åŠ è´­é€‰æ‹©äº¤äº’
4. å®ç°ä»·æ ¼åŠ¨æ€è®¡ç®—

### Phase 6ï¼šè´­ç‰©è½¦å’Œç»“ç®—

1. æ›´æ–° `CartItem` ç»“æ„ï¼ˆæ”¯æŒå¯é€‰ç»„ä»¶ï¼‰
2. ç»“ç®—é¡µæ˜¾ç¤ºé€‰ä¸­çš„å¢å€¼æœåŠ¡
3. è®¢å•åˆ›å»ºæ—¶è®°å½•é€‰ä¸­çš„ç»„ä»¶

### Phase 7ï¼šæœåŠ¡å‡çº§åŠŸèƒ½

1. å¥—é¤è¯¦æƒ…é¡µï¼šå‡çº§é€‰é¡¹å±•ç¤º
   - æ¨èå‡çº§åŒ…ï¼ˆä¸€é”®å‡çº§ï¼‰
   - è‡ªå®šä¹‰å‡çº§ï¼ˆæŒ‰ç»„ä»¶é€‰æ‹©ï¼‰
2. è´­ç‰©è½¦ï¼šå‡çº§çŠ¶æ€å­˜å‚¨å’Œå±•ç¤º
3. ç»“ç®—é¡µï¼šè¿½åŠ é”€å”®æé†’

### Phase 8ï¼šå¹³å°ç®¡ç†

1. ç®¡ç†å‘˜æŸ¥çœ‹æ‰€æœ‰å•†æˆ·å®šä»·
2. ç®¡ç†å¹³å°ç»„ä»¶åº“ï¼ˆå¢åˆ æ”¹ï¼‰
3. ç®¡ç†å¹³å°é¢„è®¾å‡çº§è·¯å¾„
4. æŒ‰ä¸»é¢˜é…ç½®ç»„ä»¶å…³è”å’Œé»˜è®¤å‡çº§è·¯å¾„

---

## å…³é”®è®¾è®¡æ€»ç»“ï¼ˆv9 å¹³å°ç»Ÿä¸€ç®¡ç†ï¼‰

| ç‰¹æ€§ | è®¾è®¡ |
|-----|------|
| **ç»„ä»¶ç±»å‹** | OUTFIT (ç€è£…é¡¹ï¼Œéœ€çƒ­å›¾) / ADDON (å¢å€¼æœåŠ¡ï¼Œæ— éœ€çƒ­å›¾) |
| **ç»„ä»¶æ‰€æœ‰æƒ** | **ä»…å¹³å°ç»„ä»¶**ï¼Œå•†æˆ·ä¸èƒ½è‡ªå®šä¹‰æ–°ç»„ä»¶ |
| **ç»„ä»¶ç®¡ç†** | å¹³å°ç»Ÿä¸€ç®¡ç†ï¼ŒæŒ‰ä¸»é¢˜ç»„ç»‡æ¨èç»„ä»¶ |
| **ä»·æ ¼ç®¡ç†** | å•†æˆ·çº§åˆ«å®šä»·ï¼ˆ`MerchantComponentPrice`ï¼‰ï¼Œæ‰€æœ‰å¥—é¤é€šç”¨ |
| **åŒ…å«æ¨¡å¼** | `isIncluded=true` ç»„ä»¶åŒ…å«åœ¨å¥—é¤åŸºç¡€ä»·ä¸­ |
| **å¯é€‰åŠ è´­** | `isIncluded=false` é¡¾å®¢é€‰ä¸­åé¢å¤–ä»˜è´¹ |
| **çƒ­ç‚¹å›¾** | **å¯é€‰**ï¼Œä»… OUTFIT ç±»å‹éœ€è¦çƒ­å›¾ä½ç½® |
| **çƒ­ç‚¹å›¾æ¥æº** | ä»…ä¸¤ç§ï¼šè‡ªå®šä¹‰ä¸Šä¼  æˆ– å¹³å°æ¨¡æ¿ |
| **çƒ­ç‚¹ä½ç½®** | å­˜åœ¨ `PlanComponent.hotmapX/Y`ï¼Œæ¯å¥—é¤ç‹¬ç«‹ |
| **å›¾ç‰‡å±•ç¤º** | `ServiceComponent.imageUrl`ï¼ŒOUTFIT å’Œ ADDON éƒ½æ”¯æŒ |
| **æœåŠ¡å‡çº§** | æ··åˆæ¨¡å¼ï¼šæ¨èå‡çº§åŒ… + è‡ªå®šä¹‰å‡çº§ |
| **å‡çº§é…ç½®** | æ··åˆæ¨¡å¼ï¼šå¹³å°é¢„è®¾ + å•†æˆ·è‡ªå®šä¹‰ |
| **å‡çº§æ—¶æœº** | å¥—é¤è¯¦æƒ…é¡µ + ç»“ç®—é¡µé¢ |
| **å‡çº§å­˜å‚¨** | `ComponentUpgrade` ç»Ÿä¸€è¡¨ï¼ˆscope: PLATFORM / MERCHANTï¼‰|

### ä»·æ ¼è§£æï¼ˆv9ï¼‰

```typescript
// v9ï¼šå•†æˆ·å®šä»· > å¹³å°å»ºè®®ä»·
async function getPrice(componentId: string, merchantId: string) {
  const merchantPrice = await getMerchantPrice(merchantId, componentId);
  if (merchantPrice) {
    return merchantPrice.price;
  }
  return component.basePrice;  // å¹³å°å»ºè®®ä»·
}
```

### æ•°æ®æ¨¡å‹

```
v9 æ–¹æ¡ˆï¼š
â”œâ”€â”€ ServiceComponent (å¹³å°ç»Ÿä¸€ç®¡ç†)
â”‚   â””â”€â”€ basePrice (å¹³å°å»ºè®®ä»·)
â”œâ”€â”€ ThemeComponent (ä¸»é¢˜-ç»„ä»¶å…³è”) â† æ–°å¢
â”‚   â””â”€â”€ isRequired, isRecommended
â””â”€â”€ MerchantComponentPrice (å•†æˆ·å®šä»·) â† æ–°å¢
    â””â”€â”€ price, isEnabled
```

### v9 è®¾è®¡ä¼˜åŠ¿

1. **é£æ ¼ç»Ÿä¸€**ï¼šç»„ä»¶åç§°ã€å›¾æ ‡ã€æè¿°ç”±å¹³å°æ§åˆ¶
2. **ä¸»é¢˜ç®¡ç†**ï¼šå¹³å°å¯æŒ‰ä¸»é¢˜ç»„ç»‡å’Œæ¨èç»„ä»¶
3. **å‡å°‘é€‰æ‹©**ï¼šå•†æˆ·é€‰ä¸»é¢˜åè·å¾—æ¨èç»„ä»¶åˆ—è¡¨
4. **æ“ä½œç®€å•**ï¼šå•†æˆ·åªéœ€è®¾ç½®ä»·æ ¼ï¼Œæ— éœ€ç®¡ç†"æˆ‘çš„æœåŠ¡åº“"
5. **çµæ´»å®šä»·**ï¼šå•†æˆ·å¯è®¾ç½®è‡ªå·±çš„ä»·æ ¼ï¼ˆå•†æˆ·çº§åˆ«ï¼‰

### UI åˆ†åŒº

```
å¥—é¤ç¼–è¾‘å™¨
â”œâ”€â”€ ç€è£…é¡¹ + çƒ­ç‚¹å›¾ åŒºåŸŸ
â”‚   â”œâ”€â”€ å·¦ä¾§ï¼šå¹³å°ç»„ä»¶åˆ—è¡¨ (OUTFIT ç±»å‹)
â”‚   â”‚   â””â”€â”€ æ˜¾ç¤ºå•†æˆ·å®šä»·ï¼ˆæœªè®¾ç½®åˆ™æ˜¾ç¤ºå¹³å°å»ºè®®ä»·ï¼‰
â”‚   â””â”€â”€ å³ä¾§ï¼š3:4 çƒ­å›¾é¢„è§ˆ
â”‚
â””â”€â”€ å¢å€¼æœåŠ¡ åŒºåŸŸ
    â”œâ”€â”€ å¹³å°ç»„ä»¶å¡ç‰‡ç½‘æ ¼ (ADDON ç±»å‹)
    â”œâ”€â”€ åŒ…å«/å¯é€‰ åˆ‡æ¢
    â””â”€â”€ é¦–æ¬¡ä½¿ç”¨æ—¶å¼¹çª—è®¾ç½®ä»·æ ¼
```

### å•†æˆ·æ“ä½œæµç¨‹

```
å¥—é¤ç¼–è¾‘æµç¨‹ï¼š
1. é€‰æ‹©ä¸»é¢˜ â†’ è·å–è¯¥ä¸»é¢˜æ¨èç»„ä»¶
2. å‹¾é€‰ç»„ä»¶ â†’ é¦–æ¬¡ä½¿ç”¨å¼¹çª—ã€Œè®¾ç½®æ‚¨çš„ä»·æ ¼ã€
3. è®¾ç½®ä»·æ ¼ â†’ ä¿å­˜åˆ° MerchantComponentPrice
4. ä¸‹æ¬¡ä½¿ç”¨åŒç»„ä»¶ â†’ è‡ªåŠ¨å¤ç”¨å·²è®¾ç½®çš„ä»·æ ¼

ä»·æ ¼ç®¡ç†æµç¨‹ï¼š
/merchant/pricing é¡µé¢
â”œâ”€â”€ æ˜¾ç¤ºæ‰€æœ‰å¹³å°ç»„ä»¶
â”œâ”€â”€ æ˜¾ç¤ºå¹³å°å»ºè®®ä»· vs æˆ‘çš„å®šä»·
â”œâ”€â”€ å¯æ‰¹é‡ä¿®æ”¹ä»·æ ¼
â””â”€â”€ å¯ç¦ç”¨ä¸æƒ³æä¾›çš„ç»„ä»¶
```
